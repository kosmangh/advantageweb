import{a as B,b as ne,c as se,d as H,e as W,f as ae,g as G,p as le}from"./chunk-7DWKZ4XI.js";import{B as V,D as L,Ga as ee,H as U,I as z,M as $,Rc as re,U as J,Uc as oe,W as q,Wc as ie,Ya as te,ca as h,da as K,g as S,ia as u,ma as Z,o as f,p as _,q as X,s as D,t as E}from"./chunk-QRSQYA3Q.js";import{a as k,e as M}from"./chunk-5FZOKLP6.js";var ue={},fe={};"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("").forEach(function(i,s){ue[i]=s,fe[s]=i});function ce(i){for(var s=[],t=0,e=0,r=0;r<i.length;r+=1){var o=ue[i[r]];if(o===void 0)throw new Error("Invalid character ("+i[r]+")");var n=o&32;if(o&=31,e+=o<<t,n)t+=5;else{var a=e&1;e>>>=1,a?s.push(e===0?-2147483648:-e):s.push(e),e=t=0}}return s}var F="TOKEN_LOGGER_CONFIG",Q=class{constructor(s){this.config=this._clone(s)}get level(){return this.config.level}get serverLogLevel(){return this.config.serverLogLevel}updateConfig(s){this.config=this._clone(s)}partialUpdateConfig(s){s&&Object.keys(s).forEach(t=>{this.config[t]=s[t]})}getConfig(){return this._clone(this.config)}_clone(s){let t={level:null};return Object.keys(s).forEach(e=>{t[e]=s[e]}),t}},C="TOKEN_LOGGER_CONFIG_ENGINE_FACTORY",Y=class{provideConfigEngine(s){return new Q(s)}},I="TOKEN_LOGGER_MAPPER_SERVICE",me=(()=>{class i{constructor(t){this.httpBackend=t,this.sourceMapCache=new Map,this.logPositionCache=new Map}getLogPosition(t,e){let r=this.getStackLine(t);if(!r)return f({fileName:"",lineNumber:0,columnNumber:0});let o=this.getLocalPosition(r);if(!t.enableSourceMaps)return f(o);let n=this.getSourceMapLocation(r);return this.getSourceMap(n,o)}getStackLine(t){let e=new Error;try{throw e}catch{try{let o=4;return e.stack.split(`
`)[0].includes(".js:")||(o=o+1),e.stack.split(`
`)[o+(t.proxiedSteps||0)]}catch{return null}}}getLocalPosition(t){let e=t.lastIndexOf("/"),r=t.indexOf(")");r<0&&(r=void 0);let n=t.substring(e+1,r).split(":");return n.length===3?{fileName:n[0],lineNumber:+n[1],columnNumber:+n[2]}:{fileName:"unknown",lineNumber:0,columnNumber:0}}getTranspileLocation(t){let e=t.indexOf("(");e<0&&(e=t.lastIndexOf("@"),e<0&&(e=t.lastIndexOf(" ")));let r=t.indexOf(")");return r<0&&(r=void 0),t.substring(e+1,r)}getSourceMapLocation(t){let e=this.getTranspileLocation(t),r=e.substring(0,e.lastIndexOf(":"));return r.substring(0,r.lastIndexOf(":"))+".map"}getMapping(t,e){let r=0,o=0,n=0,a=t.mappings.split(";");for(let l=0;l<a.length;l++){let d=0,g=a[l].split(",");for(let y=0;y<g.length;y++){let N=ce(g[y]);if(N.length>=4&&(d+=N[0],r+=N[1],o+=N[2],n+=N[3]),l===e.lineNumber){if(d===e.columnNumber)return{fileName:t.sources[r],lineNumber:o,columnNumber:n};if(y+1===g.length)return{fileName:t.sources[r],lineNumber:o,columnNumber:0}}}}return{fileName:"unknown",lineNumber:0,columnNumber:0}}getSourceMap(t,e){let r=new H("GET",t),o=`${e.fileName}:${e.lineNumber}:${e.columnNumber}`;if(this.logPositionCache.has(o))return this.logPositionCache.get(o);this.sourceMapCache.has(t)||(this.httpBackend?this.sourceMapCache.set(t,this.httpBackend.handle(r).pipe(L(a=>a instanceof W),E(a=>a.body),J(3),q(1))):(console.error("NGXLogger : Can't get sourcemap because HttpBackend is not provided. You need to import HttpClientModule"),this.sourceMapCache.set(t,f(null))));let n=this.sourceMapCache.get(t).pipe(E(a=>a?this.getMapping(a,e):e),U(()=>f(e)),q(1));return this.logPositionCache.set(o,n),n}}return i.\u0275fac=function(t){return new(t||i)(u(B,8))},i.\u0275prov=h({token:i,factory:i.\u0275fac}),i})(),O="TOKEN_LOGGER_METADATA_SERVICE",ve=(()=>{class i{constructor(t){this.datePipe=t}computeTimestamp(t){let e=()=>new Date().toISOString();return t.timestampFormat?this.datePipe?this.datePipe.transform(new Date,t.timestampFormat):(console.error("NGXLogger : Can't use timeStampFormat because DatePipe is not provided. You need to provide DatePipe"),e()):e()}getMetadata(t,e,r,o){let n={level:t,additional:o};return r&&typeof r=="function"?n.message=r():n.message=r,n.timestamp=this.computeTimestamp(e),n}}return i.\u0275fac=function(t){return new(t||i)(u(re,8))},i.\u0275prov=h({token:i,factory:i.\u0275fac}),i})();var R="TOKEN_LOGGER_RULES_SERVICE",Se=(()=>{class i{shouldCallWriter(t,e,r,o){return!e.disableConsoleLogging&&t>=e.level}shouldCallServer(t,e,r,o){return!!e.serverLoggingUrl&&t>=e.serverLogLevel}shouldCallMonitor(t,e,r,o){return this.shouldCallWriter(t,e,r,o)||this.shouldCallServer(t,e,r,o)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=h({token:i,factory:i.\u0275fac}),i})(),T="TOKEN_LOGGER_SERVER_SERVICE",Ee=(()=>{class i{constructor(t,e){this.httpBackend=t,this.ngZone=e,this.serverCallsQueue=[],this.flushingQueue=new S(!1)}ngOnDestroy(){this.flushingQueue&&(this.flushingQueue.complete(),this.flushingQueue=null),this.addToQueueTimer&&(this.addToQueueTimer.unsubscribe(),this.addToQueueTimer=null)}secureErrorObject(t){return t?.stack}secureAdditionalParameters(t){return t==null?null:t.map((e,r)=>{try{return e instanceof Error?this.secureErrorObject(e):(typeof e=="object"&&JSON.stringify(e),e)}catch{return`The additional[${r}] value could not be parsed using JSON.stringify().`}})}secureMessage(t){try{if(t instanceof Error)return this.secureErrorObject(t);typeof t!="string"&&(t=JSON.stringify(t,null,2))}catch{t='The provided "message" value could not be parsed with JSON.stringify().'}return t}alterHttpRequest(t){return t}logOnServer(t,e,r){if(!this.httpBackend)return console.error("NGXLogger : Can't log on server because HttpBackend is not provided. You need to import HttpClientModule"),f(null);let o=new H("POST",t,e,r||{}),n=f(o),a=this.alterHttpRequest(o);return X(a)?n=a:a?n=f(a):console.warn("NGXLogger : alterHttpRequest returned an invalid request. Using default one instead"),n.pipe(z(l=>l?this.httpBackend.handle(l):(console.warn("NGXLogger : alterHttpRequest returned an invalid request (observable). Using default one instead"),this.httpBackend.handle(o))),L(l=>l instanceof W),E(l=>l.body))}customiseRequestBody(t){return t}flushQueue(t){this.flushingQueue.next(!0),this.addToQueueTimer&&(this.addToQueueTimer.unsubscribe(),this.addToQueueTimer=null),this.serverCallsQueue&&this.serverCallsQueue.length>0&&this.sendToServerAction(this.serverCallsQueue,t),this.serverCallsQueue=[],this.flushingQueue.next(!1)}sendToServerAction(t,e){let r,o=l=>{let d=k({},l);return d.additional=this.secureAdditionalParameters(d.additional),d.message=this.secureMessage(d.message),d};Array.isArray(t)?(r=[],t.forEach(l=>{r.push(o(l))})):r=o(t),r=this.customiseRequestBody(r);let n=e.customHttpHeaders||new ne;n.has("Content-Type")||n.set("Content-Type","application/json");let a=()=>{this.logOnServer(e.serverLoggingUrl,r,{headers:n,params:e.customHttpParams||new se,responseType:e.httpResponseType||"json",withCredentials:e.withCredentials||!1}).pipe(U(l=>(console.error("NGXLogger: Failed to log on server",l),_(l)))).subscribe()};if(e.serverCallsOutsideNgZone===!0){if(!this.ngZone){console.error("NGXLogger: NgZone is not provided and serverCallsOutsideNgZone is set to true");return}this.ngZone.runOutsideAngular(a)}else a()}sendToServer(t,e){if((!e.serverCallsBatchSize||e.serverCallsBatchSize<=0)&&(!e.serverCallsTimer||e.serverCallsTimer<=0)){this.sendToServerAction(t,e);return}let r=()=>{this.serverCallsQueue.push(k({},t)),e.serverCallsBatchSize&&this.serverCallsQueue.length>e.serverCallsBatchSize&&this.flushQueue(e),e.serverCallsTimer>0&&!this.addToQueueTimer&&(this.addToQueueTimer=V(e.serverCallsTimer).subscribe(o=>{this.flushQueue(e)}))};this.flushingQueue.value===!0?this.flushingQueue.pipe(L(o=>o===!1),$(1)).subscribe(o=>{r()}):r()}}return i.\u0275fac=function(t){return new(t||i)(u(B,8),u(te,8))},i.\u0275prov=h({token:i,factory:i.\u0275fac}),i})(),A="TOKEN_LOGGER_WRITER_SERVICE",c=function(i){return i[i.TRACE=0]="TRACE",i[i.DEBUG=1]="DEBUG",i[i.INFO=2]="INFO",i[i.LOG=3]="LOG",i[i.WARN=4]="WARN",i[i.ERROR=5]="ERROR",i[i.FATAL=6]="FATAL",i[i.OFF=7]="OFF",i}(c||{}),Ne=["purple","teal","gray","gray","red","red","red"],Ce=(()=>{class i{constructor(t){this.platformId=t,this.prepareMetaStringFuncs=[this.getTimestampToWrite,this.getLevelToWrite,this.getFileDetailsToWrite,this.getContextToWrite],this.isIE=ie(t)&&navigator&&navigator.userAgent&&!!(navigator.userAgent.indexOf("MSIE")!==-1||navigator.userAgent.match(/Trident\//)||navigator.userAgent.match(/Edge\//)),this.logFunc=this.isIE?this.logIE.bind(this):this.logModern.bind(this)}getTimestampToWrite(t,e){return t.timestamp}getLevelToWrite(t,e){return c[t.level]}getFileDetailsToWrite(t,e){return e.disableFileDetails===!0?"":`[${t.fileName}:${t.lineNumber}:${t.columnNumber}]`}getContextToWrite(t,e){return e.context?`{${e.context}}`:""}prepareMetaString(t,e){let r="";return this.prepareMetaStringFuncs.forEach(o=>{let n=o(t,e);n&&(r=r+" "+n)}),r.trim()}getColor(t,e){let r=e.colorScheme??Ne;if(t.level!==c.OFF)return r[t.level]}logIE(t,e,r){let o=t.additional||[];switch(t.level){case c.WARN:console.warn(`${r} `,t.message,...o);break;case c.ERROR:case c.FATAL:console.error(`${r} `,t.message,...o);break;case c.INFO:console.info(`${r} `,t.message,...o);break;default:console.log(`${r} `,t.message,...o)}}logModern(t,e,r){let o=this.getColor(t,e),n=t.additional||[];switch(t.level){case c.WARN:console.warn(`%c${r}`,`color:${o}`,t.message,...n);break;case c.ERROR:case c.FATAL:console.error(`%c${r}`,`color:${o}`,t.message,...n);break;case c.INFO:console.info(`%c${r}`,`color:${o}`,t.message,...n);break;case c.DEBUG:console.debug(`%c${r}`,`color:${o}`,t.message,...n);break;default:console.log(`%c${r}`,`color:${o}`,t.message,...n)}}writeMessage(t,e){let r=this.prepareMetaString(t,e);this.logFunc(t,e,r)}}return i.\u0275fac=function(t){return new(t||i)(u(ee))},i.\u0275prov=h({token:i,factory:i.\u0275fac}),i})(),x=(()=>{class i{constructor(t,e,r,o,n,a,l){this.metadataService=r,this.ruleService=o,this.mapperService=n,this.writerService=a,this.serverService=l,this.configEngine=e.provideConfigEngine(t)}get level(){return this.configEngine.level}get serverLogLevel(){return this.configEngine.serverLogLevel}trace(t,...e){this._log(c.TRACE,t,e)}debug(t,...e){this._log(c.DEBUG,t,e)}info(t,...e){this._log(c.INFO,t,e)}log(t,...e){this._log(c.LOG,t,e)}warn(t,...e){this._log(c.WARN,t,e)}error(t,...e){this._log(c.ERROR,t,e)}fatal(t,...e){this._log(c.FATAL,t,e)}setCustomHttpHeaders(t){let e=this.getConfigSnapshot();e.customHttpHeaders=t,this.updateConfig(e)}setCustomParams(t){let e=this.getConfigSnapshot();e.customHttpParams=t,this.updateConfig(e)}setWithCredentialsOptionValue(t){let e=this.getConfigSnapshot();e.withCredentials=t,this.updateConfig(e)}registerMonitor(t){this._loggerMonitor=t}updateConfig(t){this.configEngine.updateConfig(t)}partialUpdateConfig(t){this.configEngine.partialUpdateConfig(t)}getConfigSnapshot(){return this.configEngine.getConfig()}flushServerQueue(){this.serverService.flushQueue(this.getConfigSnapshot())}_log(t,e,r=[]){let o=this.configEngine.getConfig(),n=this.ruleService.shouldCallWriter(t,o,e,r),a=this.ruleService.shouldCallServer(t,o,e,r),l=this.ruleService.shouldCallMonitor(t,o,e,r);if(!n&&!a&&!l)return;let d=this.metadataService.getMetadata(t,o,e,r);this.mapperService.getLogPosition(o,d).pipe($(1)).subscribe(g=>{g&&(d.fileName=g.fileName,d.lineNumber=g.lineNumber,d.columnNumber=g.columnNumber),l&&this._loggerMonitor&&this._loggerMonitor.onLog(d,o),n&&this.writerService.writeMessage(d,o),a&&this.serverService.sendToServer(d,o)})}}return i.\u0275fac=function(t){return new(t||i)(u(F),u(C),u(O),u(R),u(I),u(A),u(T))},i.\u0275prov=h({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Ie=(()=>{class i{constructor(t,e,r,o,n,a,l){this.logger=t,this.configEngineFactory=e,this.metadataService=r,this.ruleService=o,this.mapperService=n,this.writerService=a,this.serverService=l}create(t,e,r,o){return this.getNewInstance({config:t,serverService:e,logMonitor:r,mapperService:o})}getNewInstance(t){let e=new x(t?.config??this.logger.getConfigSnapshot(),t?.configEngineFactory??this.configEngineFactory,t?.metadataService??this.metadataService,t?.ruleService??this.ruleService,t?.mapperService??this.mapperService,t?.writerService??this.writerService,t?.serverService??this.serverService);return t?.partialConfig&&e.partialUpdateConfig(t.partialConfig),t?.logMonitor&&e.registerMonitor(t.logMonitor),e}}return i.\u0275fac=function(t){return new(t||i)(u(x),u(C),u(O),u(R),u(I),u(A),u(T))},i.\u0275prov=h({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Ge=(()=>{class i{static forRoot(t,e){if(e||(e={}),!e.configProvider)e.configProvider={provide:F,useValue:t||{}};else if(e.configProvider.provide!==F)throw new Error(`Wrong injection token for configProvider, it should be ${F} and you used ${e.configProvider.provide}`);if(!e.configEngineFactoryProvider)e.configEngineFactoryProvider={provide:C,useClass:Y};else if(e.configEngineFactoryProvider.provide!==C)throw new Error(`Wrong injection token for configEngineFactoryProvider, it should be '${C}' and you used '${e.configEngineFactoryProvider.provide}'`);if(!e.metadataProvider)e.metadataProvider={provide:O,useClass:ve};else if(e.metadataProvider.provide!==O)throw new Error(`Wrong injection token for metadataProvider, it should be '${O}' and you used '${e.metadataProvider.provide}'`);if(!e.ruleProvider)e.ruleProvider={provide:R,useClass:Se};else if(e.ruleProvider.provide!==R)throw new Error(`Wrong injection token for ruleProvider, it should be '${R}' and you used '${e.ruleProvider.provide}'`);if(!e.mapperProvider)e.mapperProvider={provide:I,useClass:me};else if(e.mapperProvider.provide!==I)throw new Error(`Wrong injection token for mapperProvider, it should be '${I}' and you used '${e.mapperProvider.provide}'`);if(!e.writerProvider)e.writerProvider={provide:A,useClass:Ce};else if(e.writerProvider.provide!==A)throw new Error(`Wrong injection token for writerProvider, it should be '${A}' and you used '${e.writerProvider.provide}'`);if(!e.serverProvider)e.serverProvider={provide:T,useClass:Ee};else if(e.serverProvider.provide!==T)throw new Error(`Wrong injection token for serverProvider, it should be '${T}' and you used '${e.writerProvider.provide}'`);return{ngModule:i,providers:[x,e.configProvider,e.configEngineFactoryProvider,e.metadataProvider,e.ruleProvider,e.mapperProvider,e.writerProvider,e.serverProvider,Ie]}}static forChild(){return{ngModule:i}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=Z({type:i}),i.\u0275inj=K({imports:[[oe]]}),i})();var m=function(i){return i.DASHBOARD="DASHBOARD",i.SETTINGS="SETTINGS",i.OCCUPANCY="SALES",i.LOGIN="LOGIN",i.LOGOUT="LOGOUT",i.USER_ACCOUNT="USER_ACCOUNT_LIST",i.ESTATE_BILLING="ESTATE_BILLING",i.BILL_PAYMENTS="BILL_PAYMENTS",i.FINANCE="FINANCE",i.API_DROPDOWNS="/dropdowns/",i.API_SETTINGS="/settings/",i.API_USER_ACCOUNTS="/useraccounts/",i.API_AUTH="/auth/",i.API_DASH="/dash/",i.API_ESTATE_BILLING="/estatebilling/",i.API_BILL_PAYMENT="/billpayment/",i}(m||{});var p={mock_url:"http://localhost:3003/advantageservices",url:"http://testsite.bolaapps.com/advantageservices",timeout:5e4,log_url:"http://testsite.bolaapps.com/themartportal/logaction",server_log_level:c.OFF,disable_console_logging:!1};var v=class{};var b=class{toString(){return""+this.zone+this.ipAddress+this.requestId+this.requestToken+this.requestType+this.sourceChannelId+this.sourceCode}};var ge=(()=>{let s=class s{constructor(e){this.http=e,this.userSubject=new S(JSON.parse(localStorage.getItem("mwuser"))),this.user=this.userSubject.asObservable()}parseDate(e){let r=e.replace("[UTC]","");return new Date(r)}getFirstDayOfCurrentYear(){let r=new Date().getFullYear();return new Date(r,0,1)}getFirstDayDate(){let e=new Date,r=e.getFullYear(),o=e.getMonth();return new Date(r,o,1)}getLastDayDate(){let e=new Date,r=e.getFullYear(),o=e.getMonth();return new Date(r,o+1,0)}getDateBasedOnNumberOfDays(e){let r=new Date;return r.setDate(1),r.setDate(r.getDate()+e),r}getLastDayOfPreviousMonth(){var e=new Date,r=e.getMonth(),o=r-1,n=new Date(e.getFullYear(),o,0);return new Date(n)}getLastDayOfPreviousMonthName(){var e=new Date,r=e.getMonth(),o=r-1,n=new Date(e.getFullYear(),o,0);return new Date(n)}getCurrentMonthName(){return new Date().toLocaleString("default",{month:"long"}).toUpperCase()}getLastMonthName(){let e=new Date;return new Date(e.getFullYear(),e.getMonth()-1).toLocaleString("default",{month:"long"})}parseDateString(e){let r=new Date(e);return isNaN(r.getTime())?null:r}formatDateToString(e,r="en-US"){return new Intl.DateTimeFormat(r).format(e)}get userSessionData(){return this.userSubject.value}getUniqueId(e){let r=[];for(let n=0;n<e;n++){let a=((1+Math.random())*65536|0).toString(16).substring(1);r.push(a)}let o=r.join("-");return o=o.replace("-",""),o=o.replace("-",""),o=o.replace("-",""),o}generateRandomNumber(){let e=Math.floor(Math.random()*1e10);return String(e).padStart(10,"0")}generateOtp(){var e="0123456789";let r="";for(let o=0;o<6;o++)r+=e[Math.floor(Math.random()*10)];for(let o=0;o<6;o++)r+=e[Math.floor(Math.random()*10)];return r}getMonthsOfYear(){return["JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"]}getChargeYears(){let r=new Date().getFullYear(),o=[];for(let n=r;n>=2e3;n--)o.push(n);return o}getIPAddress(){this.http.get("http://api.ipify.org/?format=json").subscribe(e=>{console.log("user id "+e.ip),localStorage.setItem("ip",JSON.stringify(e.ip))})}getRequestHeader1(e,r){let o=new b;return o.requestId=this.generateRandomNumber(),o.sourceCode="WEB",o.zone=e,o.requestType=r,o.ipAddress=this.getFakeIp(),o.region="EN",o}getRequestHeader(e,r,o){let n=new b;return n.requestId=this.generateRandomNumber(),n.sourceCode="WEB",n.zone=e,n.requestType=o,n.ipAddress=this.getFakeIp(),n.region=r,n}getUserInfo(e){let r=new v;return e.headerResponse.responseCode==="000"&&(r.company=e.zoneId,r.companyName=e.zoneName,r.logo=e.logo,r.emailAddress=e.emailAddress,r.fullName=e.fullName,r.lastLoginDate=e.lastLoginDate,r.userRoleName=e.userRole,r.username=e.username,r.location=e.zoneAddress,r.contactNo=e.zoneContact,r.regionId=e.regionId,r.regionName=e.regionName,r.userType="G",r.zoneId=e.zoneId,r.zoneName=e.zoneName),r}getMaskEmail(e){let[r,o]=e.split("@"),{length:n}=r;return r[0]+"..."+r[n-1]+"@"+o}getFakeIp(){return`${Math.floor(Math.random()*255)+1}.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`}generatePassword(e){let r=e.toLowerCase()+e.toUpperCase()+"0123456789",o="";for(let n=0;n<6;n++){let a=Math.floor(Math.random()*r.length);o+=r[a]}return o}};s.\u0275fac=function(r){return new(r||s)(u(G))},s.\u0275prov=h({token:s,factory:s.\u0275fac,providedIn:"root"});let i=s;return i})();var w=class{};var j=class{};var P=class{};var ot=(()=>{let s=class s{constructor(e,r,o){this.router=e,this.utilsService=r,this.http=o,this.APP_SESSION_NAME="advantage",this.userSubject=new S(JSON.parse(localStorage.getItem(this.APP_SESSION_NAME))),this.currentUser=this.userSubject.asObservable()}get userValue(){let e=new v;return e=JSON.parse(localStorage.getItem(this.APP_SESSION_NAME)),e}loginUser(e,r){localStorage.removeItem(this.APP_SESSION_NAME),this.userSubject.next(null);let o=new w;return o.username=e,o.password=r,o.headerRequest=this.utilsService.getRequestHeader("ALL","ALL","LOGIN_USER"),o.headerRequest.sourceCode="portal",o.headerRequest.sourceChannelId="portal",console.info("login request "+JSON.stringify(o)),this.http.post(`${p.url+m.API_AUTH}login`,o).pipe(D(p.timeout),E(n=>{let a=new v;return a=this.utilsService.getUserInfo(n),localStorage.setItem(this.APP_SESSION_NAME,JSON.stringify(a)),this.userSubject.next(a),n}))}resetPassword(e,r){localStorage.removeItem(this.APP_SESSION_NAME),this.userSubject.next(null);let o=new w;return o.username=e.username,o.password=r,o.headerRequest=this.utilsService.getRequestHeader(e.zoneId,e.regionId,"RESET_PASSWORD"),o.headerRequest.sourceCode="WEB",o.headerRequest.sourceChannelId="portal",console.info("login request "+JSON.stringify(o)),this.http.post(`${p.url+m.API_AUTH}passwordreset`,o).pipe(D(p.timeout))}searchAuditLogs(e,r,o,n,a){let l=new P;return l.searchBy=r,l.searchValue=o,l.startDate=n,l.endDate=a,l.headerRequest=this.utilsService.getRequestHeader(e.zoneId,e.regionId,"AUDIT_LOGS"),this.http.post(`${p.url+m.API_AUTH}auditlogs`,l).pipe(D(p.timeout))}logout(){this.logAction("Logged out",m.LOGOUT),this.userSubject.next(null),localStorage.removeItem(this.APP_SESSION_NAME),this.router.navigate(["/login"])}pageNotFound(){this.userSubject.next(null),localStorage.removeItem(this.APP_SESSION_NAME)}handleError(e){let r="";return e.error instanceof ErrorEvent?r=`An error occurred: ${e.error.message}`:r=`Server returned ${e.status}, error message is: ${e.message}`,_(r)}logAction(e,r){return M(this,null,function*(){yield this.logUserAudit(e,r)})}logUserAudit(e,r){return M(this,null,function*(){try{let o=new j;return o.headerRequest=this.utilsService.getRequestHeader(this.userValue.zoneId,this.userValue.regionId,"AUDIT_LOG"),o.headerRequest.sourceCode=this.userValue.company,o.headerRequest.sourceChannelId=this.userValue.company,o.username=this.userValue.username,o.fullName=this.userValue.fullName,o.userRole=this.userValue.userRoleName,o.ui=r,o.userActivity=e,console.info("logUserAudit request "+JSON.stringify(o)),yield this.http.post(`${p.url+m.API_AUTH}logaudit`,o).toPromise()}catch(o){o instanceof ae?yield this.handleError(o):console.debug("general error: "+JSON.stringify(o))}})}reloadCurrentRoute(){return M(this,null,function*(){let e=this.router.url;setTimeout(()=>this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigate([e])}),1500)})}};s.\u0275fac=function(r){return new(r||s)(u(le),u(ge),u(G))},s.\u0275prov=h({token:s,factory:s.\u0275fac,providedIn:"root"});let i=s;return i})();export{c as a,x as b,Ge as c,m as d,p as e,ge as f,ot as g};
