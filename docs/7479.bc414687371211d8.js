"use strict";(self.webpackChunkadvantageweb=self.webpackChunkadvantageweb||[]).push([[7479],{7479:(ee,u,o)=>{o.r(u),o.d(u,{PaymentRecordsComponent:()=>H});var f=o(5861),e=o(5879),l=o(6814),c=o(95),d=o(4740),g=o(1392),m=o(2458),v=o(4981),P=o(7177),M=o(8352),y=o(6763),E=o(1449),Z=o(7467),C=o(5176),T=o(2735),O=o(2187),A=o(8624),D=o(4874),U=o(9082),x=o(5858),b=o(1456),B=o(3519),R=o.n(B),N=o(5148),I=o(1085),h=o(9917),L=o(2870),S=o(7236),_=o(6842),K=o(9972);function w(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"div",2)(1,"div",5)(2,"label",4),e._uU(3),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"input",25),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.searchValue=n)}),e.qZA()()()}if(2&r){const t=e.oxw(2);e.xp6(3),e.Oqu(t.searchParameterLabel),e.xp6(2),e.MGl("placeholder","Enter ",t.searchParameterLabel,""),e.Q6J("ngModel",t.searchValue)}}function J(r,i){if(1&r&&(e.ynx(0),e.YNc(1,w,6,3,"div",24),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.searchParameter)}}function W(r,i){if(1&r&&(e.TgZ(0,"ng-option",35),e._uU(1),e.qZA()),2&r){const t=i.$implicit;e.Q6J("value",t.recordId),e.xp6(1),e.hij(" ",t.estateName," ")}}function Q(r,i){if(1&r&&(e.TgZ(0,"ng-option",35),e._uU(1),e.qZA()),2&r){const t=i.$implicit;e.Q6J("value",t.recordId),e.xp6(1),e.hij(" ",t.block," ")}}function F(r,i){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",3),e._UZ(3,"app-form-label",26),e.TgZ(4,"div",5)(5,"ng-select",27),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.estate=n)})("change",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.fetchEstateBlocks())}),e.TgZ(6,"ng-option",28),e._uU(7,"Select Estate"),e.qZA(),e.YNc(8,W,2,2,"ng-option",29),e.qZA()()()(),e.TgZ(9,"div",2)(10,"div",3),e._UZ(11,"app-form-label",26),e.TgZ(12,"div",5)(13,"ng-select",30),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.block=n)}),e.TgZ(14,"ng-option",28),e._uU(15,"Select Block"),e.qZA(),e.YNc(16,Q,2,2,"ng-option",29),e.qZA()()()(),e.TgZ(17,"div",12)(18,"div",5)(19,"div",3)(20,"label",31),e._uU(21,"Start Date"),e.qZA(),e._UZ(22,"br"),e.TgZ(23,"p-calendar",32),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.startDate=n)}),e.qZA()()()(),e.TgZ(24,"div",12)(25,"label",33),e._uU(26,"End Date"),e.qZA(),e._UZ(27,"br"),e.TgZ(28,"p-calendar",34),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.endDate=n)}),e.qZA()(),e.BQk()}if(2&r){const t=e.oxw();e.xp6(3),e.Q6J("labelForName","estate")("labelName","Estates"),e.xp6(2),e.Q6J("clearable",!1)("ngModel",t.estate),e.xp6(3),e.Q6J("ngForOf",t.listOfEstates),e.xp6(3),e.Q6J("labelForName","block")("labelName","Blocks"),e.xp6(2),e.Q6J("clearable",!1)("ngModel",t.block),e.xp6(3),e.Q6J("ngForOf",t.listOfEstateBlocks),e.xp6(7),e.Q6J("monthNavigator",!0)("yearNavigator",!0)("showIcon",!0)("ngModel",t.startDate),e.xp6(5),e.Q6J("showIcon",!0)("ngModel",t.endDate)}}function q(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",41)(2,"a",42),e._UZ(3,"em",43),e.qZA(),e.TgZ(4,"div",44)(5,"ul",45)(6,"li")(7,"a",46),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.export())}),e._UZ(8,"em",47),e.TgZ(9,"span"),e._uU(10,"Export to Excel"),e.qZA()()(),e.TgZ(11,"li")(12,"a",48),e._UZ(13,"em",49),e.TgZ(14,"span"),e._uU(15,"Export to PDF"),e.qZA()()()()()()()}}function Y(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"div",36)(1,"div",12)(2,"div",5)(3,"div",37),e._UZ(4,"em",38),e.qZA(),e.TgZ(5,"input",39),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.searchedKeyword=n)}),e.qZA()()(),e.YNc(6,q,16,0,"div",40),e.qZA()}if(2&r){const t=e.oxw();e.xp6(5),e.Q6J("ngModel",t.searchedKeyword),e.xp6(1),e.Q6J("ngIf",(null==t.billPayments?null:t.billPayments.length)>0)}}function j(r,i){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Property"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Occupant"),e.qZA(),e.TgZ(5,"th",50),e._uU(6,"Amount(GHS)"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Receipt No."),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Narration"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Payment Mode"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Payment Date"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Recorded By"),e.qZA()())}function G(r,i){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"app-full-name",51),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"app-full-name",51),e.qZA(),e.TgZ(5,"td",52),e._uU(6),e.ALo(7,"number"),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._UZ(13,"app-full-name",51),e.ALo(14,"removeHyphen"),e.ALo(15,"titlecase"),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"lowercase"),e.TgZ(19,"div",53)(20,"small",54),e._uU(21),e.ALo(22,"date"),e.qZA(),e.TgZ(23,"small",55),e._uU(24),e.ALo(25,"timeAgo"),e.qZA()()(),e.TgZ(26,"td"),e._uU(27),e.qZA()()),2&r){const t=i.$implicit;e.xp6(2),e.s9C("fullName",null==t?null:t.propertyName),e.s9C("otherFieldName",null==t?null:t.propertyId),e.Q6J("showAvatar",!1),e.xp6(2),e.s9C("fullName",null==t?null:t.occupantName),e.s9C("otherFieldName",null==t?null:t.institutionalDisplayName),e.Q6J("showAvatar",!1),e.xp6(2),e.hij(" ",e.xi3(7,16,null==t?null:t.amountInvolved,".2-2")," "),e.xp6(3),e.Oqu(null==t?null:t.receiptNumberIssued),e.xp6(2),e.Oqu(null==t?null:t.paymentFor),e.xp6(2),e.s9C("fullName",e.lcZ(14,19,e.lcZ(15,21,null==t?null:t.mediumOfPayment))),e.s9C("otherFieldName",null==t?null:t.mediumOfPaymentNumber),e.Q6J("showAvatar",!1),e.xp6(4),e.hij(" ",e.lcZ(18,23,null==t?null:t.paymentDate)," "),e.xp6(4),e.Oqu(e.xi3(22,25,null==t?null:t.createdDate,"medium")),e.xp6(3),e.hij(" ",e.lcZ(25,28,null==t?null:t.createdDate),""),e.xp6(3),e.Oqu(null==t?null:t.createdBy)}}const k=function(){return[5,10,25,50]};let H=(()=>{var r;class i{constructor(a,n,s,p,z,V,$){this.billPaymentService=a,this.logger=n,this.addOccupantPropertyBsModalRef=s,this.addInstitutionOccupantBsModalRef=p,this.viewOccupantPropertyBsModalRef=z,this.addOccupantPropertyModalService=V,this.institutionOccupantModalService=$,this.searchParameter="receiptNumberIssued",this.showOccupantSearchBy=!0,this.settingsService=(0,e.f3M)(E.g),this.excelExporterService=(0,e.f3M)(M.h),this.accountService=(0,e.f3M)(P.e),this.alertService=(0,e.f3M)(v.c),this.utilsService=(0,e.f3M)(Z.F),this.occupantsService=(0,e.f3M)(y.k),this.accountService.currentUser.subscribe(X=>this.currentUser=X)}ngOnInit(){this.startDate=this.utilsService.getFirstDayDate(),this.endDate=new Date,this.estate="A",this.block="A",this.totalCredit=0,this.totalDebit=0,this.balance=0,this.searchParameterListener()}ngOnDestroy(){this.addOccupantPropertyModalService.hide(),R().close()}searchParameterListener(){"receiptNumberIssued"!=this.searchParameter?"mediumOfPaymentNumber"!=this.searchParameter?"BAB"==this.searchParameter&&(this.estate="A",this.block="A",this.fetchEstates(),this.listOfEstateBlocks=[]):this.searchParameterLabel="Payment Mode No.":this.searchParameterLabel="Receipt No."}searchBillPayments(){this.billPayments=[];const a=new N.i;a.searchBy=this.searchParameter,a.searchValue=this.searchValue,a.endDate=this.endDate,a.startDate=this.startDate,a.occupantId="",a.propertyId="","BAB"==this.searchParameter&&(a.searchValue=this.block),a.propertyId=this.block,this.billPaymentService.fetchBillPayments(this.currentUser,a).subscribe({next:n=>{if(this.logger.info("fetchBillPayments response "+JSON.stringify(n)),"000"===n.headerResponse.responseCode)return n.propertyLedgers.length<=0?(this.alertService.showInfoMsgGeneral("No payments found"),void this.logger.info("No payments found")):(this.billPayments=n.propertyLedgers,this.totalCredit=n.totalCredit,this.totalDebit=n.totalDebit,void(this.balance=n.currentBalance));this.alertService.showErrorMsg(n.headerResponse.responseMessage)},error:n=>{this.logger.error(n),this.alertService.showInfoMsg(n)}})}export(){this.excelExporterService.exportAsExcelFile(this.billPayments,"occupantProperties")}fetchEstates(){this.listOfEstates=[],this.settingsService.getEstates().subscribe({next:a=>{if(this.logger.info("getEstates response "+JSON.stringify(a)),"000"===a.headerResponse.responseCode)return a.estates.length<=0?(this.alertService.showInfoMsgGeneral("No zones found"),void this.logger.info("No zones found")):void(this.listOfEstates=a.estates);this.alertService.error(a.headerResponse.responseMessage)},error:a=>{this.logger.error(a),this.alertService.showInfoMsg(a)}})}fetchEstateBlocks(){this.listOfEstateBlocks=[],this.settingsService.getEstateBlocks(this.currentUser,this.estate).subscribe({next:a=>{if(this.logger.info("getEstates response "+JSON.stringify(a)),"000"===a.headerResponse.responseCode)return a.estateBlocks.length<=0?(this.alertService.showInfoMsgGeneral("No blocks found"),void this.logger.info("No blocks found ")):void(this.listOfEstateBlocks=a.estateBlocks);this.alertService.error(a.headerResponse.responseMessage)},error:a=>{this.logger.error(a.message),this.alertService.showInfoMsg(a.message)}})}openOccupantPropertyModalComponent(a,n){const s={initialState:{isAddMode:n,occupantProperty:a}};this.addOccupantPropertyModalService.config.ignoreBackdropClick=!0,this.addOccupantPropertyModalService.config.animated=!0,this.addOccupantPropertyBsModalRef=this.addOccupantPropertyModalService.show(U.f,s),this.addOccupantPropertyBsModalRef.content.closeBtnName="Close"}openInstitutionModalComponent(a,n){const s={initialState:{isAddMode:n,occupant:a}};this.institutionOccupantModalService.config.ignoreBackdropClick=!0,this.institutionOccupantModalService.config.animated=!0,this.addInstitutionOccupantBsModalRef=this.institutionOccupantModalService.show(b.m,s),this.addInstitutionOccupantBsModalRef.content.closeBtnName="Close"}openViewOccupantModalComponent(a){const n={initialState:{occupantProperty:a}};this.institutionOccupantModalService.config.ignoreBackdropClick=!0,this.institutionOccupantModalService.config.animated=!0,this.viewOccupantPropertyBsModalRef=this.institutionOccupantModalService.show(x.s,n),this.viewOccupantPropertyBsModalRef.content.closeBtnName="Close"}logAction(a,n){var s=this;return(0,f.Z)(function*(){yield s.accountService.logUserAudit(a,n)})()}}return(r=i).\u0275fac=function(a){return new(a||r)(e.Y36(L.d),e.Y36(S.Kf),e.Y36(_.UZ),e.Y36(_.UZ),e.Y36(_.UZ),e.Y36(_.tT),e.Y36(_.tT))},r.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],standalone:!0,features:[e.jDz],decls:50,vars:29,consts:[[3,"pageTitleName","description"],[1,"row","gy-2","gx-2","mt-5","mb-4","align-items-center"],[1,"col-sm-2"],[1,"form-group"],["for","searchParameter",1,"form-label","pt-0"],[1,"form-control-wrap"],[1,"form-control-select"],["id","searchParameter",1,"form-control",3,"ngModel","ngModelChange","change"],["value","receiptNumberIssued","selected","",1,"fs-6"],["value","mediumOfPaymentNumber","selected","",1,"fs-6"],["value","BAB"],[4,"ngIf"],[1,"col-auto"],["type","button",1,"btn","btn-dim","btn-primary","mt-4",3,"click"],["class","row gy-2 gx-3 my-3",4,"ngIf"],["responsiveLayout","scroll","sortMode","multiple","responsiveLayout","scroll","styleClass","p-datatable-sm p-datatable-striped","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","scrollDirection","both",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","resizableColumns","autoLayout"],["dt1",""],["pTemplate","header"],["pTemplate","body"],[1,"row","mt-3","justify-content-end"],[1,"col-6"],[1,"row","gy-2"],[1,"col-sm-12","text-end"],[1,"ff-mono","fw-bolder"],["class","col-sm-2",4,"ngIf"],["type","text","autocomplete","off","id","searchParameter",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[3,"labelForName","labelName"],["id","estate",3,"clearable","ngModel","ngModelChange","change"],["value","A","selected","",1,"fs-6"],[3,"value",4,"ngFor","ngForOf"],["id","block",3,"clearable","ngModel","ngModelChange"],["for","startDate",1,"form-label","pt-0"],["dateFormat","yy-mm-dd","styleClass","\u201dform-control\u201d","dateFormat","dd-mm-yy",3,"monthNavigator","yearNavigator","showIcon","ngModel","ngModelChange"],["for","endDate",1,"form-label","pt-0"],["styleClass","\u201dform-control\u201d","dateFormat","dd-mm-yy",3,"showIcon","ngModel","ngModelChange"],[3,"value"],[1,"row","gy-2","gx-3","my-3"],[1,"form-icon","form-icon-right"],[1,"icon","ni","ni-search"],["type","text","autocomplete","off","id","default-04","placeholder","Quick search",1,"form-control",3,"ngModel","ngModelChange"],["class","col-auto ",4,"ngIf"],["tooltip","Data export",1,"dropdown"],["href","#","data-bs-toggle","dropdown","aria-expanded","false","title","Export Data",1,"dropdown-toggle","btn","btn-icon","btn-light","btn-outline-light1"],[1,"icon","ni","ni-download"],[1,"dropdown-menu"],[1,"link-list-opt","no-bdr"],[3,"click"],[1,"icon","ni","ni-file-xls"],[2,"cursor","not-allowed"],[1,"icon","ni","ni-file-pdf","disabled"],[1,"text-end"],[3,"showAvatar","fullName","otherFieldName"],[1,"text-end","font-monospace"],[1,"fw-lighter"],[1,"d-block"],[1,"text-primary"]],template:function(a,n){1&a&&(e._UZ(0,"app-add-item",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),e._uU(5,"Search By"),e.qZA(),e._UZ(6,"br"),e.TgZ(7,"div",5)(8,"div",6)(9,"select",7),e.NdJ("ngModelChange",function(p){return n.searchParameter=p})("change",function(){return n.searchParameterListener()}),e.TgZ(10,"option",8),e._uU(11,"Receipt No."),e.qZA(),e.TgZ(12,"option",9),e._uU(13,"Payment Mode No."),e.qZA(),e.TgZ(14,"option",10),e._uU(15,"Estate & block"),e.qZA()()()()()(),e.YNc(16,J,2,1,"ng-container",11),e.YNc(17,F,29,16,"ng-container",11),e.TgZ(18,"div",12)(19,"button",13),e.NdJ("click",function(){return n.searchBillPayments()}),e._uU(20," Search "),e.qZA()()(),e.YNc(21,Y,7,2,"div",14),e.TgZ(22,"p-table",15,16),e.ALo(24,"filter"),e.YNc(25,j,17,0,"ng-template",17),e.YNc(26,G,28,30,"ng-template",18),e.qZA(),e.TgZ(27,"div",19),e._UZ(28,"div",20),e.TgZ(29,"div",20)(30,"div",21)(31,"div",22),e._uU(32," Currency:"),e.TgZ(33,"span",23),e._uU(34," GHS"),e.qZA()(),e.TgZ(35,"div",22),e._uU(36," Total Arrears: "),e.TgZ(37,"span",23),e._uU(38),e.ALo(39,"number"),e.qZA()(),e.TgZ(40,"div",22),e._uU(41," Total Payments: "),e.TgZ(42,"span",23),e._uU(43),e.ALo(44,"number"),e.qZA()(),e.TgZ(45,"div",22),e._uU(46," Outstanding Bal: "),e.TgZ(47,"span",23),e._uU(48),e.ALo(49,"number"),e.qZA()()()()()),2&a&&(e.Q6J("pageTitleName","Bill Payments")("description","Payments of ground and house rents"),e.xp6(9),e.Q6J("ngModel",n.searchParameter),e.xp6(7),e.Q6J("ngIf","BAB"!==n.searchParameter),e.xp6(1),e.Q6J("ngIf","BAB"==n.searchParameter),e.xp6(4),e.Q6J("ngIf",(null==n.billPayments?null:n.billPayments.length)>0),e.xp6(1),e.Q6J("value",e.xi3(24,16,n.billPayments,n.searchedKeyword))("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(28,k))("resizableColumns",!0)("autoLayout",!0),e.xp6(16),e.hij(" ",e.xi3(39,19,n.totalDebit,"1.2-2"),""),e.xp6(5),e.hij(" ",e.xi3(44,22,n.totalCredit,"1.2-2"),""),e.xp6(5),e.hij(" ",e.xi3(49,25,n.balance,"1.2-2"),""))},dependencies:[l.ez,l.sg,l.O5,l.i8,l.JJ,l.rS,l.uU,T.h,d.A0,d.w9,d.jq,h.z8,h.i9,c.u5,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.On,g._8,g.f,K.jx,C.L,m.U$,m.iA,A.$,O.c,D.i,I.e],encapsulation:2}),i})()}}]);