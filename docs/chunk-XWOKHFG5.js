import{a as J}from"./chunk-3VQLASZ2.js";import{a as lt}from"./chunk-J3GFM727.js";import{a as Me,b as xe}from"./chunk-MKJDMB7D.js";import{a as Ie,b as Re,c as Ee}from"./chunk-QQMX5O62.js";import{a as at}from"./chunk-IP4FBAZW.js";import{b as Ze,c as et,d as rt,e as Ae}from"./chunk-7PQCCLGB.js";import{a as it}from"./chunk-T45HSKH6.js";import{b as nt,c as ot,d as se}from"./chunk-WH3N5QDN.js";import{i as We,r as Qe,s as le,t as tt}from"./chunk-KPCRGR73.js";import{h as M,i as ue}from"./chunk-543WOPA4.js";import"./chunk-5WO4BOAD.js";import{a as re}from"./chunk-NEQ5BFSP.js";import{b as He,c as q,e as F,f as G,g as Q,k as Ye,l as Z,n as we,o as ee,p as te,q as ze,r as Xe,s as Ke,u as ie,v as $,w as ne,x as oe}from"./chunk-B2QESFZG.js";import{b as ae}from"./chunk-Y725X6Z7.js";import{b as Ne,c as j}from"./chunk-R55IMLXW.js";import"./chunk-LPKVFVKE.js";import{b as O,d as w,e as E,f as U,g as V}from"./chunk-IHPVOZWG.js";import"./chunk-HPGLX4ZN.js";import{g as Je,m as K,p as W}from"./chunk-7DWKZ4XI.js";import{Ab as y,Bb as $e,Cb as _e,Eb as r,Fb as g,Gb as R,Ic as z,Kc as Fe,Lc as L,Mb as T,Nb as je,Ob as _,Qc as X,Rc as ye,Sa as o,Ta as S,Uc as B,Wb as C,Xb as b,Yb as ke,bb as d,ca as Pe,gb as Ue,ia as be,ib as p,ja as h,la as x,nb as t,ob as n,pb as f,qa as A,qb as qe,ra as I,rb as Ge,s as H,tb as k,wb as u,xb as v}from"./chunk-QRSQYA3Q.js";import{d as Ce,e as P}from"./chunk-5FZOKLP6.js";var ce=Ce(Ne());var ge=Ce(Ne());function gt(l,m){l&1&&(t(0,"div"),f(1,"app-required-field"),n())}function ht(l,m){l&1&&(t(0,"div"),f(1,"app-required-field"),n())}var D=l=>({"is-invalid":l});function vt(l,m){if(l&1&&(t(0,"li")(1,"div",37),f(2,"input",38),t(3,"label",39),r(4),n()()()),l&2){let s=m.$implicit,i=v(2);o(2),y("value",s.dataValue),d("id",s.dataValue)("ngClass",_(5,D,((i.staffForm.gender==null?null:i.staffForm.gender.touched)||(i.staffForm.gender==null?null:i.staffForm.gender.dirty)||i.submitted)&&(i.staffForm.gender==null?null:i.staffForm.gender.errors))),o(1),y("for",s.dataValue),o(1),g(s.dataLabel)}}function St(l,m){if(l&1&&(t(0,"ul",17),p(1,vt,5,7,"li",18),n()),l&2){let s=v();o(1),d("ngForOf",s.listOfGenders)}}function Ct(l,m){if(l&1&&(t(0,"li")(1,"div",40),f(2,"input",41),t(3,"label",39),r(4),n()()()),l&2){let s=m.$implicit,i=v();o(2),y("value",s.dataValue),d("id",s.dataValue)("ngClass",_(5,D,((i.staffForm.gender==null?null:i.staffForm.gender.touched)||(i.staffForm.gender==null?null:i.staffForm.gender.dirty)||i.submitted)&&(i.staffForm.gender==null?null:i.staffForm.gender.errors))),o(1),y("for",s.dataValue),o(1),g(s.dataLabel)}}function bt(l,m){l&1&&(t(0,"div",42),f(1,"app-required-field"),n())}function _t(l,m){l&1&&(t(0,"div"),f(1,"app-required-field"),n())}function Ft(l,m){l&1&&(t(0,"div"),r(1," * Invalid mobile number (must be between 10 and 12 digits) "),n())}function yt(l,m){l&1&&(t(0,"div"),f(1,"app-required-field"),n())}function wt(l,m){l&1&&(t(0,"div"),r(1," Invalid email "),n())}function Nt(l,m){l&1&&(t(0,"div"),f(1,"app-required-field"),n())}function At(l,m){if(l&1&&(t(0,"div",8),f(1,"app-form-label",9),t(2,"div",10),f(3,"input",43),t(4,"span",12),p(5,Nt,2,0,"div",13),n()()()),l&2){let s=v();o(1),d("labelForName","dob")("labelName","Date Of Birth"),o(2),d("ngClass",_(4,D,((s.staffForm.dob==null?null:s.staffForm.dob.touched)||(s.staffForm.dob==null?null:s.staffForm.dob.dirty)||s.submitted)&&!(s.staffForm.dob!=null&&s.staffForm.dob.valid))),o(2),d("ngIf",s.staffForm.dob==null||s.staffForm.dob.errors==null?null:s.staffForm.dob.errors.required)}}function It(l,m){l&1&&(t(0,"span"),f(1,"app-required-field"),n())}function Rt(l,m){if(l&1&&(t(0,"ng-option",44),r(1),n()),l&2){let s=m.$implicit;d("value",s.recordId),o(1),R(" ",s.regionName," ")}}function Et(l,m){l&1&&(t(0,"span"),f(1,"app-required-field"),n())}function Mt(l,m){if(l&1&&(t(0,"ng-option",44),r(1),n()),l&2){let s=m.$implicit;d("value",s.recordId),o(1),R(" ",s.departmentName," ")}}function xt(l,m){l&1&&(t(0,"span"),f(1,"app-required-field"),n())}function Tt(l,m){l&1&&(t(0,"div"),f(1,"app-required-field"),n())}function Bt(l,m){l&1&&(t(0,"div"),f(1,"app-required-field"),n())}function kt(l,m){l&1&&(qe(0),t(1,"div",45),f(2,"input",46),t(3,"label",47),r(4," Save & create new staff "),n()(),Ge())}function Dt(l,m){if(l&1){let s=k();t(0,"div",34)(1,"button",48),u("click",function(){A(s);let a=v();return I(a.updateStaff())}),r(2," Update "),n()()}if(l&2){let s=v();o(1),d("title",s.staffFormGroup.invalid?"There must be errors on the form":"")}}function Lt(l,m){if(l&1){let s=k();t(0,"div",34)(1,"button",48),u("click",function(){A(s);let a=v();return I(a.saveStaff())}),r(2," Save "),n()()}if(l&2){let s=v();o(1),d("title",s.staffFormGroup.invalid?"There must be errors on the form":"")}}var Ot=l=>({"is-valid":l}),Vt=l=>({"is-invalid ":l}),mt=(()=>{let m=class m{constructor(i,a,e,c,N,pe){this.title=i,this.addStaffBsModalRef=a,this.fb=e,this.accountService=c,this.alertService=N,this.logger=pe,this.currentStep=1,this.submitted=!1,this.settingsService=h(se),this.userAccountService=h(J),this.router=h(W),this.accountService.currentUser.subscribe(Se=>this.currentUser=Se)}ngOnInit(){if(this.currentStep=1,this.createStaffForm(),this.isAddMode)this.headerMsg="New staff",this.title.setTitle(this.headerMsg);else if(this.headerMsg="Edit "+this.staff.fullName,this.title.setTitle(this.headerMsg),this.staffFormGroup.patchValue(this.staff),this.staff.dob){let i=this.staff.dob.toString().replace("[UTC]","");this.staffForm.dob.setValue(new Date(i))}this.addStaffBsModalRef.setClass("gray modal-lg modal-dialog-top"),this.listOfGenders=this.settingsService.getGender(),this.listOfUserRoles=this.settingsService.getUserRoles(),this.listOfStatus=this.settingsService.getStatus(),this.fetchRegions(),this.fetchDepartments()}createStaffForm(){this.staffFormGroup=this.fb.group({firstName:["",{updateOn:"blur",validators:[F.required]}],lastName:["",{updateOn:"blur",validators:[F.required]}],gender:["",[F.required]],mobileNo:["",{updateOn:"blur",validators:[F.required,F.minLength(10)]}],email:["",{updateOn:"blur",validators:[F.required,F.email]}],address:["",{updateOn:"blur",validators:[F.required]}],dob:["",{updateOn:"blur",validators:[F.required]}],regionId:["",[F.required]],departmentId:["",[F.required]],officeContactNo:["",[F.required,F.minLength(10)]],saveAndNew:[!1],recordId:[""]})}get staffForm(){return this.staffFormGroup.controls}fetchRegions(){this.listOfRegions=[],this.settingsService.getRegions().subscribe({next:i=>{if(this.logger.info("getRegions response "+JSON.stringify(i)),i.headerResponse.responseCode!=="000"){this.alertService.error(i.headerResponse.responseMessage);return}if(i.regions.length<=0){this.alertService.showInfoMsgGeneral("No regions found"),this.logger.info("No regions found");return}this.listOfRegions=i.regions},error:i=>{this.logger.error(i),this.alertService.showInfoMsg(i)}})}fetchDepartments(){this.listOfDepartments=[],this.userAccountService.getDepartments().subscribe({next:i=>{if(this.logger.info("getDepartments response "+JSON.stringify(i)),i.headerResponse.responseCode!=="000"){this.alertService.error(i.headerResponse.responseMessage);return}if(i.departments.length<=0){this.alertService.showInfoMsgGeneral("No departments found"),this.logger.info("No departments found");return}this.listOfDepartments=i.departments},error:i=>{this.logger.error(i),this.alertService.showInfoMsg(i)}})}saveStaff(){if(this.submitted=!0,this.staffFormGroup.invalid)return;let i=this.staffForm.firstName.value;ge.default.fire({title:"Confirmation",text:`Do you want to create occupant  ${i}?`,icon:"question",position:"top",showCancelButton:!0,confirmButtonText:"Yes, create",cancelButtonText:"No, cancel"}).then(a=>{if(a.value){if(this.alertService.clear(),this.staffFormGroup.invalid)return;this.userAccountService.createStaff(this.currentUser,this.staffFormGroup.value).subscribe({next:e=>{if(e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(`${i} created successfully`),this.staffForm.saveAndNew.value||(this.addStaffBsModalRef.hide(),this.accountService.reloadCurrentRoute()),this.staffFormGroup.reset(),this.submitted=!1,this.logAction(`created institution occupant ${i}`,w.OCCUPANCY)},error:e=>{this.alertService.showInfoMsg(e.message)}})}else a.dismiss,ge.default.DismissReason.cancel})}updateStaff(){if(this.submitted=!0,this.staffFormGroup.invalid)return;let i=this.staffForm.firstName.value;ge.default.fire({position:"top",title:"Confirmation",text:`Do you want to update ${i}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, update"}).then(a=>{a.value?this.userAccountService.updateStaff(this.currentUser,this.staffFormGroup.value).subscribe({next:e=>{if(this.logger.info("updateStaff response:"+JSON.stringify(e)),e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(`${i} updated successfully`),this.addStaffBsModalRef.hide(),this.logAction(`Updated ${i}`,w.OCCUPANCY),this.accountService.reloadCurrentRoute()},error:e=>{this.alertService.showInfoMsg(e.message)}}):(a.dismiss,ge.default.DismissReason.cancel)})}logAction(i,a){return P(this,null,function*(){yield this.accountService.logUserAudit(i,a)})}};m.\u0275fac=function(a){return new(a||m)(S(K),S(M),S(ie),S(V),S(j),S(O))},m.\u0275cmp=x({type:m,selectors:[["ng-component"]],standalone:!0,features:[T],decls:100,vars:77,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right","border","border-gray",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["novalidate","",3,"formGroup"],[1,"row","gy-4","mt-1"],[1,"col-sm-6"],[1,"form-group"],[3,"labelForName","labelName"],[1,"form-control-wrap"],["type","text","formControlName","firstName","id","firstName","autocomplete","off",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],[4,"ngIf"],["type","text","formControlName","lastName","id","lastName","autocomplete","off",1,"form-control",3,"ngClass"],[1,"form-check-label",3,"labelForName","labelName"],["class","custom-control-group",4,"ngIf"],[1,"custom-control-group"],[4,"ngFor","ngForOf"],["class","text-danger mt-1",4,"ngIf"],["type","tel","formControlName","mobileNo","id","mobileNo","autocomplete","off",1,"form-control",3,"ngClass"],["type","email","formControlName","email","id","email","autocomplete","off",1,"form-control",3,"ngClass"],["class","form-group",4,"ngIf"],["styleClass","w-100","formControlName","dob","id","dob","dateFormat","dd-mm-yy",3,"showIcon","ngClass"],["id","regionId","formControlName","regionId",3,"clearable","ngClass"],["value","","disabled","","selected","",1,"fs-6"],[3,"value",4,"ngFor","ngForOf"],["id","departmentId","formControlName","departmentId",3,"clearable","ngClass"],["value","","selected","",1,"fs-6"],["type","tel","formControlName","officeContactNo","id","officeContactNo","autocomplete","off",1,"form-control",3,"ngClass"],["type","text","formControlName","address","id","address","autocomplete","off",1,"form-control",2,"min-height","30px",3,"ngClass"],[1,"row","mt-3"],[1,"col-sm-12"],[1,"row","gx-3","justify-content-end","mt-5"],[1,"col-auto"],["type","button","title","",1,"btn","btn-outline-lighter",3,"click"],["class","col-auto",4,"ngIf"],[1,"custom-control","custom-radio"],["type","radio","formControlName","gender","name","gender",1,"custom-control-input","form-check-input",3,"id","value","ngClass"],[1,"custom-control-label","form-check-label",3,"for"],[1,"custom-control","custom-radio","custom-control-pro","no-control"],["formControlName","gender","name","gender","type","radio",1,"custom-control-input","form-check-input",3,"id","value","ngClass"],[1,"text-danger","mt-1"],["type","date","formControlName","dob","id","dob","autocomplete","off",1,"form-control",3,"ngClass"],[3,"value"],[1,"custom-control","custom-control-sm","custom-checkbox","checked"],["type","checkbox","formControlName","saveAndNew","id","saveAndNew",1,"custom-control-input"],["for","saveAndNew",1,"custom-control-label","fw-bolder"],[1,"btn","btn-primary",3,"title","click"]],template:function(a,e){a&1&&(t(0,"div",0)(1,"h6",1),r(2),C(3,"titlecase"),n(),t(4,"button",2),u("click",function(){return e.addStaffBsModalRef==null?null:e.addStaffBsModalRef.hide()}),t(5,"span",3),r(6,"\xD7"),n()()(),t(7,"div",4),f(8,"app-required-fields-notice"),t(9,"form",5)(10,"div",6)(11,"div",7)(12,"div",8),f(13,"app-form-label",9),t(14,"div",10),f(15,"input",11),t(16,"span",12),p(17,gt,2,0,"div",13),n()()()(),t(18,"div",7)(19,"div",8),f(20,"app-form-label",9),t(21,"div",10),f(22,"input",14),t(23,"span",12),p(24,ht,2,0,"div",13),n()()()(),t(25,"div",7)(26,"div",8),f(27,"app-form-label",15),t(28,"div",10),p(29,St,2,1,"ul",16),t(30,"ul",17),p(31,Ct,5,7,"li",18),n(),p(32,bt,2,0,"div",19),n()()(),t(33,"div",7)(34,"div",8),f(35,"app-form-label",9),t(36,"div",10),f(37,"input",20),t(38,"span",12),p(39,_t,2,0,"div",13)(40,Ft,2,0,"div",13),n()()()(),t(41,"div",7)(42,"div",8),f(43,"app-form-label",9),t(44,"div",10),f(45,"input",21),t(46,"span",12),p(47,yt,2,0,"div",13)(48,wt,2,0,"div",13),n()()()(),t(49,"div",7),p(50,At,6,6,"div",22),t(51,"div",8),f(52,"app-form-label",9)(53,"p-calendar",23),t(54,"span",12),p(55,It,2,0,"span",13),n()()(),t(56,"div",7)(57,"div",8),f(58,"app-form-label",9),t(59,"div",10)(60,"ng-select",24)(61,"ng-option",25),r(62,"Select One"),n(),p(63,Rt,2,2,"ng-option",26),n(),t(64,"span",12),p(65,Et,2,0,"span",13),n()()()(),t(66,"div",7)(67,"div",8),f(68,"app-form-label",9),t(69,"div",10)(70,"ng-select",27)(71,"ng-option",28),r(72,"Select One"),n(),p(73,Mt,2,2,"ng-option",26),n(),t(74,"span",12),p(75,xt,2,0,"span",13),n()()()(),t(76,"div",7)(77,"div",8),f(78,"app-form-label",9),t(79,"div",10),f(80,"input",29),t(81,"span",12),p(82,Tt,2,0,"div",13),n()()()(),t(83,"div",7)(84,"div",8),f(85,"app-form-label",9),t(86,"div",10)(87,"textarea",30),r(88,"                        "),n(),t(89,"span",12),p(90,Bt,2,0,"div",13),n()()()()(),t(91,"div",31)(92,"div",32),p(93,kt,5,0,"ng-container",13),n()(),t(94,"div",33)(95,"div",34)(96,"button",35),u("click",function(){return e.addStaffBsModalRef==null?null:e.addStaffBsModalRef.hide()}),r(97," Close "),n()(),p(98,Dt,3,1,"div",36)(99,Lt,3,1,"div",36),n()()()),a&2&&(o(2),g(b(3,55,e.headerMsg)),o(7),d("formGroup",e.staffFormGroup),o(4),d("labelForName","firstName")("labelName","First Name"),o(2),d("ngClass",_(57,D,((e.staffForm.firstName==null?null:e.staffForm.firstName.touched)||(e.staffForm.firstName==null?null:e.staffForm.firstName.dirty)||e.submitted)&&!(e.staffForm.firstName!=null&&e.staffForm.firstName.valid))),o(2),d("ngIf",e.staffForm.firstName==null||e.staffForm.firstName.errors==null?null:e.staffForm.firstName.errors.required),o(3),d("labelForName","lastName")("labelName","Last Name"),o(2),d("ngClass",_(59,D,((e.staffForm.lastName==null?null:e.staffForm.lastName.touched)||(e.staffForm.lastName==null?null:e.staffForm.lastName.dirty)||e.submitted)&&!(e.staffForm.lastName!=null&&e.staffForm.lastName.valid))),o(2),d("ngIf",e.staffForm.lastName==null||e.staffForm.lastName.errors==null?null:e.staffForm.lastName.errors.required),o(3),d("labelForName","gender")("labelName","Gender"),o(2),d("ngIf",!1),o(2),d("ngForOf",e.listOfGenders),o(1),d("ngIf",e.submitted&&(e.staffForm.gender.errors==null?null:e.staffForm.gender.errors.required)),o(3),d("labelForName","mobileNo")("labelName","Contact Number"),o(2),d("ngClass",_(61,Ot,e.staffForm.lastName==null?null:e.staffForm.lastName.valid))("ngClass",_(63,D,((e.staffForm.mobileNo==null?null:e.staffForm.mobileNo.touched)||(e.staffForm.mobileNo==null?null:e.staffForm.mobileNo.dirty)||e.submitted)&&!(e.staffForm.mobileNo!=null&&e.staffForm.mobileNo.valid))),o(2),d("ngIf",e.staffForm.mobileNo==null||e.staffForm.mobileNo.errors==null?null:e.staffForm.mobileNo.errors.required),o(1),d("ngIf",(e.staffForm.mobileNo==null||e.staffForm.mobileNo.errors==null?null:e.staffForm.mobileNo.errors.minlength)||(e.staffForm.mobileNo==null||e.staffForm.mobileNo.errors==null?null:e.staffForm.mobileNo.errors.maxlength)),o(3),d("labelForName","email")("labelName","Email"),o(2),d("ngClass",_(65,D,((e.staffForm.email==null?null:e.staffForm.email.touched)||(e.staffForm.email==null?null:e.staffForm.email.dirty)||e.submitted)&&!(e.staffForm.email!=null&&e.staffForm.email.valid))),o(2),d("ngIf",e.staffForm.email==null||e.staffForm.email.errors==null?null:e.staffForm.email.errors.required),o(1),d("ngIf",e.staffForm.email==null||e.staffForm.email.errors==null?null:e.staffForm.email.errors.email),o(2),d("ngIf",!1),o(2),d("labelForName","dob")("labelName","Date Of Birth"),o(1),d("showIcon",!0)("ngClass",_(67,D,((e.staffForm.dob==null?null:e.staffForm.dob.touched)||(e.staffForm.dob==null?null:e.staffForm.dob.dirty)||e.submitted)&&!(e.staffForm.dob!=null&&e.staffForm.dob.valid))),o(2),d("ngIf",e.staffForm.dob==null||e.staffForm.dob.errors==null?null:e.staffForm.dob.errors.required),o(3),d("labelForName","regionId")("labelName","Region"),o(2),d("clearable",!1)("ngClass",_(69,Vt,((e.staffForm.regionId==null?null:e.staffForm.regionId.touched)||(e.staffForm.regionId==null?null:e.staffForm.regionId.dirty)||e.submitted)&&(e.staffForm.regionId==null?null:e.staffForm.regionId.errors))),o(3),d("ngForOf",e.listOfRegions),o(2),d("ngIf",e.staffForm.regionId==null||e.staffForm.regionId.errors==null?null:e.staffForm.regionId.errors.required),o(3),d("labelForName","departmentId")("labelName","Department"),o(2),d("clearable",!1)("ngClass",_(71,D,((e.staffForm.departmentId==null?null:e.staffForm.departmentId.touched)||(e.staffForm.departmentId==null?null:e.staffForm.departmentId.dirty)||e.submitted)&&(e.staffForm.departmentId==null?null:e.staffForm.departmentId.errors))),o(3),d("ngForOf",e.listOfDepartments),o(2),d("ngIf",e.staffForm.departmentId==null||e.staffForm.departmentId.errors==null?null:e.staffForm.departmentId.errors.required),o(3),d("labelForName","officeContactNo")("labelName","Office Contact Number"),o(2),d("ngClass",_(73,D,((e.staffForm.officeContactNo==null?null:e.staffForm.officeContactNo.touched)||(e.staffForm.officeContactNo==null?null:e.staffForm.officeContactNo.dirty)||e.submitted)&&!(e.staffForm.officeContactNo!=null&&e.staffForm.officeContactNo.valid))),o(2),d("ngIf",e.staffForm.officeContactNo==null||e.staffForm.officeContactNo.errors==null?null:e.staffForm.officeContactNo.errors.required),o(3),d("labelForName","address")("labelName","Address"),o(2),d("ngClass",_(75,D,((e.staffForm.address==null?null:e.staffForm.address.touched)||(e.staffForm.address==null?null:e.staffForm.address.dirty)||e.submitted)&&!(e.staffForm.address!=null&&e.staffForm.address.valid))),o(3),d("ngIf",e.staffForm.address==null||e.staffForm.address.errors==null?null:e.staffForm.address.errors.required),o(3),d("ngIf",e.isAddMode),o(5),d("ngIf",!e.isAddMode),o(1),d("ngIf",e.isAddMode))},dependencies:[B,z,Fe,L,X,ne,Z,q,He,we,G,Q,ee,te,it,$,oe,re,le,Qe,Ee,Re,Ie],encapsulation:2});let l=m;return l})();var dt=(()=>{let m=class m{constructor(i,a){this.viewStaffBsModalRef=i,this.accountService=a,this.accountService.currentUser.subscribe(e=>this.currentUser=e)}ngOnInit(){this.viewStaffBsModalRef.setClass("gray modal-md modal-dialog-top")}};m.\u0275fac=function(a){return new(a||m)(S(M),S(V))},m.\u0275cmp=x({type:m,selectors:[["ng-component"]],standalone:!0,features:[T],decls:153,vars:50,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right","border","border-gray",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[1,"card","card-no-border"],[1,"pricing-body"],[1,"pricing-features"],[1,"preview-title-lg","overline-title"],[1,"w-50","text-black-50"],[1,"ms-auto"],[1,"preview-title-lg","overline-title","mt-2"],[1,"row","my-3","mx-2","mb-3","justify-content-end"],[1,"col-auto"],[1,"btn","btn-sm","btn-primary",3,"click"]],template:function(a,e){a&1&&(t(0,"div",0)(1,"h6",1),r(2),n(),t(3,"button",2),u("click",function(){return e.viewStaffBsModalRef==null?null:e.viewStaffBsModalRef.hide()}),t(4,"span",3),r(5,"\xD7"),n()()(),t(6,"div",4)(7,"div",5)(8,"div",6)(9,"ul",7)(10,"span",8),r(11,"Personal Information"),n(),t(12,"li")(13,"span",9),r(14,"Full Name"),n(),r(15," - "),t(16,"span",10),r(17),n()(),t(18,"li")(19,"span",9),r(20,"Gender"),n(),r(21," - "),t(22,"span",10),r(23),C(24,"titlecase"),n()(),t(25,"li")(26,"span",9),r(27,"Date Of Birth"),n(),r(28," - "),t(29,"span",10),r(30),C(31,"date"),t(32,"small"),r(33),C(34,"timeAgo"),n()()(),t(35,"li")(36,"span",9),r(37,"Mobile Number"),n(),r(38," - "),t(39,"span",10),r(40),n()(),t(41,"li")(42,"span",9),r(43,"Office Contact Number"),n(),r(44," - "),t(45,"span",10),r(46),n()(),t(47,"li")(48,"span",9),r(49,"Address"),n(),r(50," - "),t(51,"span",10),r(52),n()(),t(53,"span",11),r(54,"User Account "),n(),t(55,"li")(56,"span",9),r(57,"Username"),n(),r(58," - "),t(59,"span",10),r(60),n()(),t(61,"li")(62,"span",9),r(63,"User Role"),n(),r(64," - "),t(65,"span",10),r(66),C(67,"titlecase"),n()(),t(68,"li")(69,"span",9),r(70,"Region"),n(),r(71," - "),t(72,"span",10),r(73),n()(),t(74,"li")(75,"span",9),r(76,"Department"),n(),r(77," - "),t(78,"span",10),r(79),n()(),t(80,"li")(81,"span",9),r(82,"Account Created By"),n(),r(83," - "),t(84,"span",10),r(85),n()(),t(86,"li")(87,"span",9),r(88,"Account Date"),n(),r(89," - "),t(90,"span",10),r(91),C(92,"date"),t(93,"small"),r(94),C(95,"timeAgo"),n()()(),t(96,"li")(97,"span",9),r(98,"Account Status"),n(),r(99," - "),t(100,"span",10),r(101),C(102,"titlecase"),n()(),t(103,"span",11),r(104,"User activities"),n(),t(105,"li")(106,"span",9),r(107,"Created By"),n(),r(108," - "),t(109,"span",10),r(110),n()(),t(111,"li")(112,"span",9),r(113,"Created Date"),n(),r(114," - "),t(115,"span",10),r(116),C(117,"date"),t(118,"small"),r(119),C(120,"timeAgo"),n()()(),t(121,"li")(122,"small"),r(123),C(124,"timeAgo"),n(),t(125,"span",9),r(126,"Last Modified By"),n(),r(127," - "),t(128,"span",10),r(129),n()(),t(130,"li")(131,"span",9),r(132,"Modified Date"),n(),r(133," - "),t(134,"span",10),r(135),C(136,"date"),n()(),t(137,"li")(138,"span",9),r(139,"Last Login Date"),n(),r(140," - "),t(141,"span",10),r(142),C(143,"date"),t(144,"small"),r(145),C(146,"timeAgo"),n()()()(),f(147,"ul"),n()()(),t(148,"div",12)(149,"div",13)(150,"a",14),u("click",function(){return e.viewStaffBsModalRef==null?null:e.viewStaffBsModalRef.hide()}),t(151,"span"),r(152,"Close"),n()()()()),a&2&&(o(2),R("",e.staff.fullName," Details"),o(15),g(e.staff.fullName),o(6),g(b(24,24,e.staff.gender)),o(7),R(" ",b(31,26,e.staff.dob)," "),o(3),g(b(34,28,e.staff.dob)),o(7),g(e.staff.mobileNo),o(6),g(e.staff.officeContactNo),o(6),g(e.staff.address),o(8),g(e.staff.username),o(6),g(b(67,30,e.staff.userRole)),o(7),g(e.staff.regionName),o(6),g(e.staff.departmentName),o(6),g(e.staff.accountCreatedBy),o(6),R(" ",b(92,32,e.staff.accountCreatedDate),", "),o(3),g(b(95,34,e.staff.accountCreatedDate)),o(7),g(b(102,36,e.staff.status)),o(9),g(e.staff.createdBy),o(6),R(" ",b(117,38,e.staff.createdDate),", "),o(3),g(b(120,40,e.staff.createdDate.toString())),o(4),g(b(124,42,e.staff.createdDate.toString())),o(6),g(e.staff.createdBy),o(6),R("",b(136,44,e.staff.lastModifiedDate)," "),o(7),R("",b(143,46,e.staff.lastLoginDate)," "),o(3),g(b(146,48,e.staff.lastLoginDate)))},dependencies:[B,X,ye,Ae],encapsulation:2});let l=m;return l})();var ve=Ce(Ne());function Ut(l,m){l&1&&(t(0,"div",3),r(1,"Copied"),n())}var Be=(()=>{let m=class m{constructor(){this.message="",this.showNotification=!1,this.labelName="",document.addEventListener("copy",this.handleCopyEvent.bind(this))}copyToClipboard(){let i=document.createElement("input");i.value=this.message,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i)}handleCopyEvent(i){let a=i.clipboardData||window.clipboardData;a&&(a.setData("text",this.message),i.preventDefault(),this.showNotification=!0,setTimeout(()=>{this.showNotification=!1},1e3))}};m.\u0275fac=function(a){return new(a||m)},m.\u0275cmp=x({type:m,selectors:[["app-copy-button"]],inputs:{message:"message"},standalone:!0,features:[T],decls:3,vars:2,consts:[["class","text-primary",4,"ngIf"],["tooltip","Copy password",1,"btn","btn-outline-light","text-primary",3,"delay","click"],[1,"icon","ni","ni-copy"],[1,"text-primary"]],template:function(a,e){a&1&&(p(0,Ut,2,0,"div",0),t(1,"button",1),u("click",function(){return e.copyToClipboard()}),f(2,"em",2),n()),a&2&&(d("ngIf",e.showNotification),o(1),d("delay",500))},dependencies:[B,L,xe,Me],styles:[".notification[_ngcontent-%COMP%]{background-color:#f2f2f2;padding:10px;border:1px solid #ccc;border-radius:4px}"]});let l=m;return l})();var de=(()=>{let m=class m{constructor(i,a,e){this.utilsService=i,this.http=a,this.logger=e}createStaff(i,a){return a.headerRequest=this.utilsService.getRequestHeader(i.zoneId,i.regionId,"SAVE_STAFF"),a.createdBy=i.username,a.dob=a.dob,a.lastModifiedBy="NEW_STAFF",this.logger.info("create staff request "+JSON.stringify(a)),this.http.post(`${E.url+w.API_USER_ACCOUNTS}createstaff`,a).pipe(H(E.timeout))}updateStaff(i,a){return a.headerRequest=this.utilsService.getRequestHeader(i.zoneId,i.regionId,"UPDATE_STAFF"),a.lastModifiedBy=i.username,this.logger.info("update staff request "+JSON.stringify(a)),this.http.post(`${E.url+w.API_USER_ACCOUNTS}updatestaff`,a).pipe(H(E.timeout))}deleteStaff(i,a){let e=new nt;return e.recordId=a,e.deletedBy=i.username,e.headerRequest=this.utilsService.getRequestHeader(i.zoneId,i.regionId,"DELETE_STAFF"),this.logger.info("delete staff request "+JSON.stringify(e)),this.http.post(`${E.url+w.API_USER_ACCOUNTS}deletestaff`,e).pipe(H(E.timeout))}searchStaffs(i,a,e){let c=new ot;return c.searchBy=a,c.searchValue=e,c.headerRequest=this.utilsService.getRequestHeader(i.zoneId,i.regionId,"STAFFS_LIST"),this.logger.info("searchStaffs request "+JSON.stringify(c)),this.http.post(`${E.url+w.API_USER_ACCOUNTS}staffs`,c).pipe(H(E.timeout))}createLoginAccount(i,a){return a.headerRequest=this.utilsService.getRequestHeader(i.zoneId,i.regionId,"CREATE_ACCOUNT"),a.createdBy=i.username,this.logger.info("create staff request "+JSON.stringify(a)),this.http.post(`${E.url+w.API_USER_ACCOUNTS}createaccount`,a).pipe(H(E.timeout))}resetPassword(i,a){return a.headerRequest=this.utilsService.getRequestHeader(i.zoneId,i.regionId,"RESET_PASSWORD"),a.createdBy=i.username,this.logger.info("reset staff password request "+JSON.stringify(a)),this.http.post(`${E.url+w.API_USER_ACCOUNTS}adminresetpassword`,a).pipe(H(E.timeout))}};m.\u0275fac=function(a){return new(a||m)(be(U),be(Je),be(O))},m.\u0275prov=Pe({token:m,factory:m.\u0275fac,providedIn:"root"});let l=m;return l})();function qt(l,m){if(l&1&&(t(0,"div",33)(1,"div",34)(2,"div",35),f(3,"app-full-name",36),n()()()),l&2){let s=v();o(3),_e("fullName","",s.staff==null?null:s.staff.fullName," (",s.staff.username,")"),y("otherFieldName",s.staff==null?null:s.staff.email)}}function Gt(l,m){l&1&&(t(0,"div"),f(1,"app-required-field"),n())}function $t(l,m){if(l&1&&(t(0,"ng-option",37),r(1),n()),l&2){let s=m.$implicit;d("value",s.dataValue),o(1),R(" ",s.dataLabel," ")}}function jt(l,m){l&1&&(t(0,"span"),f(1,"app-required-field"),n())}var Oe=l=>({"is-invalid":l});function Jt(l,m){if(l&1&&(t(0,"li")(1,"div",38),f(2,"input",39),t(3,"label",40),r(4),n()()()),l&2){let s=m.$implicit,i=v();o(2),y("value",s.dataValue),d("id",s.dataValue)("ngClass",_(5,Oe,((i.loginAccountForm.status==null?null:i.loginAccountForm.status.touched)||(i.loginAccountForm.status==null?null:i.loginAccountForm.status.dirty)||i.submitted)&&(i.loginAccountForm.status==null?null:i.loginAccountForm.status.errors))),o(1),y("for",s.dataValue),o(1),g(s.dataLabel)}}function Ht(l,m){l&1&&(t(0,"div",41),f(1,"app-required-field"),n())}function Yt(l,m){if(l&1){let s=k();t(0,"div",29)(1,"button",42),u("click",function(){A(s);let a=v();return I(a.updateStaff())}),r(2," Update "),n()()}if(l&2){let s=v();o(1),d("title",s.loginAccountFormGroup.invalid?"There must be errors on the form":"")}}function zt(l,m){if(l&1){let s=k();t(0,"div",29)(1,"button",42),u("click",function(){A(s);let a=v();return I(a.saveStaff())}),r(2," Create "),n()()}if(l&2){let s=v();o(1),d("title",s.loginAccountFormGroup.invalid?"There must be errors on the form":"")}}function Xt(l,m){l&1&&(t(0,"div",43),r(1,` Hello
`),n())}var Kt=l=>({"is-valid":l}),ft=(()=>{let m=class m{constructor(i,a,e,c){this.title=i,this.loginAccountBsModalRef=a,this.fb=e,this.logger=c,this.currentStep=1,this.submitted=!1,this.router=h(W),this.settingsService=h(se),this.userAccountService=h(J),this.accountService=h(V),this.alertService=h(j),this.utilsService=h(U),this.staffService=h(de),this.accountService.currentUser.subscribe(N=>this.currentUser=N)}ngOnInit(){this.currentStep=1,this.createStaffForm(),this.isAddMode?(this.headerMsg="Login profile for "+this.staff.username,this.title.setTitle(this.headerMsg)):(this.headerMsg="Edit login profile for "+this.staff.username,this.title.setTitle(this.headerMsg),this.loginAccountFormGroup.patchValue(this.staff),this.loginAccountFormGroup.patchValue({password:this.utilsService.generatePassword(this.staff.username)})),this.loginAccountFormGroup.patchValue(this.staff),this.loginAccountFormGroup.patchValue({password:this.utilsService.generatePassword(this.staff.username)}),this.loginAccountBsModalRef.setClass("gray modal-sm modal-dialog-top"),this.listOfUserRoles=this.settingsService.getUserRoles(),this.listOfStatus=this.settingsService.getStatus()}createStaffForm(){this.loginAccountFormGroup=this.fb.group({password:["",{updateOn:"blur",validators:[F.required]}],userRole:["",[F.required]],status:["",[F.required]],recordId:[""]})}get loginAccountForm(){return this.loginAccountFormGroup.controls}generatePassword(){this.loginAccountFormGroup.patchValue({password:this.utilsService.generatePassword(this.staff.username)})}saveStaff(){if(this.submitted=!0,this.loginAccountFormGroup.invalid)return;let i=this.staff.fullName;ve.default.fire({title:"Confirmation",text:`Do you want to create account for  ${i}?`,icon:"question",position:"top",showCancelButton:!0,confirmButtonText:"Yes, create",cancelButtonText:"No, cancel"}).then(a=>{if(a.value){if(this.alertService.clear(),this.loginAccountFormGroup.invalid)return;this.staffService.createLoginAccount(this.currentUser,this.loginAccountFormGroup.value).subscribe({next:e=>{if(e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(`${i} created successfully`),this.loginAccountBsModalRef.hide(),this.accountService.reloadCurrentRoute(),this.loginAccountFormGroup.reset(),this.submitted=!1,this.logAction(`created login account for  ${i}`,w.USER_ACCOUNT)},error:e=>{this.alertService.showInfoMsg(e.message)}})}else a.dismiss,ve.default.DismissReason.cancel})}updateStaff(){if(this.submitted=!0,this.loginAccountFormGroup.invalid)return;let i=this.staff.fullName;ve.default.fire({position:"top",title:"Confirmation",text:`Do you want to update ${i}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, update"}).then(a=>{a.value?this.userAccountService.updateStaff(this.currentUser,this.loginAccountFormGroup.value).subscribe({next:e=>{if(this.logger.info("updateStaff response:"+JSON.stringify(e)),e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(`${i} updated successfully`),this.loginAccountBsModalRef.hide(),this.logAction(`Updated ${i}`,w.USER_ACCOUNT),this.accountService.reloadCurrentRoute()},error:e=>{this.alertService.showInfoMsg(e.message)}}):(a.dismiss,ve.default.DismissReason.cancel)})}logAction(i,a){return P(this,null,function*(){yield this.accountService.logUserAudit(i,a)})}};m.\u0275fac=function(a){return new(a||m)(S(K),S(M),S(ie),S(O))},m.\u0275cmp=x({type:m,selectors:[["ng-component"]],standalone:!0,features:[T],decls:45,vars:29,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right","border","border-gray",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["novalidate","",3,"formGroup"],["class","gallery-body card-inner align-center justify-between flex-wrap g-2",4,"ngIf"],[1,"row","gy-4","m-t-10"],[1,"col-12"],[1,"form-control-wrap"],[3,"labelForName","labelName"],[1,"input-group","has-validation"],["type","text","formControlName","password","id","password","autocomplete","off",1,"form-control",3,"ngClass"],[1,"input-group-append"],[3,"message"],["tooltip","Generate new password",1,"btn","btn-outline-light",3,"delay","click"],[1,"icon","ni","ni-repeat"],[1,"invalid-feedback"],[4,"ngIf"],[1,"col-sm-12"],[1,"form-group"],["id","userRole","formControlName","userRole",3,"clearable","ngClass"],["value","","selected","",1,"fs-6"],[3,"value",4,"ngFor","ngForOf"],[1,"form-check-label",3,"labelForName","labelName"],[1,"custom-control-group"],[4,"ngFor","ngForOf"],["class","text-danger mt-1",4,"ngIf"],[1,"row","gx-3","justify-content-end","mt-5"],[1,"col-auto"],["type","button","title","",1,"btn","btn-outline-lighter",3,"click"],["class","col-auto",4,"ngIf"],["class","modal-footer",4,"ngIf"],[1,"gallery-body","card-inner","align-center","justify-between","flex-wrap","g-2"],[1,"user-card"],[1,"user-info"],[3,"fullName","otherFieldName"],[3,"value"],[1,"custom-control","custom-radio","custom-control-pro","no-control"],["formControlName","status","name","status","type","radio",1,"custom-control-input","form-check-input",3,"id","value","ngClass"],[1,"custom-control-label","form-check-label",3,"for"],[1,"text-danger","mt-1"],[1,"btn","btn-primary",3,"title","click"],[1,"modal-footer"]],template:function(a,e){a&1&&(t(0,"div",0)(1,"h6",1),r(2),n(),t(3,"button",2),u("click",function(){return e.loginAccountBsModalRef==null?null:e.loginAccountBsModalRef.hide()}),t(4,"span",3),r(5,"\xD7"),n()()(),t(6,"div",4)(7,"form",5),p(8,qt,4,3,"div",6),t(9,"div",7)(10,"div",8)(11,"div",9),f(12,"app-form-label",10),t(13,"div",11),f(14,"input",12),t(15,"div",13),f(16,"app-copy-button",14),t(17,"button",15),u("click",function(){return e.generatePassword()}),f(18,"em",16),n()(),t(19,"span",17),p(20,Gt,2,0,"div",18),n()()()(),t(21,"div",19)(22,"div",20),f(23,"app-form-label",10),t(24,"div",9)(25,"ng-select",21)(26,"ng-option",22),r(27,"Select One"),n(),p(28,$t,2,2,"ng-option",23),n(),t(29,"span",17),p(30,jt,2,0,"span",18),n()()()(),t(31,"div",19)(32,"div",20),f(33,"app-form-label",24),t(34,"div",9)(35,"ul",25),p(36,Jt,5,7,"li",26),n(),p(37,Ht,2,0,"div",27),n()()()(),t(38,"div",28)(39,"div",29)(40,"button",30),u("click",function(){return e.loginAccountBsModalRef==null?null:e.loginAccountBsModalRef.hide()}),r(41," Close "),n()(),p(42,Yt,3,1,"div",31)(43,zt,3,1,"div",31),n()()(),p(44,Xt,2,0,"div",32)),a&2&&(o(2),g(e.headerMsg),o(5),d("formGroup",e.loginAccountFormGroup),o(1),d("ngIf",!1),o(4),d("labelForName","username")("labelName","Temporary Password"),o(2),d("ngClass",_(23,Kt,e.loginAccountForm.password==null?null:e.loginAccountForm.password.valid))("ngClass",_(25,Oe,((e.loginAccountForm.password==null?null:e.loginAccountForm.password.touched)||(e.loginAccountForm.password==null?null:e.loginAccountForm.password.dirty)||e.submitted)&&!(e.loginAccountForm.password!=null&&e.loginAccountForm.password.valid))),o(2),y("message",e.loginAccountForm.password.value),o(1),d("delay",500),o(3),d("ngIf",e.loginAccountForm.password==null||e.loginAccountForm.password.errors==null?null:e.loginAccountForm.password.errors.required),o(3),d("labelForName","userRole")("labelName","User Role"),o(2),d("clearable",!1)("ngClass",_(27,Oe,((e.loginAccountForm.userRole==null?null:e.loginAccountForm.userRole.touched)||(e.loginAccountForm.userRole==null?null:e.loginAccountForm.userRole.dirty)||e.submitted)&&(e.loginAccountForm.userRole==null?null:e.loginAccountForm.userRole.errors))),o(3),d("ngForOf",e.listOfUserRoles),o(2),d("ngIf",e.loginAccountForm.userRole==null||e.loginAccountForm.userRole.errors==null?null:e.loginAccountForm.userRole.errors.required),o(3),d("labelForName","status")("labelName","Account Status"),o(3),d("ngForOf",e.listOfStatus),o(1),d("ngIf",e.submitted&&(e.loginAccountForm.status.errors==null?null:e.loginAccountForm.status.errors.required)),o(5),d("ngIf",!e.isAddMode),o(1),d("ngIf",e.isAddMode),o(1),d("ngIf",!1))},dependencies:[B,z,Fe,L,ne,Z,q,we,G,Q,ee,te,$,Be,oe,re,le,Ee,Re,Ie,ae,xe,Me],encapsulation:2});let l=m;return l})();var fe=class{};var Ve=Ce(Ne());function Wt(l,m){l&1&&(t(0,"div"),f(1,"app-required-field"),n())}var Qt=l=>({"is-valid":l}),Zt=l=>({"is-invalid":l}),ct=(()=>{let m=class m{constructor(i,a,e,c){this.title=i,this.adminPasswordResetBsModalRef=a,this.fb=e,this.logger=c,this.submitted=!1,this.router=h(W),this.settingsService=h(se),this.userAccountService=h(J),this.accountService=h(V),this.alertService=h(j),this.utilsService=h(U),this.staffService=h(de),this.accountService.currentUser.subscribe(N=>this.currentUser=N)}ngOnInit(){this.createStaffForm(),this.title.setTitle("Password reset"),this.passwordResetFormGroup.patchValue(this.staff),this.passwordResetFormGroup.patchValue({password:this.utilsService.generatePassword(this.staff.username)}),this.adminPasswordResetBsModalRef.setClass("gray modal-sm modal-dialog-top")}createStaffForm(){this.passwordResetFormGroup=this.fb.group({password:["",{updateOn:"blur",validators:[F.required]}],recordId:[""]})}get passwordResetForm(){return this.passwordResetFormGroup.controls}generatePassword(){this.passwordResetFormGroup.patchValue({password:this.utilsService.generatePassword(this.staff.username)})}resetPassword(){let i=this.staff.fullName,a=new fe;a.createdBy=this.staff.username,a.password=this.passwordResetForm.password.value,a.status="RESET",a.userRole=this.staff.userRole,a.recordId=this.staff.recordId,Ve.default.fire({position:"top",title:"Confirmation",text:`Do you want to reset password of ${i}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, reset"}).then(e=>{e.value?this.staffService.resetPassword(this.currentUser,a).subscribe({next:c=>{if(this.logger.info("reset password response:"+JSON.stringify(c)),c.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(c.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(c.headerResponse.responseMessage),this.adminPasswordResetBsModalRef.hide(),this.logAction(`Reset password of ${i}`,w.USER_ACCOUNT),this.accountService.reloadCurrentRoute()},error:c=>{this.alertService.showInfoMsg(c.message)}}):(e.dismiss,Ve.default.DismissReason.cancel)})}logAction(i,a){return P(this,null,function*(){yield this.accountService.logUserAudit(i,a)})}};m.\u0275fac=function(a){return new(a||m)(S(K),S(M),S(ie),S(O))},m.\u0275cmp=x({type:m,selectors:[["ng-component"]],standalone:!0,features:[T],decls:31,vars:15,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right","border","border-gray",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["novalidate","",3,"formGroup"],[1,"gallery-body","card-inner","align-center","justify-between","flex-wrap","g-2"],[1,"user-card"],[1,"user-info"],[3,"fullName","otherFieldName"],[1,"row","gy-4","m-t-10"],[1,"col-12"],[1,"form-control-wrap"],[3,"labelForName","labelName"],[1,"input-group","has-validation"],["type","text","formControlName","password","id","password","autocomplete","off",1,"form-control",3,"ngClass"],[1,"input-group-append"],[3,"message"],[1,"btn","btn-outline-light",3,"click"],[1,"icon","ni","ni-repeat"],[1,"invalid-feedback"],[4,"ngIf"],[1,"row","gx-3","justify-content-end","mt-5"],[1,"col-auto"],["type","button","title","",1,"btn","btn-outline-lighter",3,"click"],[1,"btn","btn-primary",3,"title","click"]],template:function(a,e){a&1&&(t(0,"div",0)(1,"h6",1),r(2,"Password reset"),n(),t(3,"button",2),u("click",function(){return e.adminPasswordResetBsModalRef==null?null:e.adminPasswordResetBsModalRef.hide()}),t(4,"span",3),r(5,"\xD7"),n()()(),t(6,"div",4)(7,"form",5)(8,"div",6)(9,"div",7)(10,"div",8),f(11,"app-full-name",9),n()()(),t(12,"div",10)(13,"div",11)(14,"div",12),f(15,"app-form-label",13),t(16,"div",14),f(17,"input",15),t(18,"div",16),f(19,"app-copy-button",17),t(20,"button",18),u("click",function(){return e.generatePassword()}),f(21,"em",19),n()(),t(22,"span",20),p(23,Wt,2,0,"div",21),n()()()()(),t(24,"div",22)(25,"div",23)(26,"button",24),u("click",function(){return e.adminPasswordResetBsModalRef==null?null:e.adminPasswordResetBsModalRef.hide()}),r(27," Close "),n()(),t(28,"div",23)(29,"button",25),u("click",function(){return e.resetPassword()}),r(30," Reset "),n()()()()()),a&2&&(o(7),d("formGroup",e.passwordResetFormGroup),o(4),_e("fullName","",e.staff==null?null:e.staff.fullName," (",e.staff.username,")"),y("otherFieldName",e.staff==null?null:e.staff.email),o(4),d("labelForName","username")("labelName","Temporary Password"),o(2),d("ngClass",_(11,Qt,e.passwordResetForm.password==null?null:e.passwordResetForm.password.valid))("ngClass",_(13,Zt,((e.passwordResetForm.password==null?null:e.passwordResetForm.password.touched)||(e.passwordResetForm.password==null?null:e.passwordResetForm.password.dirty)||e.submitted)&&!(e.passwordResetForm.password!=null&&e.passwordResetForm.password.valid))),o(2),y("message",e.passwordResetForm.password.value),o(4),d("ngIf",e.passwordResetForm.password==null||e.passwordResetForm.password.errors==null?null:e.passwordResetForm.password.errors.required),o(6),d("title",e.passwordResetFormGroup.invalid?"There must be errors on the form":""))},dependencies:[B,z,L,ne,Z,q,G,Q,ee,te,$,Be,oe,re,ae],encapsulation:2});let l=m;return l})();function ei(l,m){if(l&1){let s=k();t(0,"div",29)(1,"div",6)(2,"label",7),r(3),n(),f(4,"br"),t(5,"div",8)(6,"input",30),u("ngModelChange",function(a){A(s);let e=v();return I(e.searchValue=a)}),n()()()()}if(l&2){let s=v();o(3),g(s.searchValueLabel),o(3),$e("placeholder","Enter ",s.searchPlaceholder,""),d("ngModel",s.searchValue)}}function ti(l,m){l&1&&(t(0,"tr")(1,"th"),r(2,"SN"),n(),t(3,"th"),r(4,"Full Name"),n(),t(5,"th"),r(6,"Username"),n(),t(7,"th"),r(8,"Department"),n(),t(9,"th"),r(10,"Region"),n(),t(11,"th"),r(12,"Gender"),n(),t(13,"th"),r(14,"Status"),n(),t(15,"th"),r(16,"Mobile No."),n(),t(17,"th"),r(18,"Last Login Date"),n(),t(19,"th"),r(20,"Actions"),n()())}function ii(l,m){if(l&1){let s=k();t(0,"a",41),u("click",function(){A(s);let a=v().$implicit,e=v();return I(e.activateDeactivateAccount(a,!1))}),f(1,"em",50),t(2,"span"),r(3,"Deactivate account"),n()()}}function ni(l,m){if(l&1){let s=k();t(0,"a",41),u("click",function(){A(s);let a=v().$implicit,e=v();return I(e.activateDeactivateAccount(a,!0))}),f(1,"em",51),t(2,"span"),r(3,"Activate account"),n()()}}function oi(l,m){if(l&1){let s=k();t(0,"tr")(1,"td"),r(2),n(),t(3,"td"),f(4,"app-full-name",31),n(),t(5,"td"),f(6,"app-full-name",32),C(7,"removeHyphen"),C(8,"titlecase"),n(),t(9,"td"),r(10),n(),t(11,"td"),r(12),n(),t(13,"td"),r(14),C(15,"titlecase"),n(),t(16,"td")(17,"span"),C(18,"statusStyle"),r(19),C(20,"titlecase"),n()(),t(21,"td"),r(22),n(),t(23,"td")(24,"div",33)(25,"small",34),r(26),C(27,"date"),n(),t(28,"small",35),r(29),C(30,"timeAgo"),n()()(),t(31,"td")(32,"div",36)(33,"a",37),f(34,"em",38),n(),t(35,"div",39)(36,"ul",40)(37,"li")(38,"a",41),u("click",function(){let e=A(s).$implicit,c=v();return I(c.addStaffModalComponent(e,!1))}),f(39,"em",42),t(40,"span"),r(41,"Edit staff"),n()()(),t(42,"li")(43,"a",41),u("click",function(){let e=A(s).$implicit,c=v();return I(c.viewStaffModalComponent(e))}),f(44,"em",43),t(45,"span"),r(46,"View profile"),n()()(),t(47,"li")(48,"a",41),u("click",function(){let e=A(s).$implicit,c=v();return I(c.loginAccountModalComponent(e,!0))}),f(49,"em",44),t(50,"span"),r(51,"Login account"),n()()(),t(52,"li"),p(53,ii,4,0,"a",45)(54,ni,4,0,"a",45),n(),t(55,"li")(56,"a",41),u("click",function(){let e=A(s).$implicit,c=v();return I(c.adminPasswordResetModalComponent(e))}),f(57,"em",46),t(58,"span"),r(59,"Reset Password"),n()()(),f(60,"li",47),t(61,"li")(62,"a",48),u("click",function(){let e=A(s).$implicit,c=v();return I(c.deleteStaff(e))}),f(63,"em",49),t(64,"span"),r(65,"Delete"),n()()()()()()()()}if(l&2){let s=m.$implicit,i=m.rowIndex;o(2),g(i+1),o(2),y("fullName",s==null?null:s.fullName),y("otherFieldName",s==null?null:s.email),o(2),y("fullName",s==null?null:s.username),y("otherFieldName",b(7,18,b(8,20,s==null?null:s.userRole))),d("showAvatar",!1),o(4),g(s==null?null:s.departmentName),o(2),g(s==null?null:s.regionName),o(2),g(b(15,22,s==null?null:s.gender)),o(3),Ue("badge badge-dim ",b(18,24,s==null?null:s.status),""),o(2),R(" ",b(20,26,s==null?null:s.status)," "),o(3),g(s==null?null:s.mobileNo),o(4),g(ke(27,28,s.lastLoginDate,"medium")),o(3),R(" ",b(30,31,s.lastLoginDate),""),o(24),d("ngIf",s.status==="ACTIVE"),o(1),d("ngIf",s.status==="INACTIVE")}}var ri=()=>[5,10,25,50],ao=(()=>{let m=class m{constructor(i,a,e,c){this.addStaffBsModalRef=i,this.viewStaffBsModalRef=a,this.loginAccountBsModalRef=e,this.adminPasswordResetBsModalRef=c,this.viewStaffModalService=h(ue),this.addStaffModalService=h(ue),this.loginAccountModalService=h(ue),this.adminPasswordResetModalService=h(ue),this.userAccountService=h(J),this.accountService=h(V),this.alertService=h(j),this.staffService=h(de),this.utilService=h(U),this.logger=h(O),this.accountService.currentUser.subscribe(N=>this.currentUser=N)}ngOnInit(){this.searchBy="ALL",this.fetchStaffs()}ngOnDestroy(){this.addStaffModalService.hide(),this.viewStaffModalService.hide(),this.loginAccountModalService.hide(),ce.default.close()}searchByListener(){if(this.searchValue="",this.searchBy==="lastName"){this.searchValueLabel="Last Name",this.searchPlaceholder=" Enter last name";return}if(this.searchBy==="username"){this.searchValueLabel="Username",this.searchPlaceholder=" Enter username";return}if(this.searchBy==="mobileNo"){this.searchValueLabel="Mobile No",this.searchPlaceholder=" Enter mobile No";return}if(this.searchBy==="email"){this.searchValueLabel="Email Address",this.searchPlaceholder=" Enter email address";return}this.searchBy==="ALL"&&this.fetchStaffs()}fetchStaffs(){this.listOfUsers=[],this.userAccountService.searchStaffs(this.currentUser,this.searchBy,this.searchValue).subscribe({next:i=>{if(this.logger.info("searchStaffs response "+JSON.stringify(i)),i.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(i.headerResponse.responseMessage);return}if(i.staffs.length<=0){this.alertService.showInfoMsgGeneral("No staffs found"),this.logger.info("No staffs found");return}this.listOfUsers=i.staffs},error:i=>{this.logger.error(i),this.alertService.showInfoMsg(i)}})}activateDeactivateAccount(i,a){let e=i.fullName,c=new fe,N="",pe="";a?(c.status="ACTIVE",N=`Do you want to activate account of ${e}?`,pe=`Activated account of ${e}`):(c.status="INACTIVE",N=`Do you want to deactivate account of ${e}?`,pe=`Deactivated account of ${e}`),c.createdBy=i.username,c.password=this.utilService.generatePassword(i.username),c.userRole=i.userRole,c.recordId=i.recordId,ce.default.fire({position:"top",title:"Confirmation",text:N,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes,"+a?"Activate":"Deactivate"}).then(Se=>{Se.value?this.staffService.resetPassword(this.currentUser,c).subscribe({next:Y=>{if(this.logger.info("activate/deactivate account response:"+JSON.stringify(Y)),Y.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(Y.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(Y.headerResponse.responseMessage),this.addStaffBsModalRef.hide(),this.logAction(pe,w.USER_ACCOUNT),this.accountService.reloadCurrentRoute()},error:Y=>{this.alertService.showInfoMsg(Y.message)}}):(Se.dismiss,ce.default.DismissReason.cancel)})}deleteStaff(i){let a=i.fullName;ce.default.fire({position:"top",title:"Confirmation",text:`Do you want to delete ${a}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, delete"}).then(e=>{e.value?this.userAccountService.deleteStaff(this.currentUser,i.recordId).subscribe({next:c=>{if(this.logger.info("deleteStaff response:"+JSON.stringify(c)),c.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(c.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(`${a} deleted successfully`),this.addStaffBsModalRef.hide(),this.logAction(`Updated ${a}`,w.USER_ACCOUNT),this.accountService.reloadCurrentRoute()},error:c=>{this.alertService.showInfoMsg(c.message)}}):(e.dismiss,ce.default.DismissReason.cancel)})}addStaffModalComponent(i,a){let e={initialState:{isAddMode:a,staff:i}};this.addStaffModalService.config.ignoreBackdropClick=!0,this.addStaffModalService.config.animated=!0,this.addStaffBsModalRef=this.addStaffModalService.show(mt,e),this.addStaffBsModalRef.content.closeBtnName="Close"}viewStaffModalComponent(i){let a={initialState:{staff:i}};this.viewStaffModalService.config.ignoreBackdropClick=!0,this.viewStaffModalService.config.animated=!0,this.viewStaffBsModalRef=this.addStaffModalService.show(dt,a),this.viewStaffBsModalRef.content.closeBtnName="Close"}loginAccountModalComponent(i,a){let e={initialState:{staff:i,isAddMode:a}};this.loginAccountModalService.config.ignoreBackdropClick=!0,this.loginAccountModalService.config.animated=!0,this.loginAccountBsModalRef=this.addStaffModalService.show(ft,e),this.loginAccountBsModalRef.content.closeBtnName="Close"}adminPasswordResetModalComponent(i){let a={initialState:{staff:i}};this.adminPasswordResetModalService.config.ignoreBackdropClick=!0,this.adminPasswordResetModalService.config.animated=!0,this.adminPasswordResetBsModalRef=this.addStaffModalService.show(ct,a),this.adminPasswordResetBsModalRef.content.closeBtnName="Close"}logAction(i,a){return P(this,null,function*(){yield this.accountService.logUserAudit(i,a)})}};m.\u0275fac=function(a){return new(a||m)(S(M),S(M),S(M),S(M))},m.\u0275cmp=x({type:m,selectors:[["ng-component"]],standalone:!0,features:[T],decls:45,vars:16,consts:[[3,"pageTitleName","description"],[1,"newItemName"],["aria-expanded","false",1,"btn","btn-primary",3,"click"],[1,"icon","ni","ni-plus"],[1,"row","gy-2","gx-3","mt-5","mb-4","align-items-center"],[1,"col-sm-2"],[1,"form-group"],["for","startDate",1,"form-label","pt-0"],[1,"form-control-wrap"],[1,"form-control-select"],["id","searchBy",1,"form-control",3,"ngModel","ngModelChange","change"],["value","ALL","selected","",1,"fs-6"],["value","lastName","selected","",1,"fs-6"],["value","username","selected","",1,"fs-6"],["value","mobileNo"],["value","email"],["class","col-sm-3",4,"ngIf"],[1,"col-auto"],["type","button","title","",1,"btn","btn-dim","btn-primary","mt-4",3,"click"],[1,"btn","mt-4","btn-outline-light",3,"click"],[1,"icon","ni","ni-download"],[1,"row","gy-2","gx-3","my-3"],[1,"form-icon","form-icon-right"],[1,"icon","ni","ni-search"],["type","text","id","default-04","placeholder","Quick search",1,"form-control",3,"ngModel","ngModelChange"],["responsiveLayout","scroll","sortMode","multiple","responsiveLayout","scroll","styleClass","p-datatable-sm p-datatable-striped","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","scrollDirection","both",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","resizableColumns","autoLayout"],["dt1",""],["pTemplate","header"],["pTemplate","body"],[1,"col-sm-3"],["id","searchBy",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[3,"fullName","otherFieldName"],[3,"showAvatar","fullName","otherFieldName"],[1,"fw-lighter"],[1,"d-block"],[1,"text-primary"],[1,"drodown"],["data-bs-toggle","dropdown","aria-expanded","false",1,"dropdown-toggle","btn","btn-icon","btn-light"],[1,"icon","ni","ni-more-h"],[1,"dropdown-menu","dropdown-menu-end"],[1,"link-list-opt","no-bdr"],[3,"click"],[1,"icon","ni","ni-edit"],[1,"icon","ni","ni-eye"],[1,"icon","ni","ni-user-add"],[3,"click",4,"ngIf"],[1,"icon","ni","ni-reload-alt"],[1,"divider"],[1,"text-danger",3,"click"],[1,"icon","ni","ni-trash"],[1,"icon","ni","ni-user-cross"],[1,"icon","ni","ni-user-check"]],template:function(a,e){a&1&&(t(0,"app-add-item",0)(1,"span",1)(2,"a",2),u("click",function(){return e.addStaffModalComponent(null,!0)}),f(3,"em",3),t(4,"span"),r(5,"Add user"),n()()()(),t(6,"div",4)(7,"div",5)(8,"div",6)(9,"label",7),r(10,"Search Type"),n(),f(11,"br"),t(12,"div",8)(13,"div",9)(14,"select",10),u("ngModelChange",function(N){return e.searchBy=N})("change",function(){return e.searchByListener()}),t(15,"option",11),r(16,"All Staffs"),n(),t(17,"option",12),r(18,"Last Name"),n(),t(19,"option",13),r(20,"Username"),n(),t(21,"option",14),r(22,"Mobile Number"),n(),t(23,"option",15),r(24,"Email"),n()()()()()(),p(25,ei,7,3,"div",16),t(26,"div",17)(27,"button",18),u("click",function(){return e.fetchStaffs()}),r(28," Search "),n()(),t(29,"div",17)(30,"a",19),u("click",function(){return e.fetchStaffs()}),f(31,"em",20),t(32,"span"),r(33,"Export"),n()()()(),t(34,"div",21)(35,"div",17)(36,"div",8)(37,"div",22),f(38,"em",23),n(),t(39,"input",24),u("ngModelChange",function(N){return e.searchedKeyword=N}),n()()()(),t(40,"p-table",25,26),C(42,"filter"),p(43,ti,21,0,"ng-template",27)(44,oi,66,33,"ng-template",28),n()),a&2&&(d("pageTitleName","User Accounts")("description","List of users"),o(14),d("ngModel",e.searchBy),o(11),d("ngIf",e.searchBy!=="ALL"),o(14),d("ngModel",e.searchedKeyword),o(1),d("value",ke(42,12,e.listOfUsers,e.searchedKeyword))("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",je(15,ri))("resizableColumns",!0)("autoLayout",!0))},dependencies:[B,L,X,ye,$,Xe,Ke,q,ze,G,Ye,le,We,tt,et,Ze,rt,ae,Ae,at,lt],encapsulation:2});let l=m;return l})();export{ao as StaffListComponent};
