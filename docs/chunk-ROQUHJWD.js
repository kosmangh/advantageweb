import{a as W,b as Z,c as ee}from"./chunk-QQMX5O62.js";import{a as Ve}from"./chunk-IP4FBAZW.js";import{b as De,c as Oe,d as Ge,e as Ue}from"./chunk-7PQCCLGB.js";import{a as Ye}from"./chunk-T45HSKH6.js";import{b as ke,d as Q}from"./chunk-WH3N5QDN.js";import{i as Be,t as Le}from"./chunk-KPCRGR73.js";import{h as X,i as se}from"./chunk-543WOPA4.js";import"./chunk-5WO4BOAD.js";import{a as Ae}from"./chunk-NEQ5BFSP.js";import{b as Se,c as $,e as N,f as H,g as _e,k as be,l as Ie,m as Pe,o as Fe,p as Ee,q as Me,r as xe,s as Ne,u as we,v as J,w as Re,x as K}from"./chunk-B2QESFZG.js";import"./chunk-Y725X6Z7.js";import{b as Te,c as z}from"./chunk-R55IMLXW.js";import"./chunk-LPKVFVKE.js";import{b as D,d as S,e as F,f as O,g as L}from"./chunk-IHPVOZWG.js";import"./chunk-HPGLX4ZN.js";import{g as ye,m as ve}from"./chunk-7DWKZ4XI.js";import{Eb as o,Fb as u,Gb as v,Ic as ue,Kc as V,Lc as q,Mb as T,Nb as he,Ob as x,Qc as A,Rc as Ce,Sa as a,Sc as fe,Ta as c,Tc as j,Uc as B,Wb as C,Xb as P,Yb as _,bb as d,ca as me,ia as U,ib as h,la as R,nb as t,ob as r,pb as g,qa as b,qb as ge,ra as I,rb as ce,s as k,tb as M,wb as f,xb as y}from"./chunk-QRSQYA3Q.js";import{d as de,e as G}from"./chunk-5FZOKLP6.js";var ie=de(Te());var w=de(Te());var te=class{};var re=(()=>{let s=class s{constructor(i,n,e){this.utilsService=i,this.http=n,this.logger=e}getPropertyCharges(i,n,e){let m=new te;return m.regionId=n,m.chargeYear=e,m.headerRequest=this.utilsService.getRequestHeader(i.zoneId,i.regionId,"PROPERTY_CHARGE_LIST"),this.logger.info("getPropertyCharges list request "+JSON.stringify(m)),this.http.post(`${F.url+S.API_ESTATE_BILLING}propertycharges`,m).pipe(k(F.timeout))}createPropertyCharge(i,n){return n.createdBy=i.username,n.headerRequest=this.utilsService.getRequestHeader(i.zoneId,i.regionId,"CREATE_PROPERTY_CHARGE"),this.logger.info("createPropertyCharge request "+JSON.stringify(n)),this.http.post(`${F.url+S.API_ESTATE_BILLING}createpropertycharge`,n).pipe(k(F.timeout))}updatePropertyCharge(i,n){return n.headerRequest=this.utilsService.getRequestHeader(i.zoneId,i.regionId,"UPDATE_PROPERTY_CHARGE"),n.lastModifiedBy=i.username,this.logger.info("update zone request "+JSON.stringify(n)),this.http.post(`${F.url+S.API_ESTATE_BILLING}updatepropertycharge`,n).pipe(k(F.timeout))}deletePropertyCharge(i,n){let e=new ke;return e.recordId=n,e.deletedBy=i.username,e.headerRequest=this.utilsService.getRequestHeader(i.zoneId,i.regionId,"DELETE_PROPERTY_CHARGE"),this.logger.info("deletePropertyCharge request "+JSON.stringify(e)),this.http.post(`${F.url+S.API_ESTATE_BILLING}deletepropertycharge`,e).pipe(k(F.timeout))}};s.\u0275fac=function(n){return new(n||s)(U(O),U(ye),U(D))},s.\u0275prov=me({token:s,factory:s.\u0275fac,providedIn:"root"});let l=s;return l})();function rt(l,s){if(l&1&&(t(0,"div",28),g(1,"br"),o(2),g(3,"br"),o(4),g(5,"br"),o(6),g(7,"br"),o(8),C(9,"json"),r()),l&2){let p=y();a(2),v("Dirty: ",p.propertyChargeFormGroup.dirty," "),a(2),v("Touched: ",p.propertyChargeFormGroup.touched," "),a(2),v("Valid: ",p.propertyChargeFormGroup.valid," "),a(2),v("Value: ",P(9,4,p.propertyChargeFormGroup.value)," ")}}function it(l,s){if(l&1&&(t(0,"option",29),o(1),r()),l&2){let p=s.$implicit;d("value",p.recordId),a(1),v(" ",p.regionName," ")}}function ot(l,s){l&1&&(t(0,"div"),g(1,"app-required-field"),r())}function nt(l,s){if(l&1&&(t(0,"ng-option",29),o(1),r()),l&2){let p=s.$implicit;d("value",p),a(1),v(" ",p," ")}}function at(l,s){l&1&&(t(0,"span"),g(1,"app-required-field"),r())}function lt(l,s){if(l&1&&(t(0,"option",29),o(1),r()),l&2){let p=s.$implicit;d("value",p.dataValue),a(1),v(" ",p.dataLabel," ")}}function st(l,s){l&1&&(t(0,"div"),g(1,"app-required-field"),r())}function pt(l,s){l&1&&(t(0,"div"),g(1,"app-required-field"),r())}function dt(l,s){l&1&&(t(0,"div"),g(1,"app-required-field"),r())}function mt(l,s){l&1&&(t(0,"div"),g(1,"app-required-field"),r())}function gt(l,s){l&1&&(ge(0),t(1,"div",30),g(2,"input",31),t(3,"label",32),o(4," Save & create new "),r()(),ce())}function ct(l,s){if(l&1){let p=M();t(0,"div",25)(1,"button",33),f("click",function(){b(p);let n=y();return I(n.updatePropertyCharge())}),o(2," Update "),r()()}if(l&2){let p=y();a(1),d("title",p.propertyChargeFormGroup.invalid?"There must be errors on the form":"")}}function ht(l,s){if(l&1){let p=M();t(0,"div",25)(1,"button",33),f("click",function(){b(p);let n=y();return I(n.savePropertyCharge())}),o(2," Save "),r()()}if(l&2){let p=y();a(1),d("title",p.propertyChargeFormGroup.invalid?"There must be errors on the form":"")}}var Y=l=>({"is-invalid":l}),Ke=(()=>{let s=class s{constructor(i,n,e,m,E,oe,ne,ae,le){this.propertyChargeService=i,this.utilsService=n,this.settingsService=e,this.title=m,this.addPropertyChargeBsModalRef=E,this.fb=oe,this.accountService=ne,this.alertService=ae,this.logger=le,this.submitted=!1,this.accountService.currentUser.subscribe(Qe=>this.currentUser=Qe)}ngOnInit(){this.createNewForm(),this.isAddMode?(this.propertyChargeHeaderMsg="New property charge",this.title.setTitle(this.propertyChargeHeaderMsg),this.propertyChargeFormGroup.patchValue({chargeYear:new Date().getFullYear(),regionId:this.currentUser.regionId})):(this.propertyChargeHeaderMsg="Edit property charge",this.title.setTitle(this.propertyChargeHeaderMsg),this.propertyChargeFormGroup.patchValue(this.propertyCharge)),this.addPropertyChargeBsModalRef.setClass("gray modal-md modal-dialog-top"),this.listOfChargeYears=this.utilsService.getChargeYears(),this.listOfUsages=this.settingsService.getPropertyUsage(),this.fetchRegions()}createNewForm(){this.propertyChargeFormGroup=this.fb.group({regionId:["",[N.required]],chargeYear:["",[N.required]],propertyUsage:["",[N.required]],firstClassCharge:["",{updateOn:"blur",validators:[N.required]}],secondClassCharge:["",{updateOn:"blur",validators:[N.required]}],thirdClassCharge:["",{updateOn:"blur",validators:[N.required]}],recordId:[""],saveAndNew:[!0]})}get propertyChargeForm(){return this.propertyChargeFormGroup.controls}fetchRegions(){this.listOfRegions=[],this.settingsService.getRegions().subscribe({next:i=>{if(this.logger.info("getRegions response "+JSON.stringify(i)),i.headerResponse.responseCode!=="000"){this.alertService.error(i.headerResponse.responseMessage);return}if(i.regions.length<=0){this.alertService.showInfoMsgGeneral("No regions found"),this.logger.info("No regions found");return}this.listOfRegions=i.regions},error:i=>{this.logger.error(i),this.alertService.showInfoMsg(i)}})}savePropertyCharge(){if(this.submitted=!0,this.propertyChargeFormGroup.invalid)return;let i=this.propertyChargeForm.propertyUsage.value;w.default.fire({title:"Confirmation",text:`Do you want to save property charge  ${i}?`,icon:"question",position:"top",showCancelButton:!0,confirmButtonText:"Yes, create",cancelButtonText:"No, cancel"}).then(n=>{n.value?(this.alertService.clear(),this.propertyChargeService.createPropertyCharge(this.currentUser,this.propertyChargeFormGroup.value).subscribe({next:e=>{if(e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(e.headerResponse.responseMessage),this.propertyChargeForm.saveAndNew.value||(this.addPropertyChargeBsModalRef.hide(),this.accountService.reloadCurrentRoute());let m=this.propertyChargeFormGroup.value.regionId,E=this.propertyChargeFormGroup.value.chargeYear;this.propertyChargeFormGroup.reset(),this.propertyChargeFormGroup.patchValue({regionId:m,chargeYear:E}),localStorage.setItem("region",m),localStorage.setItem("year",E),this.submitted=!1,this.logAction(`created PropertyCharge ${i}`,S.ESTATE_BILLING)},error:e=>{this.alertService.showInfoMsg(e)}})):(n.dismiss,w.default.DismissReason.cancel)})}updatePropertyCharge(){if(this.submitted=!0,this.propertyChargeFormGroup.invalid)return;let i=this.propertyChargeForm.propertyUsage.value;w.default.fire({position:"top",title:"Confirmation",text:`Do you want to update PropertyCharge ${i}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, update"}).then(n=>{n.value?(this.alertService.clear(),this.propertyChargeService.updatePropertyCharge(this.currentUser,this.propertyChargeFormGroup.value).subscribe({next:e=>{if(this.logger.info("updateUserAccount response:"+JSON.stringify(e)),e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(e.headerResponse.responseMessage),this.addPropertyChargeBsModalRef.hide(),this.logAction(`Updated ${i}`,S.ESTATE_BILLING),this.accountService.reloadCurrentRoute()},error:e=>{this.alertService.showInfoMsg(e.message)}})):(n.dismiss,w.default.DismissReason.cancel)})}deletePropertyCharge(){let i=this.propertyChargeForm.PropertyChargeName.value;w.default.fire({position:"top",title:"Deletion",text:`Do you want to delete PropertyCharge ${i}?`,icon:"error",showCancelButton:!0,confirmButtonText:"Yes, delete",cancelButtonText:"No, cancel"}).then(n=>{if(n.value){if(this.alertService.clear(),this.propertyChargeFormGroup.invalid)return;this.propertyChargeService.deletePropertyCharge(this.currentUser,this.propertyChargeForm.recordId.value).subscribe({next:e=>{if(this.logger.info("delete PropertyCharge response:"+JSON.stringify(e)),e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(e.headerResponse.responseMessage),this.addPropertyChargeBsModalRef.hide(),this.logAction(`delete PropertyCharge  ${i}`,S.ESTATE_BILLING),this.accountService.reloadCurrentRoute()},error:e=>{this.alertService.showInfoMsg(e)}})}else n.dismiss,w.default.DismissReason.cancel})}logAction(i,n){return G(this,null,function*(){yield this.accountService.logUserAudit(i,n)})}};s.\u0275fac=function(n){return new(n||s)(c(re),c(O),c(Q),c(ve),c(X),c(we),c(L),c(z),c(D))},s.\u0275cmp=R({type:s,selectors:[["app-add-property-charge"]],standalone:!0,features:[T],decls:73,vars:48,consts:[["novalidate","",3,"formGroup"],[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right","border","border-gray",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["class","p-10",4,"ngIf"],[1,"row","gy-3","mt-3"],[1,"col-sm-6"],[1,"form-group"],[3,"labelForName","labelName"],[1,"form-control-wrap"],[1,"form-control-select"],["id","regionId","formControlName","regionId",1,"form-control",3,"ngClass"],["value","","selected","","disabled","",1,"fs-6"],[3,"value",4,"ngFor","ngForOf"],[1,"invalid-feedback"],[4,"ngIf"],["id","chargeYear","formControlName","chargeYear",3,"clearable","ngClass"],["id","regionId","formControlName","propertyUsage",1,"form-control",3,"ngClass"],["value","","selected","",1,"fs-6"],["type","number","formControlName","firstClassCharge","id","firstClassCharge","autocomplete","off",1,"form-control",3,"ngClass"],["type","number","formControlName","secondClassCharge","id","secondClassCharge","autocomplete","off",1,"form-control",2,"min-height","40px",3,"ngClass"],["type","number","formControlName","thirdClassCharge","id","thirdClassCharge","autocomplete","off",1,"form-control",2,"min-height","40px",3,"ngClass"],[1,"row","my-3","mx-2","mb-3","justify-content-end"],[1,"col-auto"],["data-bs-dismiss","modal",1,"btn","btn-outline-light","btn-sm",3,"click"],["class","col-auto",4,"ngIf"],[1,"p-10"],[3,"value"],[1,"custom-control","custom-control-sm","custom-checkbox","checked"],["type","checkbox","formControlName","saveAndNew","id","saveAndNew","id","saveAndNew",1,"custom-control-input"],["for","saveAndNew",1,"custom-control-label","fw-bolder"],[1,"btn","btn-primary","btn-sm",3,"title","click"]],template:function(n,e){n&1&&(t(0,"form",0)(1,"div",1)(2,"h6",2),o(3),C(4,"titlecase"),r(),t(5,"button",3),f("click",function(){return e.addPropertyChargeBsModalRef==null?null:e.addPropertyChargeBsModalRef.hide()}),t(6,"span",4),o(7,"\xD7"),r()()(),t(8,"div",5),h(9,rt,10,6,"div",6),g(10,"app-required-fields-notice"),t(11,"div",7)(12,"div",8)(13,"div",9),g(14,"app-form-label",10),t(15,"div",11)(16,"div",12)(17,"select",13)(18,"option",14),o(19,"Select One"),r(),h(20,it,2,2,"option",15),r(),t(21,"span",16),h(22,ot,2,0,"div",17),r()()()()(),t(23,"div",8)(24,"div",9),g(25,"app-form-label",10),t(26,"div",11)(27,"ng-select",18)(28,"ng-option",14),o(29,"Select One"),r(),h(30,nt,2,2,"ng-option",15),r(),t(31,"span",16),h(32,at,2,0,"span",17),r()()()(),t(33,"div",8)(34,"div",9),g(35,"app-form-label",10),t(36,"div",11)(37,"div",12)(38,"select",19)(39,"option",20),o(40,"Select One"),r(),h(41,lt,2,2,"option",15),r(),t(42,"span",16),h(43,st,2,0,"div",17),r()()()()(),t(44,"div",8)(45,"div",9),g(46,"app-form-label",10),t(47,"div",11),g(48,"input",21),t(49,"span",16),h(50,pt,2,0,"div",17),r()()()(),t(51,"div",8)(52,"div",9),g(53,"app-form-label",10),t(54,"div",11),g(55,"input",22),t(56,"span",16),h(57,dt,2,0,"div",17),r()()()(),t(58,"div",8)(59,"div",9),g(60,"app-form-label",10),t(61,"div",11),g(62,"input",23),t(63,"span",16),h(64,mt,2,0,"div",17),r()()()(),t(65,"div",8),h(66,gt,5,0,"ng-container",17),r()()(),t(67,"div",24)(68,"div",25)(69,"button",26),f("click",function(){return e.addPropertyChargeBsModalRef==null?null:e.addPropertyChargeBsModalRef.hide()}),o(70," Close "),r()(),h(71,ct,3,1,"div",27)(72,ht,3,1,"div",27),r()()),n&2&&(d("formGroup",e.propertyChargeFormGroup),a(3),u(P(4,34,e.propertyChargeHeaderMsg)),a(6),d("ngIf",!1),a(5),d("labelForName","regionId")("labelName","Region"),a(3),d("ngClass",x(36,Y,((e.propertyChargeForm.regionId==null?null:e.propertyChargeForm.regionId.touched)||(e.propertyChargeForm.regionId==null?null:e.propertyChargeForm.regionId.dirty)||e.submitted)&&(e.propertyChargeForm.regionId==null?null:e.propertyChargeForm.regionId.errors))),a(3),d("ngForOf",e.listOfRegions),a(2),d("ngIf",e.propertyChargeForm.regionId==null||e.propertyChargeForm.regionId.errors==null?null:e.propertyChargeForm.regionId.errors.required),a(3),d("labelForName","chargeYear")("labelName","Charge Year"),a(2),d("clearable",!1)("ngClass",x(38,Y,((e.propertyChargeForm.chargeYear==null?null:e.propertyChargeForm.chargeYear.touched)||(e.propertyChargeForm.chargeYear==null?null:e.propertyChargeForm.chargeYear.dirty)||e.submitted)&&(e.propertyChargeForm.chargeYear==null?null:e.propertyChargeForm.chargeYear.errors))),a(3),d("ngForOf",e.listOfChargeYears),a(2),d("ngIf",e.propertyChargeForm.chargeYear==null||e.propertyChargeForm.chargeYear.errors==null?null:e.propertyChargeForm.chargeYear.errors.required),a(3),d("labelForName","propertyUsage")("labelName","Property Usage"),a(3),d("ngClass",x(40,Y,((e.propertyChargeForm.propertyUsage==null?null:e.propertyChargeForm.propertyUsage.touched)||(e.propertyChargeForm.propertyUsage==null?null:e.propertyChargeForm.propertyUsage.dirty)||e.submitted)&&(e.propertyChargeForm.propertyUsage==null?null:e.propertyChargeForm.propertyUsage.errors))),a(3),d("ngForOf",e.listOfUsages),a(2),d("ngIf",e.propertyChargeForm.propertyUsage==null||e.propertyChargeForm.propertyUsage.errors==null?null:e.propertyChargeForm.propertyUsage.errors.required),a(3),d("labelForName","firstClassCharge")("labelName","First Class Charge"),a(2),d("ngClass",x(42,Y,((e.propertyChargeForm.firstClassCharge==null?null:e.propertyChargeForm.firstClassCharge.touched)||(e.propertyChargeForm.firstClassCharge==null?null:e.propertyChargeForm.firstClassCharge.dirty)||e.submitted)&&(e.propertyChargeForm.firstClassCharge==null?null:e.propertyChargeForm.firstClassCharge.errors))),a(2),d("ngIf",e.propertyChargeForm.firstClassCharge==null||e.propertyChargeForm.firstClassCharge.errors==null?null:e.propertyChargeForm.firstClassCharge.errors.required),a(3),d("labelForName","secondClassCharge")("labelName","Second Class Charge"),a(2),d("ngClass",x(44,Y,((e.propertyChargeForm.secondClassCharge==null?null:e.propertyChargeForm.secondClassCharge.touched)||(e.propertyChargeForm.secondClassCharge==null?null:e.propertyChargeForm.secondClassCharge.dirty)||e.submitted)&&(e.propertyChargeForm.secondClassCharge==null?null:e.propertyChargeForm.secondClassCharge.errors))),a(2),d("ngIf",e.propertyChargeForm.secondClassCharge==null||e.propertyChargeForm.secondClassCharge.errors==null?null:e.propertyChargeForm.secondClassCharge.errors.required),a(3),d("labelForName","thirdClassCharge")("labelName","Third Class Charge"),a(2),d("ngClass",x(46,Y,((e.propertyChargeForm.thirdClassCharge==null?null:e.propertyChargeForm.thirdClassCharge.touched)||(e.propertyChargeForm.thirdClassCharge==null?null:e.propertyChargeForm.thirdClassCharge.dirty)||e.submitted)&&(e.propertyChargeForm.thirdClassCharge==null?null:e.propertyChargeForm.thirdClassCharge.errors))),a(2),d("ngIf",e.propertyChargeForm.thirdClassCharge==null||e.propertyChargeForm.thirdClassCharge.errors==null?null:e.propertyChargeForm.thirdClassCharge.errors.required),a(2),d("ngIf",e.isAddMode),a(5),d("ngIf",!e.isAddMode),a(1),d("ngIf",e.isAddMode))},dependencies:[B,ue,V,q,fe,A,J,Ie,xe,Ne,$,Pe,Se,Me,H,_e,Re,Fe,Ee,Ye,K,Ae,ee,Z,W],encapsulation:2});let l=s;return l})();var Xe=(()=>{let s=class s{constructor(i,n){this.addPropertyChargeDetailsBsModalRef=i,this.accountService=n,this.accountService.currentUser.subscribe(e=>this.currentUser=e)}ngOnInit(){this.addPropertyChargeDetailsBsModalRef.setClass("gray modal-md modal-dialog-top")}};s.\u0275fac=function(n){return new(n||s)(c(X),c(L))},s.\u0275cmp=R({type:s,selectors:[["app-property-charge-details"]],standalone:!0,features:[T],decls:91,vars:33,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right","border","border-gray",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[1,"card","card-no-border"],[1,"pricing-body"],[1,"pricing-features"],[1,"preview-title-lg","overline-title"],[1,"w-50","text-soft"],[1,"ms-auto","text-solid"],[1,"preview-title-lg","overline-title","mt-2"],[1,"ms-auto","text-solid","text-primary"],[1,"row","my-3","mx-2","mb-3","justify-content-end"],[1,"col-auto"],[1,"btn","btn-sm","btn-primary",3,"click"]],template:function(n,e){n&1&&(t(0,"div",0)(1,"h6",1),o(2,"Property Charge Details"),r(),t(3,"button",2),f("click",function(){return e.addPropertyChargeDetailsBsModalRef==null?null:e.addPropertyChargeDetailsBsModalRef.hide()}),t(4,"span",3),o(5,"\xD7"),r()()(),t(6,"div",4)(7,"div",5)(8,"div",6)(9,"ul",7)(10,"span",8),o(11,"Charge Information"),r(),t(12,"li")(13,"span",9),o(14,"Region"),r(),o(15," - "),t(16,"span",10),o(17),r()(),t(18,"li")(19,"span",9),o(20,"Charge Year"),r(),o(21," - "),t(22,"span",10),o(23),r()(),t(24,"li")(25,"span",9),o(26,"Property Usage"),r(),o(27," - "),t(28,"span",10),o(29),C(30,"titlecase"),r()(),t(31,"li")(32,"span",9),o(33,"First Class Charge"),r(),o(34," - "),t(35,"span",10),o(36),C(37,"number"),r()(),t(38,"li")(39,"span",9),o(40,"Second Class Charge"),r(),o(41," - "),t(42,"span",10),o(43),C(44,"number"),r()(),t(45,"li")(46,"span",9),o(47,"Third Class Charge"),r(),o(48," - "),t(49,"span",10),o(50),C(51,"number"),r()(),t(52,"span",11),o(53,"User Activities"),r(),t(54,"li")(55,"span",9),o(56,"Created By"),r(),o(57," - "),t(58,"span",10),o(59),r()(),t(60,"li")(61,"span",9),o(62,"Created Date"),r(),o(63," - "),t(64,"span",10),o(65),C(66,"date"),r(),t(67,"span",12),o(68),C(69,"timeAgo"),r()(),t(70,"li")(71,"span",9),o(72,"Last Modified By"),r(),o(73," - "),t(74,"span",10),o(75),r()(),t(76,"li")(77,"span",9),o(78,"Last Modified Date"),r(),o(79," - "),t(80,"span",10),o(81),C(82,"date"),r(),t(83,"span",12),o(84),C(85,"timeAgo"),r()()()()()(),t(86,"div",13)(87,"div",14)(88,"a",15),f("click",function(){return e.addPropertyChargeDetailsBsModalRef==null?null:e.addPropertyChargeDetailsBsModalRef.hide()}),t(89,"span"),o(90,"Close"),r()()()()),n&2&&(a(17),u(e.propertyCharge.regionName),a(6),u(e.propertyCharge.chargeYear),a(6),u(P(30,12,e.propertyCharge.propertyUsage)),a(7),u(_(37,14,e.propertyCharge.firstClassCharge,".2-2")),a(7),u(_(44,17,e.propertyCharge.secondClassCharge,".2-2")),a(7),u(_(51,20,e.propertyCharge.thirdClassCharge,".2-2")),a(9),u(e.propertyCharge.createdBy),a(6),v(" ",_(66,23,e.propertyCharge.createdDate,"medium")," "),a(3),v(" : ",P(69,26,e.propertyCharge.createdDate.toString())," "),a(7),u(e.propertyCharge.createdBy),a(6),v(" ",_(82,28,e.propertyCharge.lastModifiedDate,"medium")," "),a(3),v(" : ",P(85,31,e.propertyCharge.lastModifiedDate.toString())," "))},dependencies:[B,j,A,Ce,Ue],encapsulation:2});let l=s;return l})();function ut(l,s){if(l&1&&(t(0,"ng-option",20),o(1),r()),l&2){let p=s.$implicit;d("value",p.recordId),a(1),v(" ",p.regionName," ")}}function Ct(l,s){if(l&1){let p=M();t(0,"div",6)(1,"div",7),g(2,"app-form-label",8),t(3,"div",9)(4,"ng-select",18),f("ngModelChange",function(n){b(p);let e=y();return I(e.regionId=n)}),t(5,"ng-option",19),o(6,"Select Region"),r(),h(7,ut,2,2,"ng-option",11),r()()()()}if(l&2){let p=y();a(2),d("labelForName","regionId")("labelName","Region"),a(2),d("clearable",!1)("ngModel",p.regionId),a(3),d("ngForOf",p.listOfRegions)}}function ft(l,s){if(l&1&&(t(0,"ng-option",20),o(1),r()),l&2){let p=s.$implicit;d("value",p),a(1),v(" ",p," ")}}function yt(l,s){if(l&1){let p=M();t(0,"div",6)(1,"div",21)(2,"div",22),g(3,"em",23),r(),t(4,"input",24),f("ngModelChange",function(n){b(p);let e=y();return I(e.searchedKeyword=n)}),r()()()}if(l&2){let p=y();a(4),d("ngModel",p.searchedKeyword)}}function vt(l,s){l&1&&(t(0,"tr")(1,"th"),o(2,"SN"),r(),t(3,"th"),o(4,"Region"),r(),t(5,"th",25),o(6,"Charge Year"),r(),t(7,"th"),o(8,"Property Usage"),r(),t(9,"th",25),o(10,"First Class Charge"),r(),t(11,"th",25),o(12,"Second Class Charge"),r(),t(13,"th",25),o(14,"Third Class Charge"),r(),t(15,"th"),o(16,"Actions"),r()())}function St(l,s){if(l&1){let p=M();t(0,"td")(1,"div",38),f("click",function(){b(p);let n=y().$implicit,e=y();return I(e.openPropertyChargeModalComponent(n,!1))}),t(2,"div",39)(3,"span"),g(4,"em",33),r()()()()}}function _t(l,s){if(l&1){let p=M();t(0,"tr")(1,"td"),o(2),r(),t(3,"td"),o(4),r(),t(5,"td",25),o(6),r(),t(7,"td"),o(8),C(9,"removeHyphen"),C(10,"titlecase"),r(),t(11,"td",25),o(12),C(13,"number"),r(),t(14,"td",25),o(15),C(16,"number"),r(),t(17,"td",25),o(18),C(19,"number"),r(),h(20,St,5,0,"td",26),t(21,"td")(22,"div",27)(23,"a",28),g(24,"em",29),r(),t(25,"div",30)(26,"ul",31)(27,"li")(28,"a",32),f("click",function(){let e=b(p).$implicit,m=y();return I(m.openPropertyChargeModalComponent(e,!1))}),g(29,"em",33),t(30,"span"),o(31,"Edit charges"),r()()(),t(32,"li")(33,"a",32),f("click",function(){let e=b(p).$implicit,m=y();return I(m.openChargeDetailsModalComponent(e))}),g(34,"em",34),t(35,"span"),o(36,"View details"),r()()(),g(37,"div",35),t(38,"li")(39,"a",36),f("click",function(){let e=b(p).$implicit,m=y();return I(m.openDeleteChargeModalComponent(e))}),g(40,"em",37),t(41,"span"),o(42,"Delete"),r()()()()()()()()}if(l&2){let p=s.$implicit,i=s.rowIndex;a(2),u(i+1),a(2),u(p.regionName),a(2),u(p.chargeYear),a(2),u(P(9,8,P(10,10,p.propertyUsage))),a(4),u(_(13,12,p.firstClassCharge,".2-2")),a(3),u(_(16,15,p.secondClassCharge,".2-2")),a(3),u(_(19,18,p.thirdClassCharge,".2-2")),a(2),d("ngIf",!1)}}var bt=()=>[5,10,25,50],hr=(()=>{let s=class s{constructor(i,n,e,m,E,oe,ne,ae){this.utilsService=i,this.accountService=n,this.alertService=e,this.settingService=m,this.logger=E,this.propertyChargeService=oe,this.propertyChargeModalService=ne,this.propertyChargeDetailsModalService=ae,this.accountService.currentUser.subscribe(le=>this.currentUser=le)}ngOnInit(){this.logAction("Viewed property charges page",S.ESTATE_BILLING),this.regionId=localStorage.getItem("region")??this.currentUser.regionId,this.chargeYear=Number(localStorage.getItem("year")??new Date().getFullYear()),this.listOfChargeYears=this.utilsService.getChargeYears(),this.fetchRegions(),this.refreshButton()}ngOnDestroy(){this.propertyChargeModalService.hide(),ie.default.close()}fetchRegions(){this.listOfRegions=[],this.settingService.getRegions().subscribe({next:i=>{if(this.logger.info("getRegions response "+JSON.stringify(i)),i.headerResponse.responseCode!=="000"){this.alertService.error(i.headerResponse.responseMessage);return}if(i.regions.length<=0){this.alertService.showInfoMsgGeneral("No regions found"),this.logger.info("No regions found");return}this.listOfRegions=i.regions},error:i=>{this.logger.error(i),this.alertService.showInfoMsg(i)}})}refreshButton(){this.fetchPropertyCharges()}fetchPropertyCharges(){this.listOfPropertyCharges=[],this.propertyChargeService.getPropertyCharges(this.currentUser,this.regionId,this.chargeYear).subscribe({next:i=>{if(this.logger.info("getPropertyCharges response "+JSON.stringify(i)),i.headerResponse.responseCode!=="000"){this.alertService.error(i.headerResponse.responseMessage);return}if(i.propertyCharges.length<=0){this.alertService.showInfoMsgGeneral("No property charges found"),this.logger.info("No property charges found");return}this.listOfPropertyCharges=i.propertyCharges},error:i=>{this.logger.error(i),this.alertService.showInfoMsg(i)}})}openPropertyChargeModalComponent(i,n){let e={initialState:{isAddMode:n,propertyCharge:i}};this.propertyChargeModalService.config.ignoreBackdropClick=!0,this.propertyChargeModalService.config.animated=!0,this.addPropertyChargeBsModalRef=this.propertyChargeModalService.show(Ke,e),this.addPropertyChargeBsModalRef.content.closeBtnName="Close"}openChargeDetailsModalComponent(i){let n={initialState:{propertyCharge:i}};this.propertyChargeDetailsModalService.config.ignoreBackdropClick=!0,this.propertyChargeDetailsModalService.config.animated=!0,this.addPropertyChargeDetailsBsModalRef=this.propertyChargeDetailsModalService.show(Xe,n),this.addPropertyChargeDetailsBsModalRef.content.closeBtnName="Close"}openDeleteChargeModalComponent(i){let n=i.propertyUsage.toLowerCase();ie.default.fire({position:"top",title:"Confirmation",text:`Do you want to delete charge of ${n} for ${i.chargeYear}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, delete"}).then(e=>{e.value?this.propertyChargeService.deletePropertyCharge(this.currentUser,i.recordId).subscribe({next:m=>{if(this.logger.info("delete Occupant response:"+JSON.stringify(m)),m.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(m.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(m.headerResponse.responseMessage),this.propertyChargeModalService.hide(),this.logAction(`Deleted property charge  of ${n} for ${i.chargeYear}`,S.ESTATE_BILLING),this.accountService.reloadCurrentRoute()},error:m=>{this.alertService.showInfoMsg(m.message)}}):(e.dismiss,ie.default.DismissReason.cancel)})}logAction(i,n){return G(this,null,function*(){yield this.accountService.logUserAudit(i,n)})}};s.\u0275fac=function(n){return new(n||s)(c(O),c(L),c(z),c(Q),c(D),c(re),c(se),c(se))},s.\u0275cmp=R({type:s,selectors:[["ng-component"]],standalone:!0,features:[T],decls:23,vars:20,consts:[[3,"pageTitleName","description"],[1,"newItemName"],[1,"btn","btn-primary",3,"click"],[1,"icon","ni","ni-plus"],[1,"row","gy-2","gx-3","mb-4","align-items-center"],["class","col-sm-2",4,"ngIf"],[1,"col-sm-2"],[1,"form-group"],[3,"labelForName","labelName"],[1,"form-control-wrap"],["id","chargeYear",3,"clearable","ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"col-auto"],["type","button","title","",1,"btn","btn-dim","btn-primary","mt-4",3,"click"],["responsiveLayout","scroll","sortMode","multiple","responsiveLayout","scroll","styleClass","p-datatable-sm p-datatable-striped","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","scrollDirection","both",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","resizableColumns","autoLayout"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["id","regionId",3,"clearable","ngModel","ngModelChange"],["value","A","selected","",1,"fs-6"],[3,"value"],[1,"form-control-wrap","mt-4"],[1,"form-icon","form-icon-right"],[1,"icon","ni","ni-search"],["type","text","id","default-04","placeholder"," Search property here",1,"form-control",3,"ngModel","ngModelChange"],[1,"text-end"],[4,"ngIf"],[1,"drodown"],["data-bs-toggle","dropdown","aria-expanded","false",1,"dropdown-toggle","btn","btn-icon","btn-light"],[1,"icon","ni","ni-more-h"],[1,"dropdown-menu","dropdown-menu-end"],[1,"link-list-opt","no-bdr"],[3,"click"],[1,"icon","ni","ni-edit"],[1,"icon","ni","ni-eye"],[1,"divider"],[1,"text-danger",3,"click"],[1,"icon","ni","ni-delete"],[1,"align-center","select-cursor",3,"click"],[1,"user-avatar","user-avatar-sm","bg-light"]],template:function(n,e){n&1&&(t(0,"app-add-item",0)(1,"span",1)(2,"a",2),f("click",function(){return e.openPropertyChargeModalComponent(null,!0)}),g(3,"em",3),t(4,"span"),o(5,"Add property charge"),r()()()(),t(6,"div",4),h(7,Ct,8,5,"div",5),t(8,"div",6)(9,"div",7),g(10,"app-form-label",8),t(11,"div",9)(12,"ng-select",10),f("ngModelChange",function(E){return e.chargeYear=E})("change",function(){return e.fetchPropertyCharges()}),h(13,ft,2,2,"ng-option",11),r()()()(),h(14,yt,5,1,"div",5),t(15,"div",12)(16,"button",13),f("click",function(){return e.refreshButton()}),o(17," Search "),r()()(),t(18,"p-table",14,15),C(20,"filter"),h(21,vt,17,0,"ng-template",16)(22,_t,43,21,"ng-template",17),r()),n&2&&(d("pageTitleName","Property Charge setup")("description","This is a yearly ground rent  bill setup for residential,commercial,institutional etc. properties"),a(7),d("ngIf",!1),a(3),d("labelForName","chargeYear")("labelName","Charge Year"),a(2),d("clearable",!1)("ngModel",e.chargeYear),a(1),d("ngForOf",e.listOfChargeYears),a(1),d("ngIf",(e.listOfPropertyCharges==null?null:e.listOfPropertyCharges.length)>0),a(4),d("value",_(20,16,e.listOfPropertyCharges,e.searchedKeyword))("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",he(19,bt))("resizableColumns",!0)("autoLayout",!0))},dependencies:[B,V,q,j,A,Oe,De,Be,J,$,H,be,ee,Z,W,Le,Ge,K,Ve],encapsulation:2});let l=s;return l})();export{hr as PropertyChargeListComponent};
