import{a as de}from"./chunk-2LQIRPNS.js";import{a as pe}from"./chunk-NXAZBSFM.js";import{a as ce}from"./chunk-FMEHXA2G.js";import{a as ae,b as le,c as se}from"./chunk-QQMX5O62.js";import{a as me}from"./chunk-IP4FBAZW.js";import{a as ee,b as te,c as ie,d as oe}from"./chunk-7PQCCLGB.js";import{d as re}from"./chunk-WH3N5QDN.js";import{i as W,s as Z,t as ne}from"./chunk-KPCRGR73.js";import"./chunk-5WO4BOAD.js";import{c as q,f as G,k as H,n as $,q as j,r as z,s as J,v as K}from"./chunk-B2QESFZG.js";import{b as X}from"./chunk-Y725X6Z7.js";import{b as ge,c as Q}from"./chunk-R55IMLXW.js";import"./chunk-LPKVFVKE.js";import{b as F,f as U,g as Y}from"./chunk-IHPVOZWG.js";import"./chunk-HPGLX4ZN.js";import"./chunk-7DWKZ4XI.js";import{Ab as w,Bb as B,Eb as n,Fb as v,Gb as f,Kc as k,Lc as I,Mb as A,Nb as O,Qc as R,Sa as a,Ta as T,Tc as V,Uc as L,Wb as h,Xb as E,Yb as S,bb as m,ib as g,ja as x,jb as y,la as D,nb as e,ob as i,pb as d,qa as b,ra as N,tb as M,wb as p,xb as u}from"./chunk-QRSQYA3Q.js";import{d as he,e as P}from"./chunk-5FZOKLP6.js";var ue=he(ge());function fe(o,s){if(o&1){let t=M();e(0,"div",10)(1,"div",13)(2,"label",12),n(3),i(),d(4,"br"),e(5,"input",44),p("ngModelChange",function(c){b(t);let l=u(2);return N(l.searchValue=c)}),i()()()}if(o&2){let t=u(2);a(3),v(t.searchParameterLabel),a(2),B("placeholder","Enter ",t.searchParameterLabel,""),m("ngModel",t.searchValue)}}function _e(o,s){if(o&1&&g(0,fe,6,3,"div",43),o&2){let t=u();m("ngIf",t.searchParameter)}}function ve(o,s){if(o&1&&(e(0,"ng-option",51),n(1),i()),o&2){let t=s.$implicit;m("value",t.recordId),a(1),f(" ",t.estateName," ")}}function Ce(o,s){if(o&1&&(e(0,"ng-option",51),n(1),i()),o&2){let t=s.$implicit;m("value",t.recordId),a(1),f(" ",t.block," ")}}function Se(o,s){if(o&1){let t=M();e(0,"div",45)(1,"div",11)(2,"label",46),n(3,"Estates"),i(),d(4,"br"),e(5,"div",13)(6,"ng-select",47),p("ngModelChange",function(c){b(t);let l=u();return N(l.estate=c)})("change",function(){b(t);let c=u();return N(c.fetchEstateBlocks())}),e(7,"ng-option",48),n(8,"Select Estate"),i(),g(9,ve,2,2,"ng-option",26),i()()()(),e(10,"div",23)(11,"div",11)(12,"label",24),n(13,"Blocks"),i(),d(14,"br"),e(15,"div",13)(16,"ng-select",49),p("ngModelChange",function(c){b(t);let l=u();return N(l.block=c)}),e(17,"ng-option",50),n(18,"Select Block"),i(),g(19,Ce,2,2,"ng-option",26),i()()()()}if(o&2){let t=u();a(6),m("clearable",!1)("ngModel",t.estate),a(3),m("ngForOf",t.listOfEstates),a(7),m("clearable",!1)("ngModel",t.block),a(3),m("ngForOf",t.listOfEstateBlocks)}}function be(o,s){if(o&1&&(e(0,"ng-option",51),n(1),h(2,"titlecase"),i()),o&2){let t=s.$implicit;m("value",t),a(1),f(" ",E(2,2,t)," ")}}function Ne(o,s){if(o&1){let t=M();e(0,"div",23)(1,"div",11)(2,"label",52),n(3,"Bill Month"),i(),d(4,"br"),e(5,"div",13)(6,"ng-select",53),p("ngModelChange",function(c){b(t);let l=u();return N(l.billMonth=c)}),g(7,be,3,4,"ng-option",26),i()()()()}if(o&2){let t=u();a(6),m("clearable",!1)("ngModel",t.billMonth),a(1),m("ngForOf",t.listOfMonths)}}function xe(o,s){if(o&1&&(e(0,"ng-option",51),n(1),i()),o&2){let t=s.$implicit;m("value",t),a(1),f(" ",t," ")}}function ye(o,s){if(o&1){let t=M();e(0,"div",10)(1,"button",54),p("click",function(){b(t);let c=u();return N(c.printDemandNotice())}),d(2,"em",55),e(3,"span"),n(4,"Print demand notice"),i()()()}}function Me(o,s){o&1&&(e(0,"tr")(1,"th"),n(2,"Occupant"),i(),e(3,"th"),n(4,"Street Name(Block)"),i(),e(5,"th"),n(6,"File No."),i(),e(7,"th"),n(8,"Property No."),i(),e(9,"th"),n(10,"Property Class"),i(),e(11,"th"),n(12,"Location"),i(),e(13,"th",56),n(14,"Current Charge"),i(),e(15,"th",56),n(16,"Arrears"),i(),e(17,"th",56),n(18,"Total Amount Due"),i()())}function Ee(o,s){if(o&1&&(e(0,"small"),n(1),h(2,"titlecase"),h(3,"removeHyphen"),i()),o&2){let t=u().$implicit;a(1),f("(",E(2,1,E(3,3,t==null?null:t.entryType)),")")}}function Te(o,s){if(o&1&&(e(0,"tr")(1,"td"),d(2,"app-full-name",57),i(),e(3,"td"),n(4),i(),e(5,"td"),n(6),i(),e(7,"td"),n(8),i(),e(9,"td"),n(10),h(11,"titlecase"),i(),e(12,"td"),n(13),i(),e(14,"td",56),g(15,Ee,4,5,"small"),e(16,"span",58),n(17),h(18,"number"),i()(),e(19,"td",59)(20,"span",60),n(21),h(22,"number"),i()(),e(23,"td",59)(24,"span",60),n(25),h(26,"number"),i()()()),o&2){let t=s.$implicit;a(2),w("fullName",t==null?null:t.lessee),m("showAvatar",!1),a(2),v(t==null?null:t.streetName),a(2),v(t==null?null:t.fileNo),a(2),v(t==null?null:t.propertyNo),a(2),v(E(11,11,t==null?null:t.propertyClass)),a(3),v(t==null?null:t.location),a(2),y(15,(t==null?null:t.currentCharge)<0?15:-1),a(2),f(" ",S(18,13,(t==null?null:t.currentCharge)<0?(t==null?null:t.currentCharge)*-1:t==null?null:t.currentCharge,".2-2")," "),a(4),v(S(22,16,t==null?null:t.arrears,".2-2")),a(4),v(S(26,19,t==null?null:t.totalAmountDue,".2-2"))}}var Pe=()=>[5,10,25,50],lt=(()=>{let s=class s{constructor(r,c){this.billPaymentService=r,this.logger=c,this.showOccupantSearchBy=!0,this.settingsService=x(re),this.accountService=x(Y),this.alertService=x(Q),this.utilsService=x(U),this.occupantsService=x(ce),this.searchParameter="BAB",this.accountService.currentUser.subscribe(l=>this.currentUser=l)}ngOnInit(){this.searchParameter=="BAB",this.chargeYear=this.utilsService.getFirstDayDate().getFullYear(),this.billMonth=this.utilsService.getCurrentMonthName(),this.billType="GROUND_RENT",this.estate="A",this.block="A",this.totalArrears=0,this.totalCurrentCharge=0,this.totalAmountDue=0,this.searchParameterListener(),this.listOfChargeYears=this.utilsService.getChargeYears(),this.listOfMonths=this.utilsService.getMonthsOfYear()}ngOnDestroy(){ue.default.close()}resetList(){this.demandNotices=[]}searchParameterListener(){if(this.searchParameter=="NAM"){this.searchParameterLabel="Occupant Name";return}if(this.searchParameter=="MOB"){this.searchParameterLabel="Mobile No.";return}if(this.searchParameter=="PNAM"){this.searchParameterLabel="Property Name";return}if(this.searchParameter=="PNO"){this.searchParameterLabel="Property No";return}this.searchParameter=="BAB"&&(this.estate="A",this.block="A",this.fetchEstates(),this.listOfEstateBlocks=[])}searchBillPayments(){this.request=new de,this.request.searchParameter=this.searchParameter,this.request.searchValue=this.searchValue,this.request.billYear=this.chargeYear,this.request.billType=this.billType,this.request.billMonth=this.billType==="GROUND_RENT"?"":this.billMonth,this.searchParameter=="BAB"&&(this.request.searchValue=this.block),this.totalArrears=0,this.totalCurrentCharge=0,this.totalAmountDue=0,this.demandNotices=[],this.billPaymentService.generateDemandNotice(this.currentUser,this.request).subscribe({next:r=>{if(this.logger.info("generateDemandNotice response "+JSON.stringify(r)),r.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(r.headerResponse.responseMessage);return}if(r.demandNotices.length<=0){this.alertService.showInfoMsgGeneral("No demand notice found"),this.logger.info("No demand notice found");return}this.demandNotices=r.demandNotices,this.totalCurrentCharge=r.totalCurrentCharge,this.totalArrears=r.totalArrears,this.totalAmountDue=r.totalAmountDue},error:r=>{this.logger.error(r),this.alertService.showInfoMsg(r)}})}export(){}printDemandNotice(){this.billPaymentService.generateJasperReport(this.currentUser,this.request)}fetchEstates(){this.listOfEstates=[],this.settingsService.getEstates().subscribe({next:r=>{if(this.logger.info("getEstates response "+JSON.stringify(r)),r.headerResponse.responseCode!=="000"){this.alertService.error(r.headerResponse.responseMessage);return}if(r.estates.length<=0){this.alertService.showInfoMsgGeneral("No zones found"),this.logger.info("No zones found");return}this.listOfEstates=r.estates},error:r=>{this.logger.error(r),this.alertService.showInfoMsg(r)}})}fetchEstateBlocks(){this.listOfEstateBlocks=[],this.settingsService.getEstateBlocks(this.currentUser,this.estate).subscribe({next:r=>{if(this.logger.info("getEstates response "+JSON.stringify(r)),r.headerResponse.responseCode!=="000"){this.alertService.error(r.headerResponse.responseMessage);return}if(r.estateBlocks.length<=0){this.alertService.showInfoMsgGeneral("No blocks found"),this.logger.info("No blocks found ");return}this.listOfEstateBlocks=r.estateBlocks},error:r=>{this.logger.error(r.message),this.alertService.showInfoMsg(r.message)}})}logAction(r,c){return P(this,null,function*(){yield this.accountService.logUserAudit(r,c)})}};s.\u0275fac=function(c){return new(c||s)(T(pe),T(F))},s.\u0275cmp=D({type:s,selectors:[["ng-component"]],standalone:!0,features:[A],decls:82,vars:35,consts:[[3,"pageTitleName","description"],[1,"row","mt-5"],[1,"col-md-2","col-sm-6"],[1,"preview-block"],[1,"custom-control","custom-radio",3,"click"],["type","radio","id","rentType1","name","rentType","checked","","value","GROUND_RENT",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","rentType1",1,"custom-control-label"],["type","radio","id","rentType2","name","rentType","value","HOUSE_RENT",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","rentType2",1,"custom-control-label"],[1,"row","mt-4"],[1,"col-auto"],[1,"form-group"],["for","searchParameter",1,"form-label","pt-0"],[1,"form-control-wrap"],[1,"form-control-select"],["id","searchParameter",1,"form-control",3,"ngModel","ngModelChange","change"],["value","BAB"],["value","NAM","selected","",1,"fs-6"],["value","MOB","selected","",1,"fs-6"],["value","PNAM","selected","",1,"fs-6"],["value","PNO","selected","",1,"fs-6"],["class","col-auto"],["class","col-sm-2"],[1,"col-sm-2"],["for","block",1,"form-label","pt-0"],["id","chargeYear",3,"clearable","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-auto",2,"margin-top","30px"],["type","button",1,"btn","btn-dim","btn-primary",3,"click"],[1,"row","my-4"],[1,"form-icon","form-icon-right"],[1,"icon","ni","ni-search"],["type","text","autocomplete","off","id","default-04","placeholder","Quick search",1,"form-control",3,"ngModel","ngModelChange"],["styleClass","p-datatable-sm p-datatable-striped","responsiveLayout","scroll","sortMode","multiple","responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","scrollDirection","both",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","resizableColumns","autoLayout"],["dt1",""],["pTemplate","header"],["pTemplate","body"],[1,"row","mt-3","justify-content-end"],[1,"col-6"],[1,"row","gy-2"],[1,"col-sm-12","text-end"],[1,"ff-mono","fw-bolder"],[1,"ff-mono","fw-bolder","fs-19px"],["class","col-auto",4,"ngIf"],["type","text","autocomplete","off","id","searchParameter",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[1,"col-sm-3"],["for","estate",1,"form-label","pt-0"],["id","estate",3,"clearable","ngModel","ngModelChange","change"],["value","A","selected","","disabled","",1,"fs-6"],["id","block",3,"clearable","ngModel","ngModelChange"],["value","A","disabled","","selected","",1,"fs-6"],[3,"value"],["for","billMonth",1,"form-label","pt-0"],["id","billMonth",3,"clearable","ngModel","ngModelChange"],["type","button",1,"btn","btn-light",3,"click"],[1,"icon","ni","ni-printer"],[1,"text-end"],["otherFieldName","",3,"showAvatar","fullName"],[1,"fs-15px","font-monospace"],[1,"text-end","font-monospace"],[1,"fs-15px"]],template:function(c,l){c&1&&(d(0,"app-add-item",0),e(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),p("click",function(){return l.resetList()}),e(5,"input",5),p("ngModelChange",function(_){return l.billType=_}),i(),e(6,"label",6),n(7,"Ground Rent"),i()()()(),e(8,"div",2)(9,"div",3)(10,"div",4),p("click",function(){return l.resetList()}),e(11,"input",7),p("ngModelChange",function(_){return l.billType=_}),i(),e(12,"label",8),n(13,"House Rent"),i()()()()(),e(14,"div",9)(15,"div",10)(16,"div",11)(17,"label",12),n(18,"Search By"),i(),d(19,"br"),e(20,"div",13)(21,"div",14)(22,"select",15),p("ngModelChange",function(_){return l.searchParameter=_})("change",function(){return l.searchParameterListener()}),e(23,"option",16),n(24,"Estate & block"),i(),e(25,"option",17),n(26,"Occupant Name"),i(),e(27,"option",18),n(28,"Mobile No."),i(),e(29,"option",19),n(30,"Property Name"),i(),e(31,"option",20),n(32,"Property No."),i()()()()()(),g(33,_e,1,1,"div",21)(34,Se,20,6)(35,Ne,8,3,"div",22),e(36,"div",23)(37,"div",11)(38,"label",24),n(39,"Bill Year"),i(),d(40,"br"),e(41,"div",13)(42,"ng-select",25),p("ngModelChange",function(_){return l.chargeYear=_}),g(43,xe,2,2,"ng-option",26),i()()()(),e(44,"div",27)(45,"button",28),p("click",function(){return l.searchBillPayments()}),n(46," Generate "),i()()(),e(47,"div",29)(48,"div",10)(49,"div",13)(50,"div",30),d(51,"em",31),i(),e(52,"input",32),p("ngModelChange",function(_){return l.searchedKeyword=_}),i()()(),g(53,ye,5,0,"div",21),i(),e(54,"p-table",33,34),h(56,"filter"),g(57,Me,19,0,"ng-template",35)(58,Te,27,22,"ng-template",36),i(),e(59,"div",37),d(60,"div",38),e(61,"div",38)(62,"div",39)(63,"div",40),n(64," Currency:"),e(65,"span",41),n(66," GHS"),i()(),e(67,"div",40),n(68," Total Current Charge: "),e(69,"span",42),n(70),h(71,"number"),i()(),e(72,"div",40),n(73," Total Arrears: "),e(74,"span",42),n(75),h(76,"number"),i()(),e(77,"div",40),n(78," Total Amount Due: "),e(79,"span",42),n(80),h(81,"number"),i()()()()()),c&2&&(m("pageTitleName","Demand notice")("description","Raise demand notice of ground and house rents for block properties or a single property"),a(5),m("ngModel",l.billType),a(6),m("ngModel",l.billType),a(11),m("ngModel",l.searchParameter),a(11),y(33,l.searchParameter!=="BAB"?33:34),a(2),y(35,l.billType==="HOUSE_RENT"?35:-1),a(7),m("clearable",!1)("ngModel",l.chargeYear),a(1),m("ngForOf",l.listOfChargeYears),a(9),m("ngModel",l.searchedKeyword),a(1),y(53,(l.demandNotices==null?null:l.demandNotices.length)>0?53:-1),a(1),m("value",S(56,22,l.demandNotices,l.searchedKeyword))("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",O(34,Pe))("resizableColumns",!0)("autoLayout",!0),a(16),f(" ",S(71,25,l.totalCurrentCharge,"1.2-2"),""),a(5),f(" ",S(76,28,l.totalArrears,"1.2-2"),""),a(5),f(" ",S(81,31,l.totalAmountDue,"1.2-2"),""))},dependencies:[L,k,I,V,R,se,le,ae,ee,K,z,J,q,j,$,G,H,Z,W,ne,ie,te,oe,X,me],encapsulation:2});let o=s;return o})();export{lt as DemandNoticeComponent};
