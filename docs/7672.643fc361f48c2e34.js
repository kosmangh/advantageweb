"use strict";(self.webpackChunkadvantageweb=self.webpackChunkadvantageweb||[]).push([[7672],{4874:(w,_,i)=>{i.d(_,{i:()=>g});var C=i(5879);let g=(()=>{var l;class f{transform(d){return d.trim().split("_").map(v=>v.trim()).join(" ")}}return(l=f).\u0275fac=function(d){return new(d||l)},l.\u0275pipe=C.Yjl({name:"removeHyphen",type:l,pure:!0,standalone:!0}),f})()},1085:(w,_,i)=>{i.d(_,{e:()=>g});var C=i(5879);let g=(()=>{var l;class f{constructor(d,m){this.changeDetectorRef=d,this.ngZone=m,this.timer=null}transform(d){this.removeTimer();let m=new Date(d),h=Math.round(Math.abs(((new Date).getTime()-m.getTime())/1e3)),P=Number.isNaN(h)?1e3:1e3*this.getSecondsUntilUpdate(h);this.timer=this.ngZone.runOutsideAngular(()=>typeof window<"u"?window.setTimeout(()=>{this.ngZone.run(()=>this.changeDetectorRef.markForCheck())},P):null);let Z=Math.round(Math.abs(h/60)),T=Math.round(Math.abs(Z/60)),u=Math.round(Math.abs(T/24)),e=Math.round(Math.abs(u/30.416)),A=Math.round(Math.abs(u/365));return Number.isNaN(h)?"":h<=45?"a few seconds ago":h<=90?"a minute ago":Z<=45?Z+" minutes ago":Z<=90?"an hour ago":T<=22?T+" hours ago":T<=36?"a day ago":u<=25?u+" days ago":u<=45?"a month ago":u<=345?e+" months ago":u<=545?"a year ago":A+" years ago"}ngOnDestroy(){this.removeTimer()}removeTimer(){this.timer&&(window.clearTimeout(this.timer),this.timer=null)}getSecondsUntilUpdate(d){return d<60?2:d<3600?30:d<86400?300:3600}}return(l=f).\u0275fac=function(d){return new(d||l)(C.Y36(C.sBO,16),C.Y36(C.R0b,16))},l.\u0275pipe=C.Yjl({name:"timeAgo",type:l,pure:!1,standalone:!0}),f})()},7672:(w,_,i)=>{i.r(_),i.d(_,{PropertyChargeListComponent:()=>ce});var C=i(5861),g=i(6814),l=i(95),f=i(2458),c=i(995),d=i(5176),m=i(8624),v=i(3519),h=i.n(v),P=i(2735),Z=i(1693),T=i(3221),u=i(4740),e=i(5879),A=i(5178),y=i(553),D=i(5109);class x{}var N=i(7467),B=i(9862),S=i(7236);let J=(()=>{var o;class n{constructor(t,r,a){this.utilsService=t,this.http=r,this.logger=a}getPropertyCharges(t,r,a){const p=new x;return p.regionId=r,p.chargeYear=a,p.headerRequest=this.utilsService.getRequestHeader(t.zoneId,t.regionId,"PROPERTY_CHARGE_LIST"),this.logger.info("getPropertyCharges list request "+JSON.stringify(p)),this.http.post(`${y.N.url+c.h.API_ESTATE_BILLING}propertycharges`,p).pipe((0,A.V)(y.N.timeout))}createPropertyCharge(t,r){return r.createdBy=t.username,r.headerRequest=this.utilsService.getRequestHeader(t.zoneId,t.regionId,"CREATE_PROPERTY_CHARGE"),this.logger.info("createPropertyCharge request "+JSON.stringify(r)),this.http.post(`${y.N.url+c.h.API_ESTATE_BILLING}createpropertycharge`,r).pipe((0,A.V)(y.N.timeout))}updatePropertyCharge(t,r){return r.headerRequest=this.utilsService.getRequestHeader(t.zoneId,t.regionId,"UPDATE_PROPERTY_CHARGE"),r.lastModifiedBy=t.username,this.logger.info("update zone request "+JSON.stringify(r)),this.http.post(`${y.N.url+c.h.API_ESTATE_BILLING}updatepropertycharge`,r).pipe((0,A.V)(y.N.timeout))}deletePropertyCharge(t,r){const a=new D.V;return a.recordId=r,a.deletedBy=t.username,a.headerRequest=this.utilsService.getRequestHeader(t.zoneId,t.regionId,"DELETE_PROPERTY_CHARGE"),this.logger.info("deletePropertyCharge request "+JSON.stringify(a)),this.http.post(`${y.N.url+c.h.API_ESTATE_BILLING}deletepropertycharge`,a).pipe((0,A.V)(y.N.timeout))}}return(o=n).\u0275fac=function(t){return new(t||o)(e.LFG(N.F),e.LFG(B.eN),e.LFG(S.Kf))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),n})();var O=i(1449),E=i(6593),b=i(6842),F=i(7177),L=i(4981);function G(o,n){if(1&o&&(e.TgZ(0,"div",27),e._UZ(1,"br"),e._uU(2),e._UZ(3,"br"),e._uU(4),e._UZ(5,"br"),e._uU(6),e._UZ(7,"br"),e._uU(8),e.ALo(9,"json"),e.qZA()),2&o){const s=e.oxw();e.xp6(2),e.hij("Dirty: ",s.propertyChargeFormGroup.dirty," "),e.xp6(2),e.hij("Touched: ",s.propertyChargeFormGroup.touched," "),e.xp6(2),e.hij("Valid: ",s.propertyChargeFormGroup.valid," "),e.xp6(2),e.hij("Value: ",e.lcZ(9,4,s.propertyChargeFormGroup.value)," ")}}function Q(o,n){if(1&o&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&o){const s=n.$implicit;e.Q6J("value",s.recordId),e.xp6(1),e.hij(" ",s.regionName," ")}}function k(o,n){1&o&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function j(o,n){if(1&o&&(e.TgZ(0,"ng-option",28),e._uU(1),e.qZA()),2&o){const s=n.$implicit;e.Q6J("value",s),e.xp6(1),e.hij(" ",s," ")}}function $(o,n){1&o&&(e.TgZ(0,"span"),e._UZ(1,"app-required-field"),e.qZA())}function H(o,n){if(1&o&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&o){const s=n.$implicit;e.Q6J("value",s.dataValue),e.xp6(1),e.hij(" ",s.dataLabel," ")}}function K(o,n){1&o&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function V(o,n){1&o&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function z(o,n){1&o&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function X(o,n){1&o&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function W(o,n){1&o&&(e.ynx(0),e.TgZ(1,"div",29),e._UZ(2,"input",30),e.TgZ(3,"label",31),e._uU(4," Save & create new "),e.qZA()(),e.BQk())}function ee(o,n){if(1&o){const s=e.EpF();e.TgZ(0,"div",24)(1,"button",32),e.NdJ("click",function(){e.CHM(s);const r=e.oxw();return e.KtG(r.updatePropertyCharge())}),e._uU(2," Update "),e.qZA()()}if(2&o){const s=e.oxw();e.xp6(1),e.Q6J("title",s.propertyChargeFormGroup.invalid?"There must be errors on the form":"")}}function re(o,n){if(1&o){const s=e.EpF();e.TgZ(0,"div",24)(1,"button",32),e.NdJ("click",function(){e.CHM(s);const r=e.oxw();return e.KtG(r.savePropertyCharge())}),e._uU(2," Save "),e.qZA()()}if(2&o){const s=e.oxw();e.xp6(1),e.Q6J("title",s.propertyChargeFormGroup.invalid?"There must be errors on the form":"")}}const U=function(o){return{"is-invalid":o}};let te=(()=>{var o;class n{constructor(t,r,a,p,M,q,I,R,Y){this.propertyChargeService=t,this.utilsService=r,this.settingsService=a,this.title=p,this.addPropertyChargeBsModalRef=M,this.fb=q,this.accountService=I,this.alertService=R,this.logger=Y,this.submitted=!1,this.accountService.currentUser.subscribe(Ce=>this.currentUser=Ce)}ngOnInit(){this.createNewForm(),this.isAddMode?(this.propertyChargeHeaderMsg="New property charge",this.title.setTitle(this.propertyChargeHeaderMsg),this.propertyChargeFormGroup.patchValue({chargeYear:(new Date).getFullYear()})):(this.propertyChargeHeaderMsg="Edit property charge",this.title.setTitle(this.propertyChargeHeaderMsg),this.propertyChargeFormGroup.patchValue(this.propertyCharge)),this.addPropertyChargeBsModalRef.setClass("gray modal-md modal-dialog-top"),this.listOfChargeYears=this.utilsService.getChargeYears(),this.listOfUsages=this.settingsService.getPropertyUsage(),this.fetchRegions()}createNewForm(){this.propertyChargeFormGroup=this.fb.group({regionId:["",[l.kI.required]],chargeYear:["",[l.kI.required]],propertyUsage:["",[l.kI.required]],firstClassCharge:["",{updateOn:"blur",validators:[l.kI.required]}],secondClassCharge:["",{updateOn:"blur",validators:[l.kI.required]}],thirdClassCharge:["",{updateOn:"blur",validators:[l.kI.required]}],recordId:[""],saveAndNew:[!1]})}get propertyChargeForm(){return this.propertyChargeFormGroup.controls}fetchRegions(){this.listOfRegions=[],this.settingsService.getRegions().subscribe({next:t=>{if(this.logger.info("getRegions response "+JSON.stringify(t)),"000"===t.headerResponse.responseCode)return t.regions.length<=0?(this.alertService.showInfoMsgGeneral("No regions found"),void this.logger.info("No regions found")):void(this.listOfRegions=t.regions);this.alertService.error(t.headerResponse.responseMessage)},error:t=>{this.logger.error(t),this.alertService.showInfoMsg(t)}})}savePropertyCharge(){if(this.submitted=!0,this.propertyChargeFormGroup.invalid)return;let t=this.propertyChargeForm.propertyUsage.value;h().fire({title:"Confirmation",text:`Do you want to save property charge  ${t}?`,icon:"question",position:"top",showCancelButton:!0,confirmButtonText:"Yes, create",cancelButtonText:"No, cancel"}).then(r=>{r.value?(this.alertService.clear(),this.propertyChargeService.createPropertyCharge(this.currentUser,this.propertyChargeFormGroup.value).subscribe({next:a=>{"000"===a.headerResponse.responseCode?(this.alertService.showSuccessMsg(a.headerResponse.responseMessage),this.propertyChargeForm.saveAndNew.value||(this.addPropertyChargeBsModalRef.hide(),this.accountService.reloadCurrentRoute()),this.propertyChargeFormGroup.reset(),this.submitted=!1,this.logAction(`created PropertyCharge ${t}`,c.h.SETTINGS)):this.alertService.showErrorMsg(a.headerResponse.responseMessage)},error:a=>{this.alertService.showInfoMsg(a)}})):h()})}updatePropertyCharge(){if(this.submitted=!0,this.propertyChargeFormGroup.invalid)return;let t=this.propertyChargeForm.propertyUsage.value;h().fire({position:"top",title:"Confirmation",text:`Do you want to update PropertyCharge ${t}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, update"}).then(r=>{r.value?(this.alertService.clear(),this.propertyChargeService.updatePropertyCharge(this.currentUser,this.propertyChargeFormGroup.value).subscribe({next:a=>{this.logger.info("updateUserAccount response:"+JSON.stringify(a)),"000"===a.headerResponse.responseCode?(this.alertService.showSuccessMsg(a.headerResponse.responseMessage),this.addPropertyChargeBsModalRef.hide(),this.logAction(`Updated ${t}`,c.h.SETTINGS),this.accountService.reloadCurrentRoute()):this.alertService.showErrorMsg(a.headerResponse.responseMessage)},error:a=>{this.alertService.showInfoMsg(a.message)}})):h()})}deletePropertyCharge(){let t=this.propertyChargeForm.PropertyChargeName.value;h().fire({position:"top",title:"Deletion",text:`Do you want to delete PropertyCharge ${t}?`,icon:"error",showCancelButton:!0,confirmButtonText:"Yes, delete",cancelButtonText:"No, cancel"}).then(r=>{if(r.value){if(this.alertService.clear(),this.propertyChargeFormGroup.invalid)return;this.propertyChargeService.deletePropertyCharge(this.currentUser,this.propertyChargeForm.recordId.value).subscribe({next:a=>{this.logger.info("delete PropertyCharge response:"+JSON.stringify(a)),"000"===a.headerResponse.responseCode?(this.alertService.showSuccessMsg(a.headerResponse.responseMessage),this.addPropertyChargeBsModalRef.hide(),this.logAction(`delete PropertyCharge  ${t}`,c.h.SETTINGS),this.accountService.reloadCurrentRoute()):this.alertService.showErrorMsg(a.headerResponse.responseMessage)},error:a=>{this.alertService.showInfoMsg(a)}})}else h()})}logAction(t,r){var a=this;return(0,C.Z)(function*(){yield a.accountService.logUserAudit(t,r)})()}}return(o=n).\u0275fac=function(t){return new(t||o)(e.Y36(J),e.Y36(N.F),e.Y36(O.g),e.Y36(E.Dx),e.Y36(b.UZ),e.Y36(l.qu),e.Y36(F.e),e.Y36(L.c),e.Y36(S.Kf))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-property-charge"]],standalone:!0,features:[e.jDz],decls:73,vars:48,consts:[["novalidate","",3,"formGroup"],[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["class","p-10",4,"ngIf"],[1,"row","gy-3","mt-3"],[1,"col-sm-6"],[1,"form-group"],[3,"labelForName","labelName"],[1,"form-control-wrap"],[1,"form-control-select"],["id","regionId","formControlName","regionId",1,"form-control",3,"ngClass"],["value","","selected","",1,"fs-6"],[3,"value",4,"ngFor","ngForOf"],[1,"invalid-feedback"],[4,"ngIf"],["id","chargeYear","formControlName","chargeYear",3,"clearable","ngClass"],["id","regionId","formControlName","propertyUsage",1,"form-control",3,"ngClass"],["type","number","formControlName","firstClassCharge","id","firstClassCharge","autocomplete","off",1,"form-control",3,"ngClass"],["type","number","formControlName","secondClassCharge","id","secondClassCharge","autocomplete","off",1,"form-control",2,"min-height","40px",3,"ngClass"],["type","number","formControlName","thirdClassCharge","id","thirdClassCharge","autocomplete","off",1,"form-control",2,"min-height","40px",3,"ngClass"],[1,"row","my-3","mx-2","mb-3","justify-content-end"],[1,"col-auto"],["data-bs-dismiss","modal",1,"btn","btn-outline-light","btn-sm",3,"click"],["class","col-auto",4,"ngIf"],[1,"p-10"],[3,"value"],[1,"custom-control","custom-control-sm","custom-checkbox","checked"],["type","checkbox","formControlName","saveAndNew","id","saveAndNew","id","saveAndNew",1,"custom-control-input"],["for","saveAndNew",1,"custom-control-label","fw-bolder"],[1,"btn","btn-primary","btn-sm",3,"title","click"]],template:function(t,r){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"h6",2),e._uU(3),e.ALo(4,"titlecase"),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return null==r.addPropertyChargeBsModalRef?null:r.addPropertyChargeBsModalRef.hide()}),e.TgZ(6,"span",4),e._uU(7,"\xd7"),e.qZA()()(),e.TgZ(8,"div",5),e.YNc(9,G,10,6,"div",6),e._UZ(10,"app-required-fields-notice"),e.TgZ(11,"div",7)(12,"div",8)(13,"div",9),e._UZ(14,"app-form-label",10),e.TgZ(15,"div",11)(16,"div",12)(17,"select",13)(18,"option",14),e._uU(19,"Select One"),e.qZA(),e.YNc(20,Q,2,2,"option",15),e.qZA(),e.TgZ(21,"span",16),e.YNc(22,k,2,0,"div",17),e.qZA()()()()(),e.TgZ(23,"div",8)(24,"div",9),e._UZ(25,"app-form-label",10),e.TgZ(26,"div",11)(27,"ng-select",18)(28,"ng-option",14),e._uU(29,"Select One"),e.qZA(),e.YNc(30,j,2,2,"ng-option",15),e.qZA(),e.TgZ(31,"span",16),e.YNc(32,$,2,0,"span",17),e.qZA()()()(),e.TgZ(33,"div",8)(34,"div",9),e._UZ(35,"app-form-label",10),e.TgZ(36,"div",11)(37,"div",12)(38,"select",19)(39,"option",14),e._uU(40,"Select One"),e.qZA(),e.YNc(41,H,2,2,"option",15),e.qZA(),e.TgZ(42,"span",16),e.YNc(43,K,2,0,"div",17),e.qZA()()()()(),e.TgZ(44,"div",8)(45,"div",9),e._UZ(46,"app-form-label",10),e.TgZ(47,"div",11),e._UZ(48,"input",20),e.TgZ(49,"span",16),e.YNc(50,V,2,0,"div",17),e.qZA()()()(),e.TgZ(51,"div",8)(52,"div",9),e._UZ(53,"app-form-label",10),e.TgZ(54,"div",11),e._UZ(55,"input",21),e.TgZ(56,"span",16),e.YNc(57,z,2,0,"div",17),e.qZA()()()(),e.TgZ(58,"div",8)(59,"div",9),e._UZ(60,"app-form-label",10),e.TgZ(61,"div",11),e._UZ(62,"input",22),e.TgZ(63,"span",16),e.YNc(64,X,2,0,"div",17),e.qZA()()()(),e.TgZ(65,"div",8),e.YNc(66,W,5,0,"ng-container",17),e.qZA()()(),e.TgZ(67,"div",23)(68,"div",24)(69,"button",25),e.NdJ("click",function(){return null==r.addPropertyChargeBsModalRef?null:r.addPropertyChargeBsModalRef.hide()}),e._uU(70," Close "),e.qZA()(),e.YNc(71,ee,3,1,"div",26),e.YNc(72,re,3,1,"div",26),e.qZA()()),2&t&&(e.Q6J("formGroup",r.propertyChargeFormGroup),e.xp6(3),e.Oqu(e.lcZ(4,34,r.propertyChargeHeaderMsg)),e.xp6(6),e.Q6J("ngIf",!1),e.xp6(5),e.Q6J("labelForName","regionId")("labelName","Region"),e.xp6(3),e.Q6J("ngClass",e.VKq(36,U,((null==r.propertyChargeForm.regionId?null:r.propertyChargeForm.regionId.touched)||(null==r.propertyChargeForm.regionId?null:r.propertyChargeForm.regionId.dirty)||r.submitted)&&(null==r.propertyChargeForm.regionId?null:r.propertyChargeForm.regionId.errors))),e.xp6(3),e.Q6J("ngForOf",r.listOfRegions),e.xp6(2),e.Q6J("ngIf",null==r.propertyChargeForm.regionId||null==r.propertyChargeForm.regionId.errors?null:r.propertyChargeForm.regionId.errors.required),e.xp6(3),e.Q6J("labelForName","chargeYear")("labelName","Charge Year"),e.xp6(2),e.Q6J("clearable",!1)("ngClass",e.VKq(38,U,((null==r.propertyChargeForm.chargeYear?null:r.propertyChargeForm.chargeYear.touched)||(null==r.propertyChargeForm.chargeYear?null:r.propertyChargeForm.chargeYear.dirty)||r.submitted)&&(null==r.propertyChargeForm.chargeYear?null:r.propertyChargeForm.chargeYear.errors))),e.xp6(3),e.Q6J("ngForOf",r.listOfChargeYears),e.xp6(2),e.Q6J("ngIf",null==r.propertyChargeForm.chargeYear||null==r.propertyChargeForm.chargeYear.errors?null:r.propertyChargeForm.chargeYear.errors.required),e.xp6(3),e.Q6J("labelForName","propertyUsage")("labelName","Property Usage"),e.xp6(3),e.Q6J("ngClass",e.VKq(40,U,((null==r.propertyChargeForm.propertyUsage?null:r.propertyChargeForm.propertyUsage.touched)||(null==r.propertyChargeForm.propertyUsage?null:r.propertyChargeForm.propertyUsage.dirty)||r.submitted)&&(null==r.propertyChargeForm.propertyUsage?null:r.propertyChargeForm.propertyUsage.errors))),e.xp6(3),e.Q6J("ngForOf",r.listOfUsages),e.xp6(2),e.Q6J("ngIf",null==r.propertyChargeForm.propertyUsage||null==r.propertyChargeForm.propertyUsage.errors?null:r.propertyChargeForm.propertyUsage.errors.required),e.xp6(3),e.Q6J("labelForName","firstClassCharge")("labelName","First Class Charge"),e.xp6(2),e.Q6J("ngClass",e.VKq(42,U,((null==r.propertyChargeForm.firstClassCharge?null:r.propertyChargeForm.firstClassCharge.touched)||(null==r.propertyChargeForm.firstClassCharge?null:r.propertyChargeForm.firstClassCharge.dirty)||r.submitted)&&(null==r.propertyChargeForm.firstClassCharge?null:r.propertyChargeForm.firstClassCharge.errors))),e.xp6(2),e.Q6J("ngIf",null==r.propertyChargeForm.firstClassCharge||null==r.propertyChargeForm.firstClassCharge.errors?null:r.propertyChargeForm.firstClassCharge.errors.required),e.xp6(3),e.Q6J("labelForName","secondClassCharge")("labelName","Second Class Charge"),e.xp6(2),e.Q6J("ngClass",e.VKq(44,U,((null==r.propertyChargeForm.secondClassCharge?null:r.propertyChargeForm.secondClassCharge.touched)||(null==r.propertyChargeForm.secondClassCharge?null:r.propertyChargeForm.secondClassCharge.dirty)||r.submitted)&&(null==r.propertyChargeForm.secondClassCharge?null:r.propertyChargeForm.secondClassCharge.errors))),e.xp6(2),e.Q6J("ngIf",null==r.propertyChargeForm.secondClassCharge||null==r.propertyChargeForm.secondClassCharge.errors?null:r.propertyChargeForm.secondClassCharge.errors.required),e.xp6(3),e.Q6J("labelForName","thirdClassCharge")("labelName","Third Class Charge"),e.xp6(2),e.Q6J("ngClass",e.VKq(46,U,((null==r.propertyChargeForm.thirdClassCharge?null:r.propertyChargeForm.thirdClassCharge.touched)||(null==r.propertyChargeForm.thirdClassCharge?null:r.propertyChargeForm.thirdClassCharge.dirty)||r.submitted)&&(null==r.propertyChargeForm.thirdClassCharge?null:r.propertyChargeForm.thirdClassCharge.errors))),e.xp6(2),e.Q6J("ngIf",null==r.propertyChargeForm.thirdClassCharge||null==r.propertyChargeForm.thirdClassCharge.errors?null:r.propertyChargeForm.thirdClassCharge.errors.required),e.xp6(2),e.Q6J("ngIf",r.isAddMode),e.xp6(5),e.Q6J("ngIf",!r.isAddMode),e.xp6(1),e.Q6J("ngIf",r.isAddMode))},dependencies:[g.ez,g.mk,g.sg,g.O5,g.Ts,g.rS,l.u5,l._Y,l.YN,l.Kr,l.Fj,l.wV,l.Wl,l.EJ,l.JJ,l.JL,l.UX,l.sg,l.u,T.z,P.h,Z.M,u.A0,u.w9,u.jq],encapsulation:2}),n})();var oe=i(1085);let ae=(()=>{var o;class n{constructor(t,r){this.addPropertyChargeDetailsBsModalRef=t,this.accountService=r,this.accountService.currentUser.subscribe(a=>this.currentUser=a)}ngOnInit(){this.addPropertyChargeDetailsBsModalRef.setClass("gray modal-md modal-dialog-top")}}return(o=n).\u0275fac=function(t){return new(t||o)(e.Y36(b.UZ),e.Y36(F.e))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-property-charge-details"]],standalone:!0,features:[e.jDz],decls:91,vars:33,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[1,"card","card-no-border"],[1,"pricing-body"],[1,"pricing-features"],[1,"preview-title-lg","overline-title"],[1,"w-50","text-soft"],[1,"ms-auto","text-solid"],[1,"preview-title-lg","overline-title","mt-2"],[1,"ms-auto","text-solid","text-primary"],[1,"row","my-3","mx-2","mb-3","justify-content-end"],[1,"col-auto"],[1,"btn","btn-sm","btn-primary",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"h6",1),e._uU(2,"Property Charge Details"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return null==r.addPropertyChargeDetailsBsModalRef?null:r.addPropertyChargeDetailsBsModalRef.hide()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"ul",7)(10,"span",8),e._uU(11,"Charge Information"),e.qZA(),e.TgZ(12,"li")(13,"span",9),e._uU(14,"Region"),e.qZA(),e._uU(15," - "),e.TgZ(16,"span",10),e._uU(17),e.qZA()(),e.TgZ(18,"li")(19,"span",9),e._uU(20,"Charge Year"),e.qZA(),e._uU(21," - "),e.TgZ(22,"span",10),e._uU(23),e.qZA()(),e.TgZ(24,"li")(25,"span",9),e._uU(26,"Property Usage"),e.qZA(),e._uU(27," - "),e.TgZ(28,"span",10),e._uU(29),e.ALo(30,"titlecase"),e.qZA()(),e.TgZ(31,"li")(32,"span",9),e._uU(33,"First Class Charge"),e.qZA(),e._uU(34," - "),e.TgZ(35,"span",10),e._uU(36),e.ALo(37,"number"),e.qZA()(),e.TgZ(38,"li")(39,"span",9),e._uU(40,"Second Class Charge"),e.qZA(),e._uU(41," - "),e.TgZ(42,"span",10),e._uU(43),e.ALo(44,"number"),e.qZA()(),e.TgZ(45,"li")(46,"span",9),e._uU(47,"Third Class Charge"),e.qZA(),e._uU(48," - "),e.TgZ(49,"span",10),e._uU(50),e.ALo(51,"number"),e.qZA()(),e.TgZ(52,"span",11),e._uU(53,"User Activities"),e.qZA(),e.TgZ(54,"li")(55,"span",9),e._uU(56,"Created By"),e.qZA(),e._uU(57," - "),e.TgZ(58,"span",10),e._uU(59),e.qZA()(),e.TgZ(60,"li")(61,"span",9),e._uU(62,"Created Date"),e.qZA(),e._uU(63," - "),e.TgZ(64,"span",10),e._uU(65),e.ALo(66,"date"),e.qZA(),e.TgZ(67,"span",12),e._uU(68),e.ALo(69,"timeAgo"),e.qZA()(),e.TgZ(70,"li")(71,"span",9),e._uU(72,"Last Modified By"),e.qZA(),e._uU(73," - "),e.TgZ(74,"span",10),e._uU(75),e.qZA()(),e.TgZ(76,"li")(77,"span",9),e._uU(78,"Last Modified Date"),e.qZA(),e._uU(79," - "),e.TgZ(80,"span",10),e._uU(81),e.ALo(82,"date"),e.qZA(),e.TgZ(83,"span",12),e._uU(84),e.ALo(85,"timeAgo"),e.qZA()()()()()(),e.TgZ(86,"div",13)(87,"div",14)(88,"a",15),e.NdJ("click",function(){return null==r.addPropertyChargeDetailsBsModalRef?null:r.addPropertyChargeDetailsBsModalRef.hide()}),e.TgZ(89,"span"),e._uU(90,"Close"),e.qZA()()()()),2&t&&(e.xp6(17),e.Oqu(r.propertyCharge.regionName),e.xp6(6),e.Oqu(r.propertyCharge.chargeYear),e.xp6(6),e.Oqu(e.lcZ(30,12,r.propertyCharge.propertyUsage)),e.xp6(7),e.Oqu(e.xi3(37,14,r.propertyCharge.firstClassCharge,".2-2")),e.xp6(7),e.Oqu(e.xi3(44,17,r.propertyCharge.secondClassCharge,".2-2")),e.xp6(7),e.Oqu(e.xi3(51,20,r.propertyCharge.thirdClassCharge,".2-2")),e.xp6(9),e.Oqu(r.propertyCharge.createdBy),e.xp6(6),e.hij(" ",e.xi3(66,23,r.propertyCharge.createdDate,"medium")," "),e.xp6(3),e.hij(" : ",e.lcZ(69,26,r.propertyCharge.createdDate.toString())," "),e.xp6(7),e.Oqu(r.propertyCharge.createdBy),e.xp6(6),e.hij(" ",e.xi3(82,28,r.propertyCharge.lastModifiedDate,"medium")," "),e.xp6(3),e.hij(" : ",e.lcZ(85,31,r.propertyCharge.lastModifiedDate.toString())," "))},dependencies:[g.ez,g.JJ,g.rS,g.uU,oe.e],encapsulation:2}),n})();var se=i(4874),ne=i(9972);function ie(o,n){if(1&o&&(e.TgZ(0,"ng-option",20),e._uU(1),e.qZA()),2&o){const s=n.$implicit;e.Q6J("value",s.recordId),e.xp6(1),e.hij(" ",s.regionName," ")}}function le(o,n){if(1&o&&(e.TgZ(0,"ng-option",20),e._uU(1),e.qZA()),2&o){const s=n.$implicit;e.Q6J("value",s),e.xp6(1),e.hij(" ",s," ")}}function pe(o,n){if(1&o){const s=e.EpF();e.TgZ(0,"div",5)(1,"div",21)(2,"div",22),e._UZ(3,"em",23),e.qZA(),e.TgZ(4,"input",24),e.NdJ("ngModelChange",function(r){e.CHM(s);const a=e.oxw();return e.KtG(a.searchedKeyword=r)}),e.qZA()()()}if(2&o){const s=e.oxw();e.xp6(4),e.Q6J("ngModel",s.searchedKeyword)}}function ge(o,n){1&o&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"SN"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Region"),e.qZA(),e.TgZ(5,"th",25),e._uU(6,"Charge Year"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Property Usage"),e.qZA(),e.TgZ(9,"th",25),e._uU(10,"First Class Charge"),e.qZA(),e.TgZ(11,"th",25),e._uU(12,"Second Class Charge"),e.qZA(),e.TgZ(13,"th",25),e._uU(14,"Third Class Charge"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Actions"),e.qZA()())}function he(o,n){if(1&o){const s=e.EpF();e.TgZ(0,"td")(1,"div",38),e.NdJ("click",function(){e.CHM(s);const r=e.oxw().$implicit,a=e.oxw();return e.KtG(a.openPropertyChargeModalComponent(r,!1))}),e.TgZ(2,"div",39)(3,"span"),e._UZ(4,"em",33),e.qZA()()()()}}function de(o,n){if(1&o){const s=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",25),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"removeHyphen"),e.ALo(10,"titlecase"),e.qZA(),e.TgZ(11,"td",25),e._uU(12),e.ALo(13,"number"),e.qZA(),e.TgZ(14,"td",25),e._uU(15),e.ALo(16,"number"),e.qZA(),e.TgZ(17,"td",25),e._uU(18),e.ALo(19,"number"),e.qZA(),e.YNc(20,he,5,0,"td",26),e.TgZ(21,"td")(22,"div",27)(23,"a",28),e._UZ(24,"em",29),e.qZA(),e.TgZ(25,"div",30)(26,"ul",31)(27,"li")(28,"a",32),e.NdJ("click",function(){const a=e.CHM(s).$implicit,p=e.oxw();return e.KtG(p.openPropertyChargeModalComponent(a,!1))}),e._UZ(29,"em",33),e.TgZ(30,"span"),e._uU(31,"Edit charges"),e.qZA()()(),e.TgZ(32,"li")(33,"a",32),e.NdJ("click",function(){const a=e.CHM(s).$implicit,p=e.oxw();return e.KtG(p.openChargeDetailsModalComponent(a))}),e._UZ(34,"em",34),e.TgZ(35,"span"),e._uU(36,"View details"),e.qZA()()(),e._UZ(37,"div",35),e.TgZ(38,"li")(39,"a",36),e.NdJ("click",function(){const a=e.CHM(s).$implicit,p=e.oxw();return e.KtG(p.openDeleteChargeModalComponent(a))}),e._UZ(40,"em",37),e.TgZ(41,"span"),e._uU(42,"Delete"),e.qZA()()()()()()()()}if(2&o){const s=n.$implicit,t=n.rowIndex;e.xp6(2),e.Oqu(t+1),e.xp6(2),e.Oqu(s.regionName),e.xp6(2),e.Oqu(s.chargeYear),e.xp6(2),e.Oqu(e.lcZ(9,8,e.lcZ(10,10,s.propertyUsage))),e.xp6(4),e.Oqu(e.xi3(13,12,s.firstClassCharge,".2-2")),e.xp6(3),e.Oqu(e.xi3(16,15,s.secondClassCharge,".2-2")),e.xp6(3),e.Oqu(e.xi3(19,18,s.thirdClassCharge,".2-2")),e.xp6(2),e.Q6J("ngIf",!1)}}const ue=function(){return[5,10,25,50]};let ce=(()=>{var o;class n{constructor(t,r,a,p,M,q,I,R){this.utilsService=t,this.accountService=r,this.alertService=a,this.settingService=p,this.logger=M,this.propertyChargeService=q,this.propertyChargeModalService=I,this.propertyChargeDetailsModalService=R,this.accountService.currentUser.subscribe(Y=>this.currentUser=Y)}ngOnInit(){this.logAction("Viewed property charges page",c.h.ESTATE_BILLING),this.regionId=this.currentUser.regionId,this.chargeYear=(new Date).getFullYear(),this.listOfChargeYears=this.utilsService.getChargeYears(),this.fetchRegions(),this.refreshButton()}ngOnDestroy(){this.propertyChargeModalService.hide(),h().close()}fetchRegions(){this.listOfRegions=[],this.settingService.getRegions().subscribe({next:t=>{if(this.logger.info("getRegions response "+JSON.stringify(t)),"000"===t.headerResponse.responseCode)return t.regions.length<=0?(this.alertService.showInfoMsgGeneral("No regions found"),void this.logger.info("No regions found")):void(this.listOfRegions=t.regions);this.alertService.error(t.headerResponse.responseMessage)},error:t=>{this.logger.error(t),this.alertService.showInfoMsg(t)}})}refreshButton(){this.fetchPropertyCharges()}fetchPropertyCharges(){this.listOfPropertyCharges=[],this.propertyChargeService.getPropertyCharges(this.currentUser,this.regionId,this.chargeYear).subscribe({next:t=>{if(this.logger.info("getPropertyCharges response "+JSON.stringify(t)),"000"===t.headerResponse.responseCode)return t.propertyCharges.length<=0?(this.alertService.showInfoMsgGeneral("No property charges found"),void this.logger.info("No property charges found")):void(this.listOfPropertyCharges=t.propertyCharges);this.alertService.error(t.headerResponse.responseMessage)},error:t=>{this.logger.error(t),this.alertService.showInfoMsg(t)}})}openPropertyChargeModalComponent(t,r){const a={initialState:{isAddMode:r,propertyCharge:t}};this.propertyChargeModalService.config.ignoreBackdropClick=!0,this.propertyChargeModalService.config.animated=!0,this.addPropertyChargeBsModalRef=this.propertyChargeModalService.show(te,a),this.addPropertyChargeBsModalRef.content.closeBtnName="Close"}openChargeDetailsModalComponent(t){const r={initialState:{propertyCharge:t}};this.propertyChargeDetailsModalService.config.ignoreBackdropClick=!0,this.propertyChargeDetailsModalService.config.animated=!0,this.addPropertyChargeDetailsBsModalRef=this.propertyChargeDetailsModalService.show(ae,r),this.addPropertyChargeDetailsBsModalRef.content.closeBtnName="Close"}openDeleteChargeModalComponent(t){let r=t.propertyUsage.toLowerCase();h().fire({position:"top",title:"Confirmation",text:`Do you want to delete charge of ${r} for ${t.chargeYear}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, delete"}).then(a=>{a.value?this.propertyChargeService.deletePropertyCharge(this.currentUser,t.recordId).subscribe({next:p=>{this.logger.info("delete Occupant response:"+JSON.stringify(p)),"000"===p.headerResponse.responseCode?(this.alertService.showSuccessMsg(p.headerResponse.responseMessage),this.propertyChargeModalService.hide(),this.logAction(`Deleted property charge  of ${r} for ${t.chargeYear}`,c.h.ESTATE_BILLING),this.accountService.reloadCurrentRoute()):this.alertService.showErrorMsg(p.headerResponse.responseMessage)},error:p=>{this.alertService.showInfoMsg(p.message)}}):h()})}logAction(t,r){var a=this;return(0,C.Z)(function*(){yield a.accountService.logUserAudit(t,r)})()}}return(o=n).\u0275fac=function(t){return new(t||o)(e.Y36(N.F),e.Y36(F.e),e.Y36(L.c),e.Y36(O.g),e.Y36(S.Kf),e.Y36(J),e.Y36(b.tT),e.Y36(b.tT))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],standalone:!0,features:[e.jDz],decls:30,vars:24,consts:[[3,"pageTitleName","description"],[1,"newItemName"],[1,"btn","btn-primary",3,"click"],[1,"icon","ni","ni-plus"],[1,"row","gy-2","gx-3","mb-4","align-items-center"],[1,"col-sm-2"],[1,"form-group"],[3,"labelForName","labelName"],[1,"form-control-wrap"],["id","regionId",3,"clearable","ngModel","ngModelChange"],["value","A","selected","",1,"fs-6"],[3,"value",4,"ngFor","ngForOf"],["id","chargeYear",3,"clearable","ngModel","ngModelChange"],["class","col-sm-2",4,"ngIf"],[1,"col-auto"],["type","button","title","",1,"btn","btn-dim","btn-primary","mt-4",3,"click"],["responsiveLayout","scroll","sortMode","multiple","responsiveLayout","scroll","styleClass","p-datatable-sm p-datatable-striped","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","scrollDirection","both",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","resizableColumns","autoLayout"],["dt1",""],["pTemplate","header"],["pTemplate","body"],[3,"value"],[1,"form-control-wrap","mt-4"],[1,"form-icon","form-icon-right"],[1,"icon","ni","ni-search"],["type","text","id","default-04","placeholder"," Search property here",1,"form-control",3,"ngModel","ngModelChange"],[1,"text-end"],[4,"ngIf"],[1,"drodown"],["data-bs-toggle","dropdown","aria-expanded","false",1,"dropdown-toggle","btn","btn-icon","btn-light"],[1,"icon","ni","ni-more-h"],[1,"dropdown-menu","dropdown-menu-end"],[1,"link-list-opt","no-bdr"],[3,"click"],[1,"icon","ni","ni-edit"],[1,"icon","ni","ni-eye"],[1,"divider"],[1,"text-danger",3,"click"],[1,"icon","ni","ni-delete"],[1,"align-center","select-cursor",3,"click"],[1,"user-avatar","user-avatar-sm","bg-light"]],template:function(t,r){1&t&&(e.TgZ(0,"app-add-item",0)(1,"span",1)(2,"a",2),e.NdJ("click",function(){return r.openPropertyChargeModalComponent(null,!0)}),e._UZ(3,"em",3),e.TgZ(4,"span"),e._uU(5,"Add property charge"),e.qZA()()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6),e._UZ(9,"app-form-label",7),e.TgZ(10,"div",8)(11,"ng-select",9),e.NdJ("ngModelChange",function(p){return r.regionId=p}),e.TgZ(12,"ng-option",10),e._uU(13,"Select Region"),e.qZA(),e.YNc(14,ie,2,2,"ng-option",11),e.qZA()()()(),e.TgZ(15,"div",5)(16,"div",6),e._UZ(17,"app-form-label",7),e.TgZ(18,"div",8)(19,"ng-select",12),e.NdJ("ngModelChange",function(p){return r.chargeYear=p}),e.YNc(20,le,2,2,"ng-option",11),e.qZA()()()(),e.YNc(21,pe,5,1,"div",13),e.TgZ(22,"div",14)(23,"button",15),e.NdJ("click",function(){return r.refreshButton()}),e._uU(24," Search "),e.qZA()()(),e.TgZ(25,"p-table",16,17),e.ALo(27,"filter"),e.YNc(28,ge,17,0,"ng-template",18),e.YNc(29,de,43,21,"ng-template",19),e.qZA()),2&t&&(e.Q6J("pageTitleName","Property Charge setup")("description","Setup ground rent & property billing"),e.xp6(9),e.Q6J("labelForName","regionId")("labelName","Region"),e.xp6(2),e.Q6J("clearable",!1)("ngModel",r.regionId),e.xp6(3),e.Q6J("ngForOf",r.listOfRegions),e.xp6(3),e.Q6J("labelForName","chargeYear")("labelName","Charge Year"),e.xp6(2),e.Q6J("clearable",!1)("ngModel",r.chargeYear),e.xp6(1),e.Q6J("ngForOf",r.listOfChargeYears),e.xp6(1),e.Q6J("ngIf",(null==r.listOfPropertyCharges?null:r.listOfPropertyCharges.length)>0),e.xp6(4),e.Q6J("value",e.xi3(27,20,r.listOfPropertyCharges,r.searchedKeyword))("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(23,ue))("resizableColumns",!0)("autoLayout",!0))},dependencies:[g.ez,g.sg,g.O5,g.JJ,g.rS,f.U$,f.iA,ne.jx,l.u5,l.Fj,l.JJ,l.On,u.A0,u.w9,u.jq,d.L,m.$,P.h,se.i],encapsulation:2}),n})()}}]);