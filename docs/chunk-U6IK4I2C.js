import{a as P}from"./chunk-3VQLASZ2.js";import{b as ue,c as fe,d as _e,e as Ce}from"./chunk-7PQCCLGB.js";import{a as ve}from"./chunk-T45HSKH6.js";import{d as be}from"./chunk-WH3N5QDN.js";import{i as ce,t as he}from"./chunk-KPCRGR73.js";import{h as ge,i as Se}from"./chunk-543WOPA4.js";import"./chunk-5WO4BOAD.js";import{a as de}from"./chunk-NEQ5BFSP.js";import{b as ee,c as B,e as R,f as G,g as te,k as ie,l as re,o as ne,p as oe,u as ae,v as V,w as me,x as se}from"./chunk-B2QESFZG.js";import{b as pe}from"./chunk-Y725X6Z7.js";import{b as le,c as L}from"./chunk-R55IMLXW.js";import"./chunk-LPKVFVKE.js";import{b as k,d as w,g as E}from"./chunk-IHPVOZWG.js";import{m as Z}from"./chunk-7DWKZ4XI.js";import{Ab as H,Eb as o,Fb as b,Gb as v,Ic as K,Lc as Y,Mb as A,Nb as J,Ob as U,Pc as z,Qc as X,Rc as Q,Sa as a,Sc as W,Ta as c,Uc as T,Wb as f,Xb as _,Yb as I,bb as d,ib as S,ja as y,la as F,nb as t,ob as i,pb as p,qa as N,qb as q,ra as D,rb as $,tb as x,wb as u,xb as h}from"./chunk-QRSQYA3Q.js";import{d as O,e as M}from"./chunk-5FZOKLP6.js";var De=O(le());var C=O(le());function Ee(n,s){if(n&1&&(t(0,"div",21),p(1,"br"),o(2),p(3,"br"),o(4),p(5,"br"),o(6),p(7,"br"),o(8),f(9,"json"),i()),n&2){let l=h();a(2),v("Dirty: ",l.departmentFormGroup.dirty," "),a(2),v("Touched: ",l.departmentFormGroup.touched," "),a(2),v("Valid: ",l.departmentFormGroup.valid," "),a(2),v("Value: ",_(9,4,l.departmentFormGroup.value)," ")}}function Be(n,s){n&1&&(t(0,"div"),p(1,"app-required-field"),i())}function Re(n,s){n&1&&(t(0,"div"),o(1," * department name must be longer than 3 characters. "),i())}function Ge(n,s){n&1&&(t(0,"div"),p(1,"app-required-field"),i())}function Ve(n,s){n&1&&(t(0,"div",9)(1,"label",22),o(2,"Payment Methods"),i(),t(3,"ul",23)(4,"li")(5,"div",24),p(6,"input",25),t(7,"label",26),o(8,"Card"),i()()(),t(9,"li")(10,"div",24),p(11,"input",27),t(12,"label",28),o(13,"Bitcoin"),i()()(),t(14,"li")(15,"div",24),p(16,"input",29),t(17,"label",30),o(18,"Cash"),i()()()()())}function Le(n,s){n&1&&(t(0,"div",9),p(1,"app-form-label",10)(2,"br"),t(3,"ul",31)(4,"li")(5,"div",32),p(6,"input",33),t(7,"label",34),o(8,"This is very nice"),i()()(),t(9,"li")(10,"div",35),p(11,"input",36),t(12,"label",37),o(13,"No"),i()()()()()),n&2&&(a(1),d("labelForName","remarks")("labelName","Choices"))}function Pe(n,s){n&1&&(q(0),t(1,"div",38),p(2,"input",39),t(3,"label",40),o(4," Save & create new department "),i()(),$())}function je(n,s){if(n&1){let l=x();t(0,"div",18)(1,"button",41),u("click",function(){N(l);let m=h();return D(m.deleteDepartment())}),o(2," Delete "),i()()}if(n&2){let l=h();a(1),d("title",l.departmentFormGroup.invalid?"There must be errors on the form":"")}}function Ue(n,s){if(n&1){let l=x();t(0,"div",18)(1,"button",42),u("click",function(){N(l);let m=h();return D(m.updateDepartment())}),o(2," Update "),i()()}if(n&2){let l=h();a(1),d("title",l.departmentFormGroup.invalid?"There must be errors on the form":"")}}function Oe(n,s){if(n&1){let l=x();t(0,"div",18)(1,"button",42),u("click",function(){N(l);let m=h();return D(m.saveDepartment())}),o(2," Create "),i()()}if(n&2){let l=h();a(1),d("title",l.departmentFormGroup.invalid?"There must be errors on the form":"")}}var ye=n=>({"is-invalid":n}),Ne=(()=>{let s=class s{constructor(r,m,e,g,j,xe,we){this.title=r,this.addDepartmentBsModalRef=m,this.fb=e,this.accountService=g,this.alertService=j,this.logger=xe,this.settingsService=we,this.submitted=!1,this.userAccountService=y(P),this.accountService.currentUser.subscribe(Me=>this.currentUser=Me)}ngOnInit(){this.createNewForm(),this.isAddMode?(this.departmentHeaderMsg="New department",this.title.setTitle(this.departmentHeaderMsg)):(this.departmentHeaderMsg="Edit "+this.department.departmentName,this.title.setTitle(this.departmentHeaderMsg),this.departmentFormGroup.patchValue(this.department)),this.addDepartmentBsModalRef.setClass("gray modal-sm modal-dialog-top")}createNewForm(){this.departmentFormGroup=this.fb.group({departmentName:["",{updateOn:"blur",validators:[R.required,R.minLength(3)]}],remarks:["",{updateOn:"blur",validators:[R.required]}],recordId:[""],saveAndNew:[!1]})}get departmentForm(){return this.departmentFormGroup.controls}saveDepartment(){if(this.submitted=!0,this.departmentFormGroup.invalid)return;let r=this.departmentForm.departmentName.value;C.default.fire({title:"Confirmation",text:`Do you want to create department  ${r}?`,icon:"question",position:"top",showCancelButton:!0,confirmButtonText:"Yes, create",cancelButtonText:"No, cancel"}).then(m=>{m.value?(this.alertService.clear(),this.userAccountService.createDepartment(this.currentUser,this.departmentFormGroup.value).subscribe({next:e=>{if(e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(`${r} created successfully`),this.departmentForm.saveAndNew.value||(this.addDepartmentBsModalRef.hide(),this.accountService.reloadCurrentRoute()),this.departmentFormGroup.reset(),this.submitted=!1,this.logAction(`created department ${r}`,w.SETTINGS)},error:e=>{this.alertService.showInfoMsg(e)}})):(m.dismiss,C.default.DismissReason.cancel)})}updateDepartment(){if(this.submitted=!0,this.departmentFormGroup.invalid)return;let r=this.departmentForm.departmentName.value;C.default.fire({position:"top",title:"Confirmation",text:`Do you want to update Department ${r}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, update"}).then(m=>{m.value?(this.alertService.clear(),this.userAccountService.updateDepartment(this.currentUser,this.departmentFormGroup.value).subscribe({next:e=>{if(this.logger.info("updateDepartment response:",e),e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(`${r} updated successfully`),this.addDepartmentBsModalRef.hide(),this.logAction(`Updated ${r}`,w.SETTINGS),this.accountService.reloadCurrentRoute()},error:e=>{this.alertService.showInfoMsg(e.message)}})):(m.dismiss,C.default.DismissReason.cancel)})}deleteDepartment(){let r=this.departmentForm.departmentName.value;C.default.fire({position:"top",title:"Deletion",text:`Do you want to delete Department ${r}?`,icon:"error",showCancelButton:!0,confirmButtonText:"Yes, delete",cancelButtonText:"No, cancel"}).then(m=>{if(m.value){if(this.alertService.clear(),this.departmentFormGroup.invalid)return;this.userAccountService.deleteDepartment(this.currentUser,this.departmentForm.recordId.value).subscribe({next:e=>{if(this.logger.info("delete department response:"+JSON.stringify(e)),e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(`${r} deleted successfully`),this.addDepartmentBsModalRef.hide(),this.logAction(`delete Department  ${r}`,w.SETTINGS),this.accountService.reloadCurrentRoute()},error:e=>{this.alertService.showInfoMsg(e)}})}else m.dismiss,C.default.DismissReason.cancel})}logAction(r,m){return M(this,null,function*(){yield this.accountService.logUserAudit(r,m)})}};s.\u0275fac=function(m){return new(m||s)(c(Z),c(ge),c(ae),c(E),c(L),c(k),c(be))},s.\u0275cmp=F({type:s,selectors:[["app-add-department"]],standalone:!0,features:[A],decls:37,vars:24,consts:[["novalidate","",3,"formGroup"],[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right","border","border-gray",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["class","p-10",4,"ngIf"],[1,"row","gy-2","mt-3"],[1,"col-sm-12"],[1,"form-group"],[3,"labelForName","labelName"],[1,"form-control-wrap"],["type","text","formControlName","departmentName","id","departmentName","autocomplete","off",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],[4,"ngIf"],["type","text","formControlName","remarks","id","remarks",1,"form-control",2,"min-height","40px",3,"ngClass"],["class","form-group",4,"ngIf"],[1,"row","my-3","mx-2","mb-3","justify-content-end"],[1,"col-auto"],["data-bs-dismiss","modal",1,"btn","btn-outline-light","btn-sm",3,"click"],["class","col-auto",4,"ngIf"],[1,"p-10"],[1,"form-label"],[1,"custom-control-group","g-3","align-center"],[1,"custom-control","custom-control-sm","custom-checkbox"],["type","checkbox","id","pay-card",1,"custom-control-input"],["for","pay-card",1,"custom-control-label"],["type","checkbox","id","pay-bitcoin",1,"custom-control-input"],["for","pay-bitcoin",1,"custom-control-label"],["type","checkbox","id","pay-cash",1,"custom-control-input"],["for","pay-cash",1,"custom-control-label"],[1,"custom-control-group"],[1,"custom-control","custom-radio","custom-control-pro","no-control","checked"],["type","radio","name","btnRadioNc","id","btnRadioNc1",1,"custom-control-input"],["for","btnRadioNc1",1,"custom-control-label"],[1,"custom-control","custom-radio","custom-control-pro","no-control"],["type","radio","name","btnRadioNc","id","btnRadioNc2",1,"custom-control-input"],["for","btnRadioNc2",1,"custom-control-label"],[1,"custom-control","custom-control-sm","custom-checkbox","checked"],["type","checkbox","formControlName","saveAndNew","id","saveAndNew","id","saveAndNew",1,"custom-control-input"],["for","saveAndNew",1,"custom-control-label","fw-bolder"],[1,"btn","btn-outline-danger","btn-sm",3,"title","click"],[1,"btn","btn-primary","btn-sm",3,"title","click"]],template:function(m,e){m&1&&(t(0,"form",0)(1,"div",1)(2,"h6",2),o(3),f(4,"titlecase"),i(),t(5,"button",3),u("click",function(){return e.addDepartmentBsModalRef==null?null:e.addDepartmentBsModalRef.hide()}),t(6,"span",4),o(7,"\xD7"),i()()(),t(8,"div",5),S(9,Ee,10,6,"div",6),p(10,"app-required-fields-notice"),t(11,"div",7)(12,"div",8)(13,"div",9),p(14,"app-form-label",10),t(15,"div",11),p(16,"input",12),t(17,"span",13),S(18,Be,2,0,"div",14)(19,Re,2,0,"div",14),i()()(),t(20,"div",9),p(21,"app-form-label",10),t(22,"div",11)(23,"textarea",15),o(24,"                        "),i(),t(25,"span",13),S(26,Ge,2,0,"div",14),i()()(),S(27,Ve,19,0,"div",16)(28,Le,14,2,"div",16)(29,Pe,5,0,"ng-container",14),i()()(),t(30,"div",17)(31,"div",18)(32,"button",19),u("click",function(){return e.addDepartmentBsModalRef==null?null:e.addDepartmentBsModalRef.hide()}),o(33," Close "),i()(),S(34,je,3,1,"div",20)(35,Ue,3,1,"div",20)(36,Oe,3,1,"div",20),i()()),m&2&&(d("formGroup",e.departmentFormGroup),a(3),b(_(4,18,e.departmentHeaderMsg)),a(6),d("ngIf",!1),a(5),d("labelForName","departmentName")("labelName","Department Name"),a(2),d("ngClass",U(20,ye,((e.departmentForm.departmentName==null?null:e.departmentForm.departmentName.touched)||(e.departmentForm.departmentName==null?null:e.departmentForm.departmentName.dirty)||e.submitted)&&(e.departmentForm.departmentName==null?null:e.departmentForm.departmentName.errors))),a(2),d("ngIf",e.departmentForm.departmentName==null||e.departmentForm.departmentName.errors==null?null:e.departmentForm.departmentName.errors.required),a(1),d("ngIf",e.departmentForm.departmentName==null||e.departmentForm.departmentName.errors==null?null:e.departmentForm.departmentName.errors.minlength),a(2),d("labelForName","remarks")("labelName","Remarks"),a(2),d("ngClass",U(22,ye,((e.departmentForm.remarks==null?null:e.departmentForm.remarks.touched)||(e.departmentForm.remarks==null?null:e.departmentForm.remarks.dirty)||e.submitted)&&(e.departmentForm.remarks==null?null:e.departmentForm.remarks.errors))),a(3),d("ngIf",e.departmentForm.remarks==null||e.departmentForm.remarks.errors==null?null:e.departmentForm.remarks.errors.required),a(1),d("ngIf",!1),a(1),d("ngIf",!1),a(1),d("ngIf",e.isAddMode),a(5),d("ngIf",!e.isAddMode),a(1),d("ngIf",!e.isAddMode),a(1),d("ngIf",e.isAddMode))},dependencies:[T,K,Y,W,X,V,re,B,ee,G,te,me,ne,oe,ve,se,de],encapsulation:2});let n=s;return n})();function qe(n,s){n&1&&(t(0,"tr")(1,"th"),o(2,"SN"),i(),t(3,"th"),o(4,"Department"),i(),t(5,"th"),o(6,"Remarks"),i(),t(7,"th"),o(8,"Created By"),i(),t(9,"th"),o(10,"Last Modified By"),i(),t(11,"th"),o(12,"Actions"),i()())}function $e(n,s){if(n&1){let l=x();t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),p(4,"app-full-name",15),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),f(9,"lowercase"),t(10,"div",16)(11,"small",17),o(12),f(13,"date"),i(),t(14,"small",18),o(15),f(16,"timeAgo"),i()()(),t(17,"td"),o(18),f(19,"lowercase"),t(20,"div",16)(21,"small",17),o(22),f(23,"date"),i(),t(24,"small",18),o(25),f(26,"timeAgo"),i()()(),t(27,"td")(28,"div",19),u("click",function(){let e=N(l).$implicit,g=h();return D(g.openDepartmentModalComponent(e,!1))}),t(29,"div",20)(30,"span"),p(31,"em",21),i()()()()()}if(n&2){let l=s.$implicit,r=s.rowIndex;a(2),b(r+1),a(2),H("fullName",l==null?null:l.departmentName),a(2),b(l.remarks),a(2),v(" ",_(9,9,l.createdBy)," "),a(4),b(I(13,11,l.createdDate,"medium")),a(3),v(" ",_(16,14,l.createdDate),""),a(3),v(" ",_(19,16,l.lastModifiedBy)," "),a(4),b(I(23,18,l.lastModifiedDate,"medium")),a(3),b(_(26,21,l.lastModifiedDate))}}var He=()=>[5,10,25,50],Nt=(()=>{let s=class s{constructor(r,m){this.accountService=r,this.departmentModalService=m,this.userAccountService=y(P),this.alertService=y(L),this.logger=y(k),this.accountService.currentUser.subscribe(e=>this.currentUser=e)}ngOnInit(){this.refreshButton(),this.logAction("Viewed departments page",w.SETTINGS)}ngOnDestroy(){this.departmentModalService.hide(),De.default.close()}refreshButton(){this.fetchDepartments()}fetchDepartments(){this.listOfDepartments=[],this.userAccountService.getDepartments().subscribe({next:r=>{if(this.logger.info("getDepartments response "+JSON.stringify(r)),r.headerResponse.responseCode!=="000"){this.alertService.error(r.headerResponse.responseMessage);return}if(r.departments.length<=0){this.alertService.showInfoMsgGeneral("No departments found"),this.logger.info("No departments found");return}this.listOfDepartments=r.departments},error:r=>{this.logger.error(r),this.alertService.showInfoMsg(r)}})}openDepartmentModalComponent(r,m){let e={initialState:{isAddMode:m,department:r}};this.departmentModalService.config.ignoreBackdropClick=!0,this.departmentModalService.config.animated=!0,this.addDepartmentBsModalRef=this.departmentModalService.show(Ne,e),this.addDepartmentBsModalRef.content.closeBtnName="Close"}logAction(r,m){return M(this,null,function*(){yield this.accountService.logUserAudit(r,m)})}};s.\u0275fac=function(m){return new(m||s)(c(E),c(Se))},s.\u0275cmp=F({type:s,selectors:[["app-department-list"]],standalone:!0,features:[A],decls:20,vars:14,consts:[[3,"pageTitleName","description"],[1,"newItemName"],[1,"btn","btn-primary",3,"click"],[1,"icon","ni","ni-plus"],[1,"row","gy-2","gx-3","mb-4","align-items-center"],[1,"col-auto"],[1,"form-control-wrap"],[1,"form-icon","form-icon-right"],[1,"icon","ni","ni-search"],["type","text","id","default-04","placeholder"," Search here",1,"form-control",3,"ngModel","ngModelChange"],["type","button","title","",1,"btn","btn-dim","btn-primary",3,"click"],["responsiveLayout","scroll","sortMode","multiple","responsiveLayout","scroll","styleClass","p-datatable-sm p-datatable-striped","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","scrollDirection","both",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","resizableColumns","autoLayout"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["otherFieldName","",3,"fullName"],[1,"fw-lighter"],[1,"d-block"],[1,"text-primary"],[1,"align-center","select-cursor",3,"click"],[1,"user-avatar","user-avatar-sm","bg-light"],[1,"icon","ni","ni-edit"]],template:function(m,e){m&1&&(t(0,"app-add-item",0)(1,"span",1)(2,"a",2),u("click",function(){return e.openDepartmentModalComponent(null,!0)}),p(3,"em",3),t(4,"span"),o(5,"Add department"),i()()()(),t(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),p(10,"em",8),i(),t(11,"input",9),u("ngModelChange",function(j){return e.searchedKeyword=j}),i()()(),t(12,"div",5)(13,"button",10),u("click",function(){return e.refreshButton()}),o(14," Refresh "),i()()(),t(15,"p-table",11,12),f(17,"filter"),S(18,qe,13,0,"ng-template",13)(19,$e,32,23,"ng-template",14),i()),m&2&&(d("pageTitleName","Departments")("description","Company departments"),a(11),d("ngModel",e.searchedKeyword),a(4),d("value",I(17,10,e.listOfDepartments,e.searchedKeyword))("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",J(13,He))("resizableColumns",!0)("autoLayout",!0))},dependencies:[T,z,Q,Ce,pe,he,_e,fe,ue,ce,V,B,G,ie],encapsulation:2});let n=s;return n})();export{Nt as DepartmentListComponent};
