import{a as ge}from"./chunk-NXAZBSFM.js";import{c as Pe}from"./chunk-QQMX5O62.js";import{a as x}from"./chunk-IP4FBAZW.js";import{e as be}from"./chunk-7PQCCLGB.js";import{a as ve}from"./chunk-T45HSKH6.js";import{d as he}from"./chunk-WH3N5QDN.js";import{r as ye,s as fe}from"./chunk-KPCRGR73.js";import{h as M}from"./chunk-543WOPA4.js";import{a as ce}from"./chunk-NEQ5BFSP.js";import{b as Q,c as W,e as F,f as Z,g as ee,l as te,m as ie,o as ne,p as ae,q as re,r as oe,s as le,u as me,v as pe,w as de,x as ue}from"./chunk-B2QESFZG.js";import{b as Be,c as se}from"./chunk-R55IMLXW.js";import{b as X,d as G,g as T}from"./chunk-IHPVOZWG.js";import{m as z}from"./chunk-7DWKZ4XI.js";import{Eb as i,Fb as h,Gb as c,Hb as D,Ic as U,Kc as j,Lc as H,Mb as I,Ob as S,Pc as $,Qc as B,Rc as Y,Sa as a,Sc as J,Ta as v,Tc as K,Uc as E,Wb as u,Xb as y,Yb as _,bb as p,ib as b,la as C,nb as t,ob as n,pb as d,qa as w,qb as q,ra as R,rb as V,tb as L,wb as P,xb as g}from"./chunk-QRSQYA3Q.js";import{d as _e,e as k}from"./chunk-5FZOKLP6.js";var Qe=(()=>{let l=class l{constructor(s,m){this.bsModalRef=s,this.accountService=m,this.accountService.currentUser.subscribe(e=>this.currentUser=e)}ngOnInit(){this.bsModalRef.setClass("gray modal-md modal-dialog-top")}};l.\u0275fac=function(m){return new(m||l)(v(M),v(T))},l.\u0275cmp=C({type:l,selectors:[["ng-component"]],standalone:!0,features:[I],decls:114,vars:38,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right","border","border-gray",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[1,"card","card-no-border"],[1,"pricing-body"],[1,"pricing-features"],[1,"preview-title-lg","overline-title"],[1,"w-40"],[1,"ms-auto","fw-bolder"],[1,"preview-title-lg","overline-title","mt-3"],[1,"row","my-3","mx-2","mb-3","justify-content-end"],[1,"col-auto"],[1,"btn","btn-sm","btn-primary",3,"click"]],template:function(m,e){m&1&&(t(0,"div",0)(1,"h6",1),i(2),n(),t(3,"button",2),P("click",function(){return e.bsModalRef==null?null:e.bsModalRef.hide()}),t(4,"span",3),i(5,"\xD7"),n()()(),t(6,"div",4)(7,"div",5)(8,"div",6)(9,"ul",7)(10,"span",8),i(11,"Occupancy Details"),n(),t(12,"li")(13,"span",9),i(14,"Occupant"),n(),i(15," - "),t(16,"span",10),i(17),n()(),t(18,"li")(19,"span",9),i(20,"Occupant Type"),n(),i(21," - "),t(22,"span",10),i(23),n()(),t(24,"li")(25,"span",9),i(26,"Property No."),n(),i(27," - "),t(28,"span",10),i(29),n()(),t(30,"li")(31,"span",9),i(32,"Property Name"),n(),i(33," - "),t(34,"span",10),i(35),n()(),t(36,"li")(37,"span",9),i(38,"Property Usage"),n(),i(39," - "),t(40,"span",10),i(41),u(42,"titlecase"),u(43,"removeHyphen"),n()(),t(44,"span",11),i(45,"Payment Details"),n(),t(46,"li")(47,"span",9),i(48,"Amount Paid"),n(),i(49," - "),t(50,"span",10),i(51),u(52,"number"),n()(),t(53,"li")(54,"span",9),i(55,"Medium Of Payment"),n(),i(56," - "),t(57,"span",10),i(58),u(59,"titlecase"),u(60,"removeHyphen"),n()(),t(61,"li")(62,"span",9),i(63,"Payment Ref. No. "),n(),i(64," - "),t(65,"span",10),i(66),n()(),t(67,"li")(68,"span",9),i(69,"Receipt Number Issued"),n(),i(70," - "),t(71,"span",10),i(72),n()(),t(73,"li")(74,"span",9),i(75,"Narration"),n(),i(76," - "),t(77,"span",10),i(78),n()(),t(79,"li")(80,"span",9),i(81,"Payment Date"),n(),i(82," - "),t(83,"span",10)(84,"span"),i(85),u(86,"date"),u(87,"timeAgo"),n()()(),t(88,"li")(89,"span",9),i(90,"Recorded By"),n(),i(91," - "),t(92,"span",10),i(93),n()(),t(94,"li")(95,"span",9),i(96,"Last modified Date"),n(),i(97," - "),t(98,"span",10)(99,"span"),i(100),u(101,"date"),u(102,"timeAgo"),n()()(),t(103,"li")(104,"span",9),i(105,"Last Modified By"),n(),i(106," - "),t(107,"span",10),i(108),n()()()()()(),t(109,"div",12)(110,"div",13)(111,"a",14),P("click",function(){return e.bsModalRef==null?null:e.bsModalRef.hide()}),t(112,"span"),i(113,"Close"),n()()()()),m&2&&(a(2),c("",e.propertyLedger.occupantName," payment details"),a(15),h(e.propertyLedger.occupantName),a(6),h(e.propertyLedger.institutionalDisplayName),a(6),h(e.propertyLedger.propertyNo),a(6),h(e.propertyLedger.propertyName),a(6),h(y(42,17,y(43,19,e.propertyLedger==null?null:e.propertyLedger.propertyUsage))),a(10),h(_(52,21,e.propertyLedger.amountPaid,"1.2-2")),a(7),c(" ",y(59,24,y(60,26,e.propertyLedger.mediumOfPayment))," "),a(8),c(" ",e.propertyLedger.mediumOfPaymentNumber," "),a(6),c(" ",e.propertyLedger.receiptNumberIssued," "),a(6),h(e.propertyLedger==null?null:e.propertyLedger.paymentFor),a(7),D("",_(86,28,e.propertyLedger.dateOfRecordEntry,"medium")," ",y(87,31,e.propertyLedger.dateOfRecordEntry.toString()),""),a(8),h(e.propertyLedger.createdBy),a(7),D("",_(101,33,e.propertyLedger.lastModifiedDate,"medium")," ",y(102,36,e.propertyLedger.lastModifiedDate.toString()),""),a(8),h(e.propertyLedger.lastModifiedBy))},dependencies:[E,K,B,Y,be,x],encapsulation:2});let r=l;return r})();var O=_e(Be());var A=class{};function Ae(r,l){if(r&1&&(t(0,"div",29),d(1,"br"),i(2),d(3,"br"),i(4),d(5,"br"),i(6),d(7,"br"),i(8),u(9,"json"),n()),r&2){let o=g();a(2),c("Dirty: ",o.paymentFormGroup.dirty," "),a(2),c("Touched: ",o.paymentFormGroup.touched," "),a(2),c("Valid: ",o.paymentFormGroup.valid," "),a(2),c("Value: ",y(9,4,o.paymentFormGroup.value)," ")}}function we(r,l){r&1&&(t(0,"div"),d(1,"app-required-field"),n())}function Re(r,l){r&1&&(t(0,"span"),d(1,"app-required-field"),n())}function Le(r,l){if(r&1&&(t(0,"option",30),i(1),n()),r&2){let o=l.$implicit;p("value",o.dataValue),a(1),c(" ",o.dataLabel," ")}}function De(r,l){r&1&&(t(0,"div"),d(1,"app-required-field"),n())}function Ge(r,l){r&1&&(t(0,"div"),d(1,"app-required-field"),n())}function ke(r,l){r&1&&(t(0,"div"),d(1,"app-required-field"),n())}function qe(r,l){if(r&1&&(t(0,"div",35)(1,"div",36),d(2,"em",37),t(3,"strong"),i(4,"NOTE:"),n(),i(5),n()()),r&2){let o=g(2);a(5),c(" the amount(GHS ",o.paymentForm.amountPaid==null?null:o.paymentForm.amountPaid.value,") will shared among all the properties of occupant. ")}}function Ve(r,l){if(r&1&&(q(0),t(1,"div",31),d(2,"input",32),t(3,"label",33),i(4," Spread amount for occupant's properties "),n()(),b(5,qe,6,1,"div",34),V()),r&2){let o=g();a(5),p("ngIf",o.paymentForm.spreadAmtForOccupantProperties==null?null:o.paymentForm.spreadAmtForOccupantProperties.value)}}function Ue(r,l){if(r&1){let o=L();t(0,"div",26)(1,"button",38),P("click",function(){w(o);let m=g();return R(m.updatePayment())}),i(2),u(3,"removeHyphen"),u(4,"lowercase"),n()()}if(r&2){let o=g();a(2),c(" Update ",y(3,1,y(4,3,o.payBill==null?null:o.payBill.paymentType))," ")}}function je(r,l){if(r&1){let o=L();t(0,"div",26)(1,"button",39),P("click",function(){w(o);let m=g();return R(m.savePayment())}),i(2),u(3,"removeHyphen"),u(4,"lowercase"),n()()}if(r&2){let o=g();a(2),c(" Pay ",y(3,1,y(4,3,o.payBill==null?null:o.payBill.paymentType))," ")}}var N=r=>({"is-invalid":r}),ht=(()=>{let l=class l{constructor(s,m,e,f,Fe,Ne,Oe,Ce){this.billPaymentService=s,this.settingsService=m,this.title=e,this.addPaymentBsModalRef=f,this.fb=Fe,this.accountService=Ne,this.alertService=Oe,this.logger=Ce,this.submitted=!1,this.accountService.currentUser.subscribe(Ie=>this.currentUser=Ie)}ngOnInit(){if(this.createNewForm(),this.isAddMode?(this.propertyChargeHeaderMsg=`Payment for ${this.payBill.occupantName} 
      (${this.payBill.propertyId}) - bill year ${this.payBill.billYear}`,this.title.setTitle(this.propertyChargeHeaderMsg)):(this.propertyChargeHeaderMsg=`Edit payment for ${this.payBill.occupantName}`,this.title.setTitle(this.propertyChargeHeaderMsg)),this.paymentFormGroup.patchValue(this.payBill),this.payBill.dateOfTransaction){let s=this.payBill.dateOfTransaction.toString().replace("[UTC]","");this.paymentForm.dateOfTransaction.setValue(new Date(s)),this.paymentFormGroup.get("dateOfTransaction").disable()}this.paymentFormGroup.get("payerName").disable(),this.paymentFormGroup.get("billAmount").disable(),this.addPaymentBsModalRef.setClass("gray modal-md modal-dialog-top"),this.listOfModeOfPayments=this.settingsService.getModeOfPayments()}createNewForm(){this.paymentFormGroup=this.fb.group({dateOfTransaction:["",[F.required]],modeOfPayment:["",[F.required]],modeOfPaymentNo:["",{updateOn:"blur",validators:[F.required]}],receiptNumber:["",{updateOn:"blur",validators:[F.required]}],amountPaid:["",{updateOn:"blur",validators:[F.required]}],billYear:[""],billAmount:[""],propertyId:[""],payerName:[""],billId:[""],recordId:[""],occupantId:[""],paymentType:[""],spreadAmtForOccupantProperties:[!1]})}get paymentForm(){return this.paymentFormGroup.controls}modeOfPaymentListeners(){this.paymentForm.modeOfPaymentNo.setValue(""),this.paymentForm.modeOfPayment.value==="CASH"&&this.paymentFormGroup.get("modeOfPaymentNo").setValue(this.paymentForm.receiptNumber.value)}savePayment(){this.submitted=!0,!this.paymentFormGroup.invalid&&O.default.fire({title:"Confirmation",text:`Do you want to pay ${this.payBill.paymentType.toLowerCase()} for property  ${this.payBill.propertyId}?`,icon:"question",position:"top",showCancelButton:!0,confirmButtonText:"Yes, pay",cancelButtonText:"No, cancel"}).then(s=>{s.value?(this.alertService.clear(),this.billPaymentService.payBill(this.currentUser,this.paymentFormGroup.value).subscribe({next:m=>{if(m.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(m.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(m.headerResponse.responseMessage),localStorage.setItem("payBill",JSON.stringify(this.payBill)),this.accountService.reloadCurrentRoute(),this.paymentFormGroup.reset(),this.submitted=!1,this.logAction(`saved  ${this.payBill.paymentType} payment of ${this.paymentForm.amountInvolved.value} 
              for  ${this.payBill.propertyId}`,G.BILL_PAYMENTS)},error:m=>{this.alertService.showInfoMsg(m)}})):(s.dismiss,O.default.DismissReason.cancel)})}updatePayment(){if(this.submitted=!0,this.paymentFormGroup.invalid)return;let s=this.payBill.propertyId;O.default.fire({position:"top",title:"Confirmation",text:`Do you want to update payment for ${s}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, update"}).then(m=>{if(m.value){this.alertService.clear();let e=new A;e.amountPaid=this.paymentForm.amountPaid.value,e.billId=this.paymentForm.billId.value,e.ledgerId=this.paymentForm.recordId.value,e.modeOfPayment=this.paymentForm.modeOfPayment.value,e.modeOfPaymentNo=this.paymentForm.modeOfPaymentNo.value,e.receiptNumber=this.paymentForm.receiptNumber.value,this.billPaymentService.updatePayBill(this.currentUser,e).subscribe({next:f=>{if(this.logger.info("updatePayBill response:"+JSON.stringify(f)),f.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(f.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(f.headerResponse.responseMessage),this.addPaymentBsModalRef.hide(),this.logAction(`Updated ${s}`,G.BILL_PAYMENTS),this.accountService.reloadCurrentRoute()},error:f=>{this.alertService.showInfoMsg(f.message)}})}else m.dismiss,O.default.DismissReason.cancel})}logAction(s,m){return k(this,null,function*(){yield this.accountService.logUserAudit(s,m)})}};l.\u0275fac=function(m){return new(m||l)(v(ge),v(he),v(z),v(M),v(me),v(T),v(se),v(X))},l.\u0275cmp=C({type:l,selectors:[["ng-component"]],standalone:!0,features:[I],decls:68,vars:44,consts:[["novalidate","",3,"formGroup"],[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right","border","border-gray",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["class","p-10",4,"ngIf"],[1,"row","gy-3","mt-3"],[1,"col-sm-6"],[1,"form-group"],[3,"labelForName","labelName"],[1,"form-control-wrap"],["type","text","formControlName","payerName","id","payerName","autocomplete","off",1,"form-control"],["type","text","formControlName","billAmount","id","billAmount","autocomplete","off",1,"form-control"],["type","number","formControlName","receiptNumber","id","receiptNumber","autocomplete","off",1,"form-control",2,"min-height","40px",3,"ngClass"],[1,"invalid-feedback"],[4,"ngIf"],["styleClass","w-100","formControlName","dateOfTransaction","id","dateOfTransaction","dateFormat","dd-mm-yy",3,"showIcon","ngClass"],[1,"form-control-select"],["id","regionId","formControlName","modeOfPayment",1,"form-control",3,"ngClass","change"],["value","","selected","",1,"fs-6"],[3,"value",4,"ngFor","ngForOf"],["type","number","formControlName","modeOfPaymentNo","id","modeOfPaymentNo","autocomplete","off",1,"form-control",3,"ngClass"],["type","number","formControlName","amountPaid","id","amountPaid","autocomplete","off",1,"form-control",2,"min-height","40px",3,"ngClass"],[1,"col-sm-12"],[1,"row","my-3","mx-2","mb-3","justify-content-end"],[1,"col-auto"],["data-bs-dismiss","modal",1,"btn","btn-outline-light","btn-sm",3,"click"],["class","col-auto",4,"ngIf"],[1,"p-10"],[3,"value"],[1,"custom-control","custom-checkbox","checked"],["type","checkbox","formControlName","spreadAmtForOccupantProperties","id","spreadAmtForOccupantProperties","id","spreadAmtForOccupantProperties",1,"custom-control-input"],["for","spreadAmtForOccupantProperties",1,"custom-control-label","fw-bold"],["class","example-alert mt-2",4,"ngIf"],[1,"example-alert","mt-2"],[1,"alert","alert-warning","alert-icon"],[1,"icon","ni","ni-alert-c"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"btn","btn-primary","btn-sm","text-capitalize",3,"click"]],template:function(m,e){m&1&&(t(0,"form",0)(1,"div",1)(2,"h6",2),i(3),u(4,"titlecase"),n(),t(5,"button",3),P("click",function(){return e.addPaymentBsModalRef==null?null:e.addPaymentBsModalRef.hide()}),t(6,"span",4),i(7,"\xD7"),n()()(),t(8,"div",5),b(9,Ae,10,6,"div",6),d(10,"app-required-fields-notice"),t(11,"div",7)(12,"div",8)(13,"div",9),d(14,"app-form-label",10),t(15,"div",11),d(16,"input",12),n()()(),t(17,"div",8)(18,"div",9),d(19,"app-form-label",10),t(20,"div",11),d(21,"input",13),n()()(),t(22,"div",8)(23,"div",9),d(24,"app-form-label",10),t(25,"div",11),d(26,"input",14),t(27,"span",15),b(28,we,2,0,"div",16),n()()()(),t(29,"div",8)(30,"div",9),d(31,"app-form-label",10)(32,"p-calendar",17),t(33,"span",15),b(34,Re,2,0,"span",16),n()()(),t(35,"div",8)(36,"div",9),d(37,"app-form-label",10),t(38,"div",11)(39,"div",18)(40,"select",19),P("change",function(){return e.modeOfPaymentListeners()}),t(41,"option",20),i(42,"Select One"),n(),b(43,Le,2,2,"option",21),n(),t(44,"span",15),b(45,De,2,0,"div",16),n()()()()(),t(46,"div",8)(47,"div",9),d(48,"app-form-label",10),t(49,"div",11),d(50,"input",22),t(51,"span",15),b(52,Ge,2,0,"div",16),n()()()(),t(53,"div",8)(54,"div",9),d(55,"app-form-label",10),t(56,"div",11),d(57,"input",23),t(58,"span",15),b(59,ke,2,0,"div",16),n()()()(),t(60,"div",24),b(61,Ve,6,1,"ng-container",16),n()()(),t(62,"div",25)(63,"div",26)(64,"button",27),P("click",function(){return e.addPaymentBsModalRef==null?null:e.addPaymentBsModalRef.hide()}),i(65," Close "),n()(),b(66,Ue,5,5,"div",28)(67,je,5,5,"div",28),n()()),m&2&&(p("formGroup",e.paymentFormGroup),a(3),h(y(4,32,e.propertyChargeHeaderMsg)),a(6),p("ngIf",!1),a(5),p("labelForName","payerName")("labelName","Payer"),a(5),p("labelForName","billAmount")("labelName","Bill Arrears"),a(5),p("labelForName","receiptNumber")("labelName","Receipt No."),a(2),p("ngClass",S(34,N,((e.paymentForm.receiptNumber==null?null:e.paymentForm.receiptNumber.touched)||(e.paymentForm.receiptNumber==null?null:e.paymentForm.receiptNumber.dirty)||e.submitted)&&(e.paymentForm.receiptNumber==null?null:e.paymentForm.receiptNumber.errors))),a(2),p("ngIf",e.paymentForm.receiptNumber==null||e.paymentForm.receiptNumber.errors==null?null:e.paymentForm.receiptNumber.errors.required),a(3),p("labelForName","dateOfTransaction")("labelName","Date of Payment"),a(1),p("showIcon",!0)("ngClass",S(36,N,((e.paymentForm.dateOfTransaction==null?null:e.paymentForm.dateOfTransaction.touched)||(e.paymentForm.dateOfTransaction==null?null:e.paymentForm.dateOfTransaction.dirty)||e.submitted)&&(e.paymentForm.dateOfTransaction==null?null:e.paymentForm.dateOfTransaction.errors))),a(2),p("ngIf",e.paymentForm.dateOfTransaction==null||e.paymentForm.dateOfTransaction.errors==null?null:e.paymentForm.dateOfTransaction.errors.required),a(3),p("labelForName","modeOfPayment")("labelName","Mode Of Payment"),a(3),p("ngClass",S(38,N,((e.paymentForm.modeOfPayment==null?null:e.paymentForm.modeOfPayment.touched)||(e.paymentForm.modeOfPayment==null?null:e.paymentForm.modeOfPayment.dirty)||e.submitted)&&(e.paymentForm.modeOfPayment==null?null:e.paymentForm.modeOfPayment.errors))),a(3),p("ngForOf",e.listOfModeOfPayments),a(2),p("ngIf",e.paymentForm.modeOfPayment==null||e.paymentForm.modeOfPayment.errors==null?null:e.paymentForm.modeOfPayment.errors.required),a(3),p("labelForName","modeOfPaymentNo")("labelName","Mode Of Payment No."),a(2),p("ngClass",S(40,N,((e.paymentForm.modeOfPaymentNo==null?null:e.paymentForm.modeOfPaymentNo.touched)||(e.paymentForm.modeOfPaymentNo==null?null:e.paymentForm.modeOfPaymentNo.dirty)||e.submitted)&&(e.paymentForm.modeOfPaymentNo==null?null:e.paymentForm.modeOfPaymentNo.errors))),a(2),p("ngIf",e.paymentForm.modeOfPaymentNo==null||e.paymentForm.modeOfPaymentNo.errors==null?null:e.paymentForm.modeOfPaymentNo.errors.required),a(3),p("labelForName","amountPaid")("labelName","Amount"),a(2),p("ngClass",S(42,N,((e.paymentForm.amountPaid==null?null:e.paymentForm.amountPaid.touched)||(e.paymentForm.amountPaid==null?null:e.paymentForm.amountPaid.dirty)||e.submitted)&&(e.paymentForm.amountPaid==null?null:e.paymentForm.amountPaid.errors))),a(2),p("ngIf",e.paymentForm.amountPaid==null||e.paymentForm.amountPaid.errors==null?null:e.paymentForm.amountPaid.errors.required),a(2),p("ngIf",e.isAddMode&&(e.paymentForm.amountPaid==null?null:e.paymentForm.amountPaid.value)),a(5),p("ngIf",!e.isAddMode),a(1),p("ngIf",e.isAddMode))},dependencies:[E,U,j,H,$,J,B,pe,te,oe,le,W,ie,Q,re,Z,ee,de,ne,ae,ve,ue,ce,Pe,fe,ye,x],encapsulation:2});let r=l;return r})();var Se=class{constructor(l,o){this.datePaid=new Date,l?(this.billId=l.recordId,this.billAmount=l.billAmount,this.billYear=l.billYear,this.propertyId=l.property,this.occupantId=l.occupant,this.paymentType="PICK FROM OUTSTANDING BILLS",this.payerName="PICK FROM OUTSTANDING BILLS"):(this.recordId=o.recordId,this.amountPaid=o.amountPaid,this.billAmount=o.billAmount,this.billYear=o.ledgerYear,this.propertyId=o.propertyId,this.occupantId=o.occupant,this.paymentType=o.paymentType,this.receiptNumber=o.receiptNumberIssued,this.modeOfPayment=o.mediumOfPayment,this.modeOfPaymentNo=o.mediumOfPaymentNumber,this.billId=o.bill,this.payerName=o.payeeName,this.occupantName=o.occupantName,this.dateOfTransaction=o.dateOfRecordTransaction)}};export{Qe as a,ht as b,Se as c};
