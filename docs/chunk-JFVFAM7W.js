import{a as Ne,b as ye,c as we}from"./chunk-QQMX5O62.js";import{a as Fe}from"./chunk-IP4FBAZW.js";import{a as Re}from"./chunk-L66UILBA.js";import{b as ue,c as fe,d as be,e as Ce}from"./chunk-7PQCCLGB.js";import{a as ve}from"./chunk-T45HSKH6.js";import{d as V}from"./chunk-WH3N5QDN.js";import{i as ge,t as he}from"./chunk-KPCRGR73.js";import{h as Se,i as _e}from"./chunk-543WOPA4.js";import"./chunk-5WO4BOAD.js";import{a as pe}from"./chunk-NEQ5BFSP.js";import{b as ee,c as te,e as k,f as D,g as ie,k as ne,l as oe,o as re,p as ae,u as le,v as O,w as se,x as me}from"./chunk-B2QESFZG.js";import{b as ce}from"./chunk-Y725X6Z7.js";import{b as de,c as z}from"./chunk-R55IMLXW.js";import"./chunk-LPKVFVKE.js";import{b as B,d as w,g as G}from"./chunk-IHPVOZWG.js";import"./chunk-HPGLX4ZN.js";import{m as W}from"./chunk-7DWKZ4XI.js";import{Ab as $,Eb as l,Fb as b,Gb as h,Ic as H,Kc as J,Lc as K,Mb as x,Nb as Z,Ob as j,Pc as X,Qc as A,Rc as Y,Sa as r,Sc as Q,Ta as g,Uc as E,Wb as c,Xb as u,Yb as T,bb as m,ib as S,la as M,nb as t,ob as n,pb as p,qa as C,qb as q,ra as R,rb as U,tb as N,wb as f,xb as _}from"./chunk-QRSQYA3Q.js";import{d as L,e as I}from"./chunk-5FZOKLP6.js";var xe=L(de());var F=L(de());function Pe(o,d){if(o&1&&(t(0,"div",22),p(1,"br"),l(2),p(3,"br"),l(4),p(5,"br"),l(6),p(7,"br"),l(8),c(9,"json"),n()),o&2){let a=_();r(2),h("Dirty: ",a.regionFormGroup.dirty," "),r(2),h("Touched: ",a.regionFormGroup.touched," "),r(2),h("Valid: ",a.regionFormGroup.valid," "),r(2),h("Value: ",u(9,4,a.regionFormGroup.value)," ")}}function je(o,d){if(o&1&&(t(0,"ng-option",23),l(1),n()),o&2){let a=d.$implicit;m("value",a.recordId),r(1),h(" ",a.zoneName," ")}}function Le(o,d){o&1&&(t(0,"span"),p(1,"app-required-field"),n())}function qe(o,d){if(o&1&&(t(0,"ng-option",23),l(1),n()),o&2){let a=d.$implicit;m("value",a.dataValue),r(1),h(" ",a.dataLabel," ")}}function Ue(o,d){o&1&&(t(0,"span"),p(1,"app-required-field"),n())}function $e(o,d){o&1&&(q(0),t(1,"div",24),p(2,"input",25),t(3,"label",26),l(4," Save & create new "),n()(),U())}function Ze(o,d){if(o&1){let a=N();t(0,"div",19)(1,"button",27),f("click",function(){C(a);let s=_();return R(s.deleteRegion())}),l(2," Delete "),n()()}if(o&2){let a=_();r(1),m("title",a.regionFormGroup.invalid?"There must be errors on the form":"")}}function He(o,d){if(o&1){let a=N();t(0,"div",19)(1,"button",28),f("click",function(){C(a);let s=_();return R(s.updateRegion())}),l(2," Update region "),n()()}if(o&2){let a=_();r(1),m("title",a.regionFormGroup.invalid?"There must be errors on the form":"")}}function Je(o,d){if(o&1){let a=N();t(0,"div",19)(1,"button",28),f("click",function(){C(a);let s=_();return R(s.saveRegion())}),l(2," Create region "),n()()}if(o&2){let a=_();r(1),m("title",a.regionFormGroup.invalid?"There must be errors on the form":"")}}var Ie=o=>({"is-invalid":o}),Me=(()=>{let d=class d{constructor(i,s,e,v,y,P,Te){this.title=i,this.addRegionBsModalRef=s,this.fb=e,this.accountService=v,this.alertService=y,this.logger=P,this.settingsService=Te,this.submitted=!1,this.accountService.currentUser.subscribe(Ae=>this.currentUser=Ae)}ngOnInit(){this.createNewForm(),this.isAddMode?(this.regionHeaderMsg="New region",this.title.setTitle(this.regionHeaderMsg)):(this.regionHeaderMsg="Edit "+this.region.regionName,this.title.setTitle(this.regionHeaderMsg),this.regionFormGroup.patchValue(this.region)),this.addRegionBsModalRef.setClass("gray modal-sm modal-dialog-top"),this.fetchZones(),this.listGhanaRegions=this.settingsService.getGhanaRegions()}createNewForm(){this.regionFormGroup=this.fb.group({regionName:["",{updateOn:"blur",validators:[k.required,k.minLength(3)]}],zoneId:["",[k.required]],recordId:[""],saveAndNew:[!1]})}get regionForm(){return this.regionFormGroup.controls}fetchZones(){this.listOfZones=[],this.settingsService.getZones().subscribe({next:i=>{if(this.logger.info("getZones response "+JSON.stringify(i)),i.headerResponse.responseCode!=="000"){this.alertService.error(i.headerResponse.responseMessage);return}if(i.zones.length<=0){this.alertService.showInfoMsgGeneral("No zones found"),this.logger.info("No zones found");return}this.listOfZones=i.zones},error:i=>{this.logger.error(i),this.alertService.showInfoMsg(i)}})}saveRegion(){if(this.submitted=!0,this.alertService.clear(),this.regionFormGroup.invalid)return;let i=this.regionForm.regionName.value;F.default.fire({title:"Confirmation",text:`Do you want to create region  ${i}?`,icon:"question",position:"top",showCancelButton:!0,confirmButtonText:"Yes, create",cancelButtonText:"No, cancel"}).then(s=>{s.value?this.settingsService.createRegion(this.currentUser,this.regionFormGroup.value).subscribe({next:e=>{if(e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(`${i} created successfully`),this.regionForm.saveAndNew.value||(this.addRegionBsModalRef.hide(),setTimeout(()=>window.location.reload(),1500)),this.submitted=!1,this.regionFormGroup.reset(),this.logAction(`created region ${i}`,w.SETTINGS)},error:e=>{this.alertService.showInfoMsg(e)}}):(s.dismiss,F.default.DismissReason.cancel)})}updateRegion(){if(this.submitted=!0,this.alertService.clear(),this.regionFormGroup.invalid)return;let i=this.regionForm.regionName.value;F.default.fire({position:"top",title:"Confirmation",text:`Do you want to update Region ${i}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, update"}).then(s=>{if(s.value){if(this.alertService.clear(),this.regionFormGroup.invalid)return;this.settingsService.updateRegion(this.currentUser,this.regionFormGroup.value).subscribe({next:e=>{if(this.logger.info("updateUserAccount response:"+JSON.stringify(e)),e.headerResponse.responseCode!=="000"){this.alertService.showErrorMsg(e.headerResponse.responseMessage);return}this.alertService.showSuccessMsg(`${i} updated successfully`),this.addRegionBsModalRef.hide(),this.logAction(`Updated ${i}`,w.SETTINGS),setTimeout(()=>window.location.reload(),1500)},error:e=>{this.alertService.showInfoMsg(e.message)}})}else s.dismiss,F.default.DismissReason.cancel})}deleteRegion(){this.submitted=!0,this.alertService.clear(),this.regionFormGroup.invalid}logAction(i,s){return I(this,null,function*(){yield this.accountService.logUserAudit(i,s)})}};d.\u0275fac=function(s){return new(s||d)(g(W),g(Se),g(le),g(G),g(z),g(B),g(V))},d.\u0275cmp=M({type:d,selectors:[["ng-component"]],standalone:!0,features:[x],decls:39,vars:25,consts:[["novalidate","",3,"formGroup"],[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right","border","border-gray",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["class","p-10",4,"ngIf"],[1,"row","gy-2","mt-3"],[1,"col-sm-12"],[1,"form-group"],[3,"labelForName","labelName"],[1,"form-control-wrap"],["id","zoneId","formControlName","zoneId",3,"clearable","ngClass"],["value","","selected","",1,"fs-6"],[3,"value",4,"ngFor","ngForOf"],[1,"invalid-feedback"],[4,"ngIf"],["id","regionName","formControlName","regionName",3,"clearable","ngClass"],[1,"row","my-3","mx-2","mb-3","justify-content-end"],[1,"col-auto"],["data-bs-dismiss","modal",1,"btn","btn-outline-light","btn-sm",3,"click"],["class","col-auto",4,"ngIf"],[1,"p-10"],[3,"value"],[1,"custom-control","custom-control-sm","custom-checkbox","checked"],["type","checkbox","formControlName","saveAndNew","id","saveAndNew","id","saveAndNew",1,"custom-control-input"],["for","saveAndNew",1,"custom-control-label","fw-bolder"],[1,"btn","btn-outline-danger","btn-sm",3,"title","click"],[1,"btn","btn-primary","btn-sm",3,"title","click"]],template:function(s,e){s&1&&(t(0,"form",0)(1,"div",1)(2,"h6",2),l(3),c(4,"titlecase"),n(),t(5,"button",3),f("click",function(){return e.addRegionBsModalRef==null?null:e.addRegionBsModalRef.hide()}),t(6,"span",4),l(7,"\xD7"),n()()(),t(8,"div",5),S(9,Pe,10,6,"div",6),p(10,"app-required-fields-notice"),t(11,"div",7)(12,"div",8)(13,"div",9),p(14,"app-form-label",10),t(15,"div",11)(16,"ng-select",12)(17,"ng-option",13),l(18,"Select One"),n(),S(19,je,2,2,"ng-option",14),n(),t(20,"span",15),S(21,Le,2,0,"span",16),n()()(),t(22,"div",9),p(23,"app-form-label",10),t(24,"div",11)(25,"ng-select",17)(26,"ng-option",13),l(27,"Select One"),n(),S(28,qe,2,2,"ng-option",14),n(),t(29,"span",15),S(30,Ue,2,0,"span",16),n()()(),S(31,$e,5,0,"ng-container",16),n()()(),t(32,"div",18)(33,"div",19)(34,"button",20),f("click",function(){return e.addRegionBsModalRef==null?null:e.addRegionBsModalRef.hide()}),l(35," Close "),n()(),S(36,Ze,3,1,"div",21)(37,He,3,1,"div",21)(38,Je,3,1,"div",21),n()()),s&2&&(m("formGroup",e.regionFormGroup),r(3),b(u(4,19,e.regionHeaderMsg)),r(6),m("ngIf",!1),r(5),m("labelForName","zoneId")("labelName","Zones"),r(2),m("clearable",!1)("ngClass",j(21,Ie,((e.regionForm.zoneId==null?null:e.regionForm.zoneId.touched)||(e.regionForm.zoneId==null?null:e.regionForm.zoneId.dirty)||e.submitted)&&(e.regionForm.zoneId==null?null:e.regionForm.zoneId.errors))),r(3),m("ngForOf",e.listOfZones),r(2),m("ngIf",e.regionForm.zoneId==null||e.regionForm.zoneId.errors==null?null:e.regionForm.zoneId.errors.required),r(2),m("labelForName","regionName")("labelName","Region"),r(2),m("clearable",!1)("ngClass",j(23,Ie,((e.regionForm.regionName==null?null:e.regionForm.regionName.touched)||(e.regionForm.regionName==null?null:e.regionForm.regionName.dirty)||e.submitted)&&(e.regionForm.regionName==null?null:e.regionForm.regionName.errors))),r(3),m("ngForOf",e.listGhanaRegions),r(2),m("ngIf",e.regionForm.regionName==null||e.regionForm.regionName.errors==null?null:e.regionForm.regionName.errors.required),r(1),m("ngIf",e.isAddMode),r(5),m("ngIf",!e.isAddMode),r(1),m("ngIf",!e.isAddMode),r(1),m("ngIf",e.isAddMode))},dependencies:[E,H,J,K,Q,A,O,oe,ee,D,ie,se,re,ae,we,ye,Ne,ve,me,pe],encapsulation:2});let o=d;return o})();function Ke(o,d){o&1&&(t(0,"tr")(1,"th"),l(2,"SN"),n(),t(3,"th"),l(4,"Region"),n(),t(5,"th"),l(6,"Zone"),n(),t(7,"th"),l(8,"Created By"),n(),t(9,"th"),l(10,"Last Modified By"),n(),t(11,"th"),l(12,"Actions"),n()())}function Xe(o,d){if(o&1){let a=N();t(0,"tr")(1,"td"),l(2),n(),t(3,"td"),p(4,"app-full-name",15),c(5,"titlecase"),c(6,"removeHyphen"),n(),t(7,"td"),l(8),n(),t(9,"td"),l(10),c(11,"lowercase"),t(12,"div",16)(13,"small",17),l(14),c(15,"date"),c(16,"cleanDate"),n(),t(17,"small",18),l(18),c(19,"timeAgo"),n()()(),t(20,"td"),l(21),c(22,"lowercase"),t(23,"div",16)(24,"small",17),l(25),c(26,"date"),c(27,"cleanDate"),n(),t(28,"small",18),l(29),c(30,"timeAgo"),n()()(),t(31,"td")(32,"div",19),f("click",function(){let e=C(a).$implicit,v=_();return R(v.openRegionModalComponent(e,!1))}),t(33,"div",20)(34,"span"),p(35,"em",21),n()()()()()}if(o&2){let a=d.$implicit,i=d.rowIndex;r(2),b(i+1),r(2),$("fullName",u(5,9,u(6,11,a==null?null:a.regionName))),r(4),b(a.zoneName),r(2),h(" ",u(11,13,a.createdBy)," "),r(4),b(T(15,15,u(16,18,a.createdDate),"medium")),r(4),h(" ",u(19,20,a.createdDate),""),r(3),h(" ",u(22,22,a.lastModifiedBy)," "),r(4),b(T(26,24,u(27,27,a.lastModifiedDate),"medium")),r(4),b(u(30,29,a.lastModifiedDate))}}var Ye=()=>[5,10,25,50],yt=(()=>{let d=class d{constructor(i,s,e,v,y){this.accountService=i,this.alertService=s,this.logger=e,this.settings=v,this.regionModalService=y,this.accountService.currentUser.subscribe(P=>this.currentUser=P)}ngOnInit(){this.refreshButton(),this.logAction("Viewed regions page",w.SETTINGS)}ngOnDestroy(){this.regionModalService.hide(),xe.default.close()}refreshButton(){this.fetchRegions()}fetchRegions(){this.listOfRegions=[],this.settings.getRegions().subscribe({next:i=>{if(this.logger.info("getRegions response "+JSON.stringify(i)),i.headerResponse.responseCode!=="000"){this.alertService.error(i.headerResponse.responseMessage);return}if(i.regions.length<=0){this.alertService.showInfoMsgGeneral("No regions found"),this.logger.info("No regions found");return}this.listOfRegions=i.regions},error:i=>{this.logger.error(i),this.alertService.showInfoMsg(i)}})}openRegionModalComponent(i,s){let e={initialState:{isAddMode:s,region:i}};this.regionModalService.config.ignoreBackdropClick=!0,this.regionModalService.config.animated=!0,this.addRegionBsModalRef=this.regionModalService.show(Me,e),this.addRegionBsModalRef.content.closeBtnName="Close"}logAction(i,s){return I(this,null,function*(){yield this.accountService.logUserAudit(i,s)})}};d.\u0275fac=function(s){return new(s||d)(g(G),g(z),g(B),g(V),g(_e))},d.\u0275cmp=M({type:d,selectors:[["ng-component"]],standalone:!0,features:[x],decls:20,vars:14,consts:[[3,"pageTitleName","description"],[1,"newItemName"],[1,"btn","btn-primary",3,"click"],[1,"icon","ni","ni-plus"],[1,"row","gy-2","gx-3","mb-4","align-items-center"],[1,"col-auto"],[1,"form-control-wrap"],[1,"form-icon","form-icon-right"],[1,"icon","ni","ni-search"],["type","text","id","default-04","placeholder"," Search here",1,"form-control",3,"ngModel","ngModelChange"],["type","button","title","",1,"btn","btn-dim","btn-primary",3,"click"],["responsiveLayout","scroll","sortMode","multiple","responsiveLayout","scroll","styleClass","p-datatable-sm p-datatable-striped","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","scrollDirection","both",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","resizableColumns","autoLayout"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["otherFieldName","",3,"fullName"],[1,"fw-lighter"],[1,"d-block"],[1,"text-primary"],[1,"align-center","select-cursor",3,"click"],[1,"user-avatar","user-avatar-sm","bg-light"],[1,"icon","ni","ni-edit"]],template:function(s,e){s&1&&(t(0,"app-add-item",0)(1,"span",1)(2,"a",2),f("click",function(){return e.openRegionModalComponent(null,!0)}),p(3,"em",3),t(4,"span"),l(5,"Add region"),n()()()(),t(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),p(10,"em",8),n(),t(11,"input",9),f("ngModelChange",function(y){return e.searchedKeyword=y}),n()()(),t(12,"div",5)(13,"button",10),f("click",function(){return e.refreshButton()}),l(14," Refresh "),n()()(),t(15,"p-table",11,12),c(17,"filter"),S(18,Ke,13,0,"ng-template",13)(19,Xe,36,31,"ng-template",14),n()),s&2&&(m("pageTitleName","Region setup")("description","Setup state housing regions"),r(11),m("ngModel",e.searchedKeyword),r(4),m("value",T(17,10,e.listOfRegions,e.searchedKeyword))("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",Z(13,Ye))("resizableColumns",!0)("autoLayout",!0))},dependencies:[E,X,A,Y,fe,ue,ge,O,te,D,ne,ce,he,be,Ce,Fe,Re],encapsulation:2});let o=d;return o})();export{yt as RegionsComponent};
