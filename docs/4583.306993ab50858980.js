"use strict";(self.webpackChunkadvantageweb=self.webpackChunkadvantageweb||[]).push([[4583],{2187:(q,A,l)=>{l.d(A,{c:()=>g});var h=l(6814),e=l(1054),d=l(2868),a=l(5879);function p(m,f){if(1&m&&(a.TgZ(0,"div"),a.ALo(1,"avatarBg"),a.TgZ(2,"span"),a._uU(3),a.ALo(4,"avatarName"),a.qZA()()),2&m){const Z=a.oxw();a.Gre("user-avatar  d-none d-sm-flex ",a.lcZ(1,4,""),""),a.xp6(3),a.hij("",a.lcZ(4,6,Z.fullName)," ")}}function c(m,f){if(1&m&&(a.TgZ(0,"span"),a._UZ(1,"br"),a.TgZ(2,"span"),a._uU(3),a.qZA()()),2&m){const Z=a.oxw();a.xp6(3),a.Oqu(Z.otherFieldName)}}let g=(()=>{var m;class f{constructor(){this.showAvatar=!0}ngOnInit(){}}return(m=f).\u0275fac=function(v){return new(v||m)},m.\u0275cmp=a.Xpm({type:m,selectors:[["app-full-name"]],inputs:{fullName:"fullName",otherFieldName:"otherFieldName",showAvatar:"showAvatar"},standalone:!0,features:[a.jDz],decls:7,vars:3,consts:[[1,"user-card"],[3,"class",4,"ngIf"],[1,"user-info"],[1,"text-black"],[1,"dot","dot-success","d-md-none","ms-1"],[4,"ngIf"]],template:function(v,S){1&v&&(a.TgZ(0,"div",0),a.YNc(1,p,5,8,"div",1),a.TgZ(2,"div",2)(3,"span",3),a._uU(4),a._UZ(5,"span",4),a.qZA(),a.YNc(6,c,4,1,"span",5),a.qZA()()),2&v&&(a.xp6(1),a.Q6J("ngIf",S.showAvatar),a.xp6(3),a.hij(" ",S.fullName," "),a.xp6(2),a.Q6J("ngIf",S.otherFieldName))},dependencies:[h.ez,h.O5,e.b,d.M],encapsulation:2}),f})()},1054:(q,A,l)=>{l.d(A,{b:()=>e});var h=l(5879);let e=(()=>{var d;class a{transform(c){const g=["bg-info-dim","bg-warning-dim","bg-primary-dim","bg-success-dim","bg-danger-dim","bg-purple-dim","bg-indigo-dim"];return g[Math.floor(Math.random()*g.length)]}}return(d=a).\u0275fac=function(c){return new(c||d)},d.\u0275pipe=h.Yjl({name:"avatarBg",type:d,pure:!0,standalone:!0}),a})()},2868:(q,A,l)=>{l.d(A,{M:()=>e});var h=l(5879);let e=(()=>{var d;class a{transform(c){if(!c)return"NF";const g=c.split(" ");let m=g[0],f=g[1];return f?(m.charAt(0)+""+f.charAt(0)).toUpperCase():m.slice(0,2).toUpperCase()}}return(d=a).\u0275fac=function(c){return new(c||d)},d.\u0275pipe=h.Yjl({name:"avatarName",type:d,pure:!0,standalone:!0}),a})()},4874:(q,A,l)=>{l.d(A,{i:()=>e});var h=l(5879);let e=(()=>{var d;class a{transform(c){return c.trim().split("_").map(m=>m.trim()).join(" ")}}return(d=a).\u0275fac=function(c){return new(c||d)},d.\u0275pipe=h.Yjl({name:"removeHyphen",type:d,pure:!0,standalone:!0}),a})()},1085:(q,A,l)=>{l.d(A,{e:()=>e});var h=l(5879);let e=(()=>{var d;class a{constructor(c,g){this.changeDetectorRef=c,this.ngZone=g,this.timer=null}transform(c){this.removeTimer();let g=new Date(c),f=Math.round(Math.abs(((new Date).getTime()-g.getTime())/1e3)),Z=Number.isNaN(f)?1e3:1e3*this.getSecondsUntilUpdate(f);this.timer=this.ngZone.runOutsideAngular(()=>typeof window<"u"?window.setTimeout(()=>{this.ngZone.run(()=>this.changeDetectorRef.markForCheck())},Z):null);let v=Math.round(Math.abs(f/60)),S=Math.round(Math.abs(v/60)),C=Math.round(Math.abs(S/24)),O=Math.round(Math.abs(C/30.416)),_=Math.round(Math.abs(C/365));return Number.isNaN(f)?"":f<=45?"a few seconds ago":f<=90?"a minute ago":v<=45?v+" minutes ago":v<=90?"an hour ago":S<=22?S+" hours ago":S<=36?"a day ago":C<=25?C+" days ago":C<=45?"a month ago":C<=345?O+" months ago":C<=545?"a year ago":_+" years ago"}ngOnDestroy(){this.removeTimer()}removeTimer(){this.timer&&(window.clearTimeout(this.timer),this.timer=null)}getSecondsUntilUpdate(c){return c<60?2:c<3600?30:c<86400?300:3600}}return(d=a).\u0275fac=function(c){return new(c||d)(h.Y36(h.sBO,16),h.Y36(h.R0b,16))},d.\u0275pipe=h.Yjl({name:"timeAgo",type:d,pure:!1,standalone:!0}),a})()},4583:(q,A,l)=>{l.r(A),l.d(A,{StaffListComponent:()=>$e});var h=l(5861),e=l(5879),d=l(6814),a=l(95),p=l(6842),c=l(7236),g=l(1392),m=l(2458),f=l(995),Z=l(4981),v=l(7177),S=l(5176),C=l(8624),O=l(3519),_=l.n(O),B=l(4782),L=l(1449),P=l(2735),D=l(1693),K=l(3221),M=l(731),F=l(4740),x=l(6593);function $(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function j(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}const b=function(s){return{"is-invalid":s}};function z(s,i){if(1&s&&(e.TgZ(0,"li")(1,"div",37),e._UZ(2,"input",38),e.TgZ(3,"label",39),e._uU(4),e.qZA()()()),2&s){const n=i.$implicit,o=e.oxw(2);e.xp6(2),e.s9C("value",n.dataValue),e.Q6J("id",n.dataValue)("ngClass",e.VKq(5,b,((null==o.staffForm.gender?null:o.staffForm.gender.touched)||(null==o.staffForm.gender?null:o.staffForm.gender.dirty)||o.submitted)&&(null==o.staffForm.gender?null:o.staffForm.gender.errors))),e.xp6(1),e.s9C("for",n.dataValue),e.xp6(1),e.Oqu(n.dataLabel)}}function H(s,i){if(1&s&&(e.TgZ(0,"ul",17),e.YNc(1,z,5,7,"li",18),e.qZA()),2&s){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.listOfGenders)}}function W(s,i){if(1&s&&(e.TgZ(0,"li")(1,"div",40),e._UZ(2,"input",41),e.TgZ(3,"label",39),e._uU(4),e.qZA()()()),2&s){const n=i.$implicit,o=e.oxw();e.xp6(2),e.s9C("value",n.dataValue),e.Q6J("id",n.dataValue)("ngClass",e.VKq(5,b,((null==o.staffForm.gender?null:o.staffForm.gender.touched)||(null==o.staffForm.gender?null:o.staffForm.gender.dirty)||o.submitted)&&(null==o.staffForm.gender?null:o.staffForm.gender.errors))),e.xp6(1),e.s9C("for",n.dataValue),e.xp6(1),e.Oqu(n.dataLabel)}}function X(s,i){1&s&&(e.TgZ(0,"div",42),e._UZ(1,"app-required-field"),e.qZA())}function ee(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function te(s,i){1&s&&(e.TgZ(0,"div"),e._uU(1," * Invalid mobile number (must be between 10 and 12 digits) "),e.qZA())}function oe(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function se(s,i){1&s&&(e.TgZ(0,"div"),e._uU(1," Invalid email "),e.qZA())}function ne(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function ae(s,i){if(1&s&&(e.TgZ(0,"div",8),e._UZ(1,"app-form-label",9),e.TgZ(2,"div",10),e._UZ(3,"input",43),e.TgZ(4,"span",12),e.YNc(5,ne,2,0,"div",13),e.qZA()()()),2&s){const n=e.oxw();e.xp6(1),e.Q6J("labelForName","dob")("labelName","Date Of Birth"),e.xp6(2),e.Q6J("ngClass",e.VKq(4,b,((null==n.staffForm.dob?null:n.staffForm.dob.touched)||(null==n.staffForm.dob?null:n.staffForm.dob.dirty)||n.submitted)&&!(null!=n.staffForm.dob&&n.staffForm.dob.valid))),e.xp6(2),e.Q6J("ngIf",null==n.staffForm.dob||null==n.staffForm.dob.errors?null:n.staffForm.dob.errors.required)}}function re(s,i){1&s&&(e.TgZ(0,"span"),e._UZ(1,"app-required-field"),e.qZA())}function ie(s,i){if(1&s&&(e.TgZ(0,"ng-option",44),e._uU(1),e.qZA()),2&s){const n=i.$implicit;e.Q6J("value",n.recordId),e.xp6(1),e.hij(" ",n.regionName," ")}}function le(s,i){1&s&&(e.TgZ(0,"span"),e._UZ(1,"app-required-field"),e.qZA())}function ue(s,i){if(1&s&&(e.TgZ(0,"ng-option",44),e._uU(1),e.qZA()),2&s){const n=i.$implicit;e.Q6J("value",n.recordId),e.xp6(1),e.hij(" ",n.departmentName," ")}}function de(s,i){1&s&&(e.TgZ(0,"span"),e._UZ(1,"app-required-field"),e.qZA())}function fe(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function ce(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function me(s,i){1&s&&(e.ynx(0),e.TgZ(1,"div",45),e._UZ(2,"input",46),e.TgZ(3,"label",47),e._uU(4," Save & create new staff "),e.qZA()(),e.BQk())}function pe(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"div",34)(1,"button",48),e.NdJ("click",function(){e.CHM(n);const t=e.oxw();return e.KtG(t.updateStaff())}),e._uU(2," Update "),e.qZA()()}if(2&s){const n=e.oxw();e.xp6(1),e.Q6J("title",n.staffFormGroup.invalid?"There must be errors on the form":"")}}function ge(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"div",34)(1,"button",48),e.NdJ("click",function(){e.CHM(n);const t=e.oxw();return e.KtG(t.saveStaff())}),e._uU(2," Save "),e.qZA()()}if(2&s){const n=e.oxw();e.xp6(1),e.Q6J("title",n.staffFormGroup.invalid?"There must be errors on the form":"")}}const he=function(s){return{"is-valid":s}},_e=function(s){return{"is-invalid ":s}};let ve=(()=>{var s;class i{constructor(o,t,r,u,N,y){this.title=o,this.addStaffBsModalRef=t,this.fb=r,this.accountService=u,this.alertService=N,this.logger=y,this.currentStep=1,this.submitted=!1,this.settingsService=(0,e.f3M)(L.g),this.userAccountService=(0,e.f3M)(M.N),this.router=(0,e.f3M)(B.F0),this.accountService.currentUser.subscribe(J=>this.currentUser=J)}ngOnInit(){if(this.currentStep=1,this.createStaffForm(),this.isAddMode)this.headerMsg="New staff",this.title.setTitle(this.headerMsg);else if(this.headerMsg="Edit "+this.staff.fullName,this.title.setTitle(this.headerMsg),this.staffFormGroup.patchValue(this.staff),this.staff.dob){let o=this.staff.dob.toString().replace("[UTC]","");this.staffForm.dob.setValue(new Date(o))}this.addStaffBsModalRef.setClass("gray modal-lg modal-dialog-top"),this.listOfGenders=this.settingsService.getGender(),this.listOfUserRoles=this.settingsService.getUserRoles(),this.listOfStatus=this.settingsService.getStatus(),this.fetchRegions(),this.fetchDepartments()}createStaffForm(){this.staffFormGroup=this.fb.group({firstName:["",{updateOn:"blur",validators:[a.kI.required]}],lastName:["",{updateOn:"blur",validators:[a.kI.required]}],gender:["",[a.kI.required]],mobileNo:["",{updateOn:"blur",validators:[a.kI.required,a.kI.minLength(10)]}],email:["",{updateOn:"blur",validators:[a.kI.required,a.kI.email]}],address:["",{updateOn:"blur",validators:[a.kI.required]}],dob:["",{updateOn:"blur",validators:[a.kI.required]}],regionId:["",[a.kI.required]],departmentId:["",[a.kI.required]],officeContactNo:["",[a.kI.required,a.kI.minLength(10)]],saveAndNew:[!1],recordId:[""]})}get staffForm(){return this.staffFormGroup.controls}fetchRegions(){this.listOfRegions=[],this.settingsService.getRegions().subscribe({next:o=>{if(this.logger.info("getRegions response "+JSON.stringify(o)),"000"===o.headerResponse.responseCode)return o.regions.length<=0?(this.alertService.showInfoMsgGeneral("No regions found"),void this.logger.info("No regions found")):void(this.listOfRegions=o.regions);this.alertService.error(o.headerResponse.responseMessage)},error:o=>{this.logger.error(o),this.alertService.showInfoMsg(o)}})}fetchDepartments(){this.listOfDepartments=[],this.userAccountService.getDepartments().subscribe({next:o=>{if(this.logger.info("getDepartments response "+JSON.stringify(o)),"000"===o.headerResponse.responseCode)return o.departments.length<=0?(this.alertService.showInfoMsgGeneral("No departments found"),void this.logger.info("No departments found")):void(this.listOfDepartments=o.departments);this.alertService.error(o.headerResponse.responseMessage)},error:o=>{this.logger.error(o),this.alertService.showInfoMsg(o)}})}saveStaff(){if(this.submitted=!0,this.staffFormGroup.invalid)return;let o=this.staffForm.firstName.value;_().fire({title:"Confirmation",text:`Do you want to create occupant  ${o}?`,icon:"question",position:"top",showCancelButton:!0,confirmButtonText:"Yes, create",cancelButtonText:"No, cancel"}).then(t=>{if(t.value){if(this.alertService.clear(),this.staffFormGroup.invalid)return;this.userAccountService.createStaff(this.currentUser,this.staffFormGroup.value).subscribe({next:r=>{"000"===r.headerResponse.responseCode?(this.alertService.showSuccessMsg(`${o} created successfully`),this.staffForm.saveAndNew.value||(this.addStaffBsModalRef.hide(),this.accountService.reloadCurrentRoute()),this.staffFormGroup.reset(),this.submitted=!1,this.logAction(`created institution occupant ${o}`,f.h.OCCUPANCY)):this.alertService.showErrorMsg(r.headerResponse.responseMessage)},error:r=>{this.alertService.showInfoMsg(r.message)}})}else _()})}updateStaff(){if(this.submitted=!0,this.staffFormGroup.invalid)return;let o=this.staffForm.firstName.value;_().fire({position:"top",title:"Confirmation",text:`Do you want to update ${o}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, update"}).then(t=>{t.value?this.userAccountService.updateStaff(this.currentUser,this.staffFormGroup.value).subscribe({next:r=>{this.logger.info("updateStaff response:"+JSON.stringify(r)),"000"===r.headerResponse.responseCode?(this.alertService.showSuccessMsg(`${o} updated successfully`),this.addStaffBsModalRef.hide(),this.logAction(`Updated ${o}`,f.h.OCCUPANCY),this.accountService.reloadCurrentRoute()):this.alertService.showErrorMsg(r.headerResponse.responseMessage)},error:r=>{this.alertService.showInfoMsg(r.message)}}):_()})}logAction(o,t){var r=this;return(0,h.Z)(function*(){yield r.accountService.logUserAudit(o,t)})()}}return(s=i).\u0275fac=function(o){return new(o||s)(e.Y36(x.Dx),e.Y36(p.UZ),e.Y36(a.qu),e.Y36(v.e),e.Y36(Z.c),e.Y36(c.Kf))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],standalone:!0,features:[e.jDz],decls:100,vars:77,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["novalidate","",3,"formGroup"],[1,"row","gy-4","mt-1"],[1,"col-sm-6"],[1,"form-group"],[3,"labelForName","labelName"],[1,"form-control-wrap"],["type","text","formControlName","firstName","id","firstName","autocomplete","off",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],[4,"ngIf"],["type","text","formControlName","lastName","id","lastName","autocomplete","off",1,"form-control",3,"ngClass"],[1,"form-check-label",3,"labelForName","labelName"],["class","custom-control-group",4,"ngIf"],[1,"custom-control-group"],[4,"ngFor","ngForOf"],["class","text-danger mt-1",4,"ngIf"],["type","tel","formControlName","mobileNo","id","mobileNo","autocomplete","off",1,"form-control",3,"ngClass"],["type","email","formControlName","email","id","email","autocomplete","off",1,"form-control",3,"ngClass"],["class","form-group",4,"ngIf"],["styleClass","w-100","formControlName","dob","id","dob","dateFormat","dd-mm-yy",3,"showIcon","ngClass"],["id","regionId","formControlName","regionId",3,"clearable","ngClass"],["value","","disabled","","selected","",1,"fs-6"],[3,"value",4,"ngFor","ngForOf"],["id","departmentId","formControlName","departmentId",3,"clearable","ngClass"],["value","","selected","",1,"fs-6"],["type","tel","formControlName","officeContactNo","id","officeContactNo","autocomplete","off",1,"form-control",3,"ngClass"],["type","text","formControlName","address","id","address","autocomplete","off",1,"form-control",2,"min-height","30px",3,"ngClass"],[1,"row","mt-3"],[1,"col-sm-12"],[1,"row","gx-3","justify-content-end","mt-5"],[1,"col-auto"],["type","button","title","",1,"btn","btn-outline-lighter",3,"click"],["class","col-auto",4,"ngIf"],[1,"custom-control","custom-radio"],["type","radio","formControlName","gender","name","gender",1,"custom-control-input","form-check-input",3,"id","value","ngClass"],[1,"custom-control-label","form-check-label",3,"for"],[1,"custom-control","custom-radio","custom-control-pro","no-control"],["formControlName","gender","name","gender","type","radio",1,"custom-control-input","form-check-input",3,"id","value","ngClass"],[1,"text-danger","mt-1"],["type","date","formControlName","dob","id","dob","autocomplete","off",1,"form-control",3,"ngClass"],[3,"value"],[1,"custom-control","custom-control-sm","custom-checkbox","checked"],["type","checkbox","formControlName","saveAndNew","id","saveAndNew",1,"custom-control-input"],["for","saveAndNew",1,"custom-control-label","fw-bolder"],[1,"btn","btn-primary",3,"title","click"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"h6",1),e._uU(2),e.ALo(3,"titlecase"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return null==t.addStaffBsModalRef?null:t.addStaffBsModalRef.hide()}),e.TgZ(5,"span",3),e._uU(6,"\xd7"),e.qZA()()(),e.TgZ(7,"div",4),e._UZ(8,"app-required-fields-notice"),e.TgZ(9,"form",5)(10,"div",6)(11,"div",7)(12,"div",8),e._UZ(13,"app-form-label",9),e.TgZ(14,"div",10),e._UZ(15,"input",11),e.TgZ(16,"span",12),e.YNc(17,$,2,0,"div",13),e.qZA()()()(),e.TgZ(18,"div",7)(19,"div",8),e._UZ(20,"app-form-label",9),e.TgZ(21,"div",10),e._UZ(22,"input",14),e.TgZ(23,"span",12),e.YNc(24,j,2,0,"div",13),e.qZA()()()(),e.TgZ(25,"div",7)(26,"div",8),e._UZ(27,"app-form-label",15),e.TgZ(28,"div",10),e.YNc(29,H,2,1,"ul",16),e.TgZ(30,"ul",17),e.YNc(31,W,5,7,"li",18),e.qZA(),e.YNc(32,X,2,0,"div",19),e.qZA()()(),e.TgZ(33,"div",7)(34,"div",8),e._UZ(35,"app-form-label",9),e.TgZ(36,"div",10),e._UZ(37,"input",20),e.TgZ(38,"span",12),e.YNc(39,ee,2,0,"div",13),e.YNc(40,te,2,0,"div",13),e.qZA()()()(),e.TgZ(41,"div",7)(42,"div",8),e._UZ(43,"app-form-label",9),e.TgZ(44,"div",10),e._UZ(45,"input",21),e.TgZ(46,"span",12),e.YNc(47,oe,2,0,"div",13),e.YNc(48,se,2,0,"div",13),e.qZA()()()(),e.TgZ(49,"div",7),e.YNc(50,ae,6,6,"div",22),e.TgZ(51,"div",8),e._UZ(52,"app-form-label",9)(53,"p-calendar",23),e.TgZ(54,"span",12),e.YNc(55,re,2,0,"span",13),e.qZA()()(),e.TgZ(56,"div",7)(57,"div",8),e._UZ(58,"app-form-label",9),e.TgZ(59,"div",10)(60,"ng-select",24)(61,"ng-option",25),e._uU(62,"Select One"),e.qZA(),e.YNc(63,ie,2,2,"ng-option",26),e.qZA(),e.TgZ(64,"span",12),e.YNc(65,le,2,0,"span",13),e.qZA()()()(),e.TgZ(66,"div",7)(67,"div",8),e._UZ(68,"app-form-label",9),e.TgZ(69,"div",10)(70,"ng-select",27)(71,"ng-option",28),e._uU(72,"Select One"),e.qZA(),e.YNc(73,ue,2,2,"ng-option",26),e.qZA(),e.TgZ(74,"span",12),e.YNc(75,de,2,0,"span",13),e.qZA()()()(),e.TgZ(76,"div",7)(77,"div",8),e._UZ(78,"app-form-label",9),e.TgZ(79,"div",10),e._UZ(80,"input",29),e.TgZ(81,"span",12),e.YNc(82,fe,2,0,"div",13),e.qZA()()()(),e.TgZ(83,"div",7)(84,"div",8),e._UZ(85,"app-form-label",9),e.TgZ(86,"div",10)(87,"textarea",30),e._uU(88,"                        "),e.qZA(),e.TgZ(89,"span",12),e.YNc(90,ce,2,0,"div",13),e.qZA()()()()(),e.TgZ(91,"div",31)(92,"div",32),e.YNc(93,me,5,0,"ng-container",13),e.qZA()(),e.TgZ(94,"div",33)(95,"div",34)(96,"button",35),e.NdJ("click",function(){return null==t.addStaffBsModalRef?null:t.addStaffBsModalRef.hide()}),e._uU(97," Close "),e.qZA()(),e.YNc(98,pe,3,1,"div",36),e.YNc(99,ge,3,1,"div",36),e.qZA()()()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,55,t.headerMsg)),e.xp6(7),e.Q6J("formGroup",t.staffFormGroup),e.xp6(4),e.Q6J("labelForName","firstName")("labelName","First Name"),e.xp6(2),e.Q6J("ngClass",e.VKq(57,b,((null==t.staffForm.firstName?null:t.staffForm.firstName.touched)||(null==t.staffForm.firstName?null:t.staffForm.firstName.dirty)||t.submitted)&&!(null!=t.staffForm.firstName&&t.staffForm.firstName.valid))),e.xp6(2),e.Q6J("ngIf",null==t.staffForm.firstName||null==t.staffForm.firstName.errors?null:t.staffForm.firstName.errors.required),e.xp6(3),e.Q6J("labelForName","lastName")("labelName","Last Name"),e.xp6(2),e.Q6J("ngClass",e.VKq(59,b,((null==t.staffForm.lastName?null:t.staffForm.lastName.touched)||(null==t.staffForm.lastName?null:t.staffForm.lastName.dirty)||t.submitted)&&!(null!=t.staffForm.lastName&&t.staffForm.lastName.valid))),e.xp6(2),e.Q6J("ngIf",null==t.staffForm.lastName||null==t.staffForm.lastName.errors?null:t.staffForm.lastName.errors.required),e.xp6(3),e.Q6J("labelForName","gender")("labelName","Gender"),e.xp6(2),e.Q6J("ngIf",!1),e.xp6(2),e.Q6J("ngForOf",t.listOfGenders),e.xp6(1),e.Q6J("ngIf",t.submitted&&(null==t.staffForm.gender.errors?null:t.staffForm.gender.errors.required)),e.xp6(3),e.Q6J("labelForName","mobileNo")("labelName","Contact Number"),e.xp6(2),e.Q6J("ngClass",e.VKq(61,he,null==t.staffForm.lastName?null:t.staffForm.lastName.valid))("ngClass",e.VKq(63,b,((null==t.staffForm.mobileNo?null:t.staffForm.mobileNo.touched)||(null==t.staffForm.mobileNo?null:t.staffForm.mobileNo.dirty)||t.submitted)&&!(null!=t.staffForm.mobileNo&&t.staffForm.mobileNo.valid))),e.xp6(2),e.Q6J("ngIf",null==t.staffForm.mobileNo||null==t.staffForm.mobileNo.errors?null:t.staffForm.mobileNo.errors.required),e.xp6(1),e.Q6J("ngIf",(null==t.staffForm.mobileNo||null==t.staffForm.mobileNo.errors?null:t.staffForm.mobileNo.errors.minlength)||(null==t.staffForm.mobileNo||null==t.staffForm.mobileNo.errors?null:t.staffForm.mobileNo.errors.maxlength)),e.xp6(3),e.Q6J("labelForName","email")("labelName","Email"),e.xp6(2),e.Q6J("ngClass",e.VKq(65,b,((null==t.staffForm.email?null:t.staffForm.email.touched)||(null==t.staffForm.email?null:t.staffForm.email.dirty)||t.submitted)&&!(null!=t.staffForm.email&&t.staffForm.email.valid))),e.xp6(2),e.Q6J("ngIf",null==t.staffForm.email||null==t.staffForm.email.errors?null:t.staffForm.email.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.staffForm.email||null==t.staffForm.email.errors?null:t.staffForm.email.errors.email),e.xp6(2),e.Q6J("ngIf",!1),e.xp6(2),e.Q6J("labelForName","dob")("labelName","Date Of Birth"),e.xp6(1),e.Q6J("showIcon",!0)("ngClass",e.VKq(67,b,((null==t.staffForm.dob?null:t.staffForm.dob.touched)||(null==t.staffForm.dob?null:t.staffForm.dob.dirty)||t.submitted)&&!(null!=t.staffForm.dob&&t.staffForm.dob.valid))),e.xp6(2),e.Q6J("ngIf",null==t.staffForm.dob||null==t.staffForm.dob.errors?null:t.staffForm.dob.errors.required),e.xp6(3),e.Q6J("labelForName","regionId")("labelName","Region"),e.xp6(2),e.Q6J("clearable",!1)("ngClass",e.VKq(69,_e,((null==t.staffForm.regionId?null:t.staffForm.regionId.touched)||(null==t.staffForm.regionId?null:t.staffForm.regionId.dirty)||t.submitted)&&(null==t.staffForm.regionId?null:t.staffForm.regionId.errors))),e.xp6(3),e.Q6J("ngForOf",t.listOfRegions),e.xp6(2),e.Q6J("ngIf",null==t.staffForm.regionId||null==t.staffForm.regionId.errors?null:t.staffForm.regionId.errors.required),e.xp6(3),e.Q6J("labelForName","departmentId")("labelName","Department"),e.xp6(2),e.Q6J("clearable",!1)("ngClass",e.VKq(71,b,((null==t.staffForm.departmentId?null:t.staffForm.departmentId.touched)||(null==t.staffForm.departmentId?null:t.staffForm.departmentId.dirty)||t.submitted)&&(null==t.staffForm.departmentId?null:t.staffForm.departmentId.errors))),e.xp6(3),e.Q6J("ngForOf",t.listOfDepartments),e.xp6(2),e.Q6J("ngIf",null==t.staffForm.departmentId||null==t.staffForm.departmentId.errors?null:t.staffForm.departmentId.errors.required),e.xp6(3),e.Q6J("labelForName","officeContactNo")("labelName","Office Contact Number"),e.xp6(2),e.Q6J("ngClass",e.VKq(73,b,((null==t.staffForm.officeContactNo?null:t.staffForm.officeContactNo.touched)||(null==t.staffForm.officeContactNo?null:t.staffForm.officeContactNo.dirty)||t.submitted)&&!(null!=t.staffForm.officeContactNo&&t.staffForm.officeContactNo.valid))),e.xp6(2),e.Q6J("ngIf",null==t.staffForm.officeContactNo||null==t.staffForm.officeContactNo.errors?null:t.staffForm.officeContactNo.errors.required),e.xp6(3),e.Q6J("labelForName","address")("labelName","Address"),e.xp6(2),e.Q6J("ngClass",e.VKq(75,b,((null==t.staffForm.address?null:t.staffForm.address.touched)||(null==t.staffForm.address?null:t.staffForm.address.dirty)||t.submitted)&&!(null!=t.staffForm.address&&t.staffForm.address.valid))),e.xp6(3),e.Q6J("ngIf",null==t.staffForm.address||null==t.staffForm.address.errors?null:t.staffForm.address.errors.required),e.xp6(3),e.Q6J("ngIf",t.isAddMode),e.xp6(5),e.Q6J("ngIf",!t.isAddMode),e.xp6(1),e.Q6J("ngIf",t.isAddMode))},dependencies:[d.ez,d.mk,d.sg,d.O5,d.rS,a.UX,a._Y,a.Fj,a.Wl,a._,a.JJ,a.JL,a.sg,a.u,K.z,a.u5,P.h,D.M,g._8,g.f,F.A0,F.w9,F.jq],encapsulation:2}),i})();var k=l(2187),Y=l(1085);let Ze=(()=>{var s;class i{constructor(o,t){this.viewStaffBsModalRef=o,this.accountService=t,this.accountService.currentUser.subscribe(r=>this.currentUser=r)}ngOnInit(){this.viewStaffBsModalRef.setClass("gray modal-md modal-dialog-top")}}return(s=i).\u0275fac=function(o){return new(o||s)(e.Y36(p.UZ),e.Y36(v.e))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],standalone:!0,features:[e.jDz],decls:153,vars:50,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[1,"card","card-no-border"],[1,"pricing-body"],[1,"pricing-features"],[1,"preview-title-lg","overline-title"],[1,"w-50","text-black-50"],[1,"ms-auto"],[1,"preview-title-lg","overline-title","mt-2"],[1,"row","my-3","mx-2","mb-3","justify-content-end"],[1,"col-auto"],[1,"btn","btn-sm","btn-primary",3,"click"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"h6",1),e._uU(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return null==t.viewStaffBsModalRef?null:t.viewStaffBsModalRef.hide()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"ul",7)(10,"span",8),e._uU(11,"Personal Information"),e.qZA(),e.TgZ(12,"li")(13,"span",9),e._uU(14,"Full Name"),e.qZA(),e._uU(15," - "),e.TgZ(16,"span",10),e._uU(17),e.qZA()(),e.TgZ(18,"li")(19,"span",9),e._uU(20,"Gender"),e.qZA(),e._uU(21," - "),e.TgZ(22,"span",10),e._uU(23),e.ALo(24,"titlecase"),e.qZA()(),e.TgZ(25,"li")(26,"span",9),e._uU(27,"Date Of Birth"),e.qZA(),e._uU(28," - "),e.TgZ(29,"span",10),e._uU(30),e.ALo(31,"date"),e.TgZ(32,"small"),e._uU(33),e.ALo(34,"timeAgo"),e.qZA()()(),e.TgZ(35,"li")(36,"span",9),e._uU(37,"Mobile Number"),e.qZA(),e._uU(38," - "),e.TgZ(39,"span",10),e._uU(40),e.qZA()(),e.TgZ(41,"li")(42,"span",9),e._uU(43,"Office Contact Number"),e.qZA(),e._uU(44," - "),e.TgZ(45,"span",10),e._uU(46),e.qZA()(),e.TgZ(47,"li")(48,"span",9),e._uU(49,"Address"),e.qZA(),e._uU(50," - "),e.TgZ(51,"span",10),e._uU(52),e.qZA()(),e.TgZ(53,"span",11),e._uU(54,"User Account "),e.qZA(),e.TgZ(55,"li")(56,"span",9),e._uU(57,"Username"),e.qZA(),e._uU(58," - "),e.TgZ(59,"span",10),e._uU(60),e.qZA()(),e.TgZ(61,"li")(62,"span",9),e._uU(63,"User Role"),e.qZA(),e._uU(64," - "),e.TgZ(65,"span",10),e._uU(66),e.ALo(67,"titlecase"),e.qZA()(),e.TgZ(68,"li")(69,"span",9),e._uU(70,"Region"),e.qZA(),e._uU(71," - "),e.TgZ(72,"span",10),e._uU(73),e.qZA()(),e.TgZ(74,"li")(75,"span",9),e._uU(76,"Department"),e.qZA(),e._uU(77," - "),e.TgZ(78,"span",10),e._uU(79),e.qZA()(),e.TgZ(80,"li")(81,"span",9),e._uU(82,"Account Created By"),e.qZA(),e._uU(83," - "),e.TgZ(84,"span",10),e._uU(85),e.qZA()(),e.TgZ(86,"li")(87,"span",9),e._uU(88,"Account Date"),e.qZA(),e._uU(89," - "),e.TgZ(90,"span",10),e._uU(91),e.ALo(92,"date"),e.TgZ(93,"small"),e._uU(94),e.ALo(95,"timeAgo"),e.qZA()()(),e.TgZ(96,"li")(97,"span",9),e._uU(98,"Account Status"),e.qZA(),e._uU(99," - "),e.TgZ(100,"span",10),e._uU(101),e.ALo(102,"titlecase"),e.qZA()(),e.TgZ(103,"span",11),e._uU(104,"User activities"),e.qZA(),e.TgZ(105,"li")(106,"span",9),e._uU(107,"Created By"),e.qZA(),e._uU(108," - "),e.TgZ(109,"span",10),e._uU(110),e.qZA()(),e.TgZ(111,"li")(112,"span",9),e._uU(113,"Created Date"),e.qZA(),e._uU(114," - "),e.TgZ(115,"span",10),e._uU(116),e.ALo(117,"date"),e.TgZ(118,"small"),e._uU(119),e.ALo(120,"timeAgo"),e.qZA()()(),e.TgZ(121,"li")(122,"small"),e._uU(123),e.ALo(124,"timeAgo"),e.qZA(),e.TgZ(125,"span",9),e._uU(126,"Last Modified By"),e.qZA(),e._uU(127," - "),e.TgZ(128,"span",10),e._uU(129),e.qZA()(),e.TgZ(130,"li")(131,"span",9),e._uU(132,"Modified Date"),e.qZA(),e._uU(133," - "),e.TgZ(134,"span",10),e._uU(135),e.ALo(136,"date"),e.qZA()(),e.TgZ(137,"li")(138,"span",9),e._uU(139,"Last Login Date"),e.qZA(),e._uU(140," - "),e.TgZ(141,"span",10),e._uU(142),e.ALo(143,"date"),e.TgZ(144,"small"),e._uU(145),e.ALo(146,"timeAgo"),e.qZA()()()(),e._UZ(147,"ul"),e.qZA()()(),e.TgZ(148,"div",12)(149,"div",13)(150,"a",14),e.NdJ("click",function(){return null==t.viewStaffBsModalRef?null:t.viewStaffBsModalRef.hide()}),e.TgZ(151,"span"),e._uU(152,"Close"),e.qZA()()()()),2&o&&(e.xp6(2),e.hij("",t.staff.fullName," Details"),e.xp6(15),e.Oqu(t.staff.fullName),e.xp6(6),e.Oqu(e.lcZ(24,24,t.staff.gender)),e.xp6(7),e.hij(" ",e.lcZ(31,26,t.staff.dob)," "),e.xp6(3),e.Oqu(e.lcZ(34,28,t.staff.dob.toString())),e.xp6(7),e.Oqu(t.staff.mobileNo),e.xp6(6),e.Oqu(t.staff.officeContactNo),e.xp6(6),e.Oqu(t.staff.address),e.xp6(8),e.Oqu(t.staff.username),e.xp6(6),e.Oqu(e.lcZ(67,30,t.staff.userRole)),e.xp6(7),e.Oqu(t.staff.regionName),e.xp6(6),e.Oqu(t.staff.departmentName),e.xp6(6),e.Oqu(t.staff.accountCreatedBy),e.xp6(6),e.hij(" ",e.lcZ(92,32,t.staff.accountCreatedDate),", "),e.xp6(3),e.Oqu(e.lcZ(95,34,t.staff.accountCreatedDate)),e.xp6(7),e.Oqu(e.lcZ(102,36,t.staff.status)),e.xp6(9),e.Oqu(t.staff.createdBy),e.xp6(6),e.hij(" ",e.lcZ(117,38,t.staff.createdDate),", "),e.xp6(3),e.Oqu(e.lcZ(120,40,t.staff.createdDate.toString())),e.xp6(4),e.Oqu(e.lcZ(124,42,t.staff.createdDate.toString())),e.xp6(6),e.Oqu(t.staff.createdBy),e.xp6(6),e.hij("",e.lcZ(136,44,t.staff.lastModifiedDate)," "),e.xp6(7),e.hij("",e.lcZ(143,46,t.staff.lastLoginDate)," "),e.xp6(3),e.Oqu(e.lcZ(146,48,t.staff.lastLoginDate)))},dependencies:[d.ez,d.rS,d.uU,Y.e],encapsulation:2}),i})();var R=l(7467),I=l(9917);function Ae(s,i){1&s&&(e.TgZ(0,"div",3),e._uU(1,"Copied"),e.qZA())}let G=(()=>{var s;class i{constructor(){this.message="",this.showNotification=!1,this.labelName="",document.addEventListener("copy",this.handleCopyEvent.bind(this))}copyToClipboard(){const o=document.createElement("input");o.value=this.message,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}handleCopyEvent(o){const t=o.clipboardData||window.clipboardData;t&&(t.setData("text",this.message),o.preventDefault(),this.showNotification=!0,setTimeout(()=>{this.showNotification=!1},1e3))}}return(s=i).\u0275fac=function(o){return new(o||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-copy-button"]],inputs:{message:"message"},standalone:!0,features:[e.jDz],decls:3,vars:2,consts:[["class","text-primary",4,"ngIf"],["tooltip","Copy password",1,"btn","btn-outline-light","text-primary",3,"delay","click"],[1,"icon","ni","ni-copy"],[1,"text-primary"]],template:function(o,t){1&o&&(e.YNc(0,Ae,2,0,"div",0),e.TgZ(1,"button",1),e.NdJ("click",function(){return t.copyToClipboard()}),e._UZ(2,"em",2),e.qZA()),2&o&&(e.Q6J("ngIf",t.showNotification),e.xp6(1),e.Q6J("delay",500))},dependencies:[d.ez,d.O5,I.z8,I.i9],styles:[".notification[_ngcontent-%COMP%]{background-color:#f2f2f2;padding:10px;border:1px solid #ccc;border-radius:4px}"]}),i})();var U=l(5178),T=l(553),Te=l(5109),be=l(8397),Ne=l(9862);let Q=(()=>{var s;class i{constructor(o,t,r){this.utilsService=o,this.http=t,this.logger=r}createStaff(o,t){return t.headerRequest=this.utilsService.getRequestHeader(o.zoneId,o.regionId,"SAVE_STAFF"),t.createdBy=o.username,t.dob=t.dob,t.lastModifiedBy="NEW_STAFF",this.logger.info("create staff request "+JSON.stringify(t)),this.http.post(`${T.N.url+f.h.API_USER_ACCOUNTS}createstaff`,t).pipe((0,U.V)(T.N.timeout))}updateStaff(o,t){return t.headerRequest=this.utilsService.getRequestHeader(o.zoneId,o.regionId,"UPDATE_STAFF"),t.lastModifiedBy=o.username,this.logger.info("update staff request "+JSON.stringify(t)),this.http.post(`${T.N.url+f.h.API_USER_ACCOUNTS}updatestaff`,t).pipe((0,U.V)(T.N.timeout))}deleteStaff(o,t){let r=new Te.V;return r.recordId=t,r.deletedBy=o.username,r.headerRequest=this.utilsService.getRequestHeader(o.zoneId,o.regionId,"DELETE_STAFF"),this.logger.info("delete staff request "+JSON.stringify(r)),this.http.post(`${T.N.url+f.h.API_USER_ACCOUNTS}deletestaff`,r).pipe((0,U.V)(T.N.timeout))}searchStaffs(o,t,r){const u=new be.w;return u.searchBy=t,u.searchValue=r,u.headerRequest=this.utilsService.getRequestHeader(o.zoneId,o.regionId,"STAFFS_LIST"),this.logger.info("searchStaffs request "+JSON.stringify(u)),this.http.post(`${T.N.url+f.h.API_USER_ACCOUNTS}staffs`,u).pipe((0,U.V)(T.N.timeout))}createLoginAccount(o,t){return t.headerRequest=this.utilsService.getRequestHeader(o.zoneId,o.regionId,"CREATE_ACCOUNT"),t.createdBy=o.username,this.logger.info("create staff request "+JSON.stringify(t)),this.http.post(`${T.N.url+f.h.API_USER_ACCOUNTS}createaccount`,t).pipe((0,U.V)(T.N.timeout))}resetPassword(o,t){return t.headerRequest=this.utilsService.getRequestHeader(o.zoneId,o.regionId,"RESET_PASSWORD"),t.createdBy=o.username,this.logger.info("reset staff password request "+JSON.stringify(t)),this.http.post(`${T.N.url+f.h.API_USER_ACCOUNTS}adminresetpassword`,t).pipe((0,U.V)(T.N.timeout))}}return(s=i).\u0275fac=function(o){return new(o||s)(e.LFG(R.F),e.LFG(Ne.eN),e.LFG(c.Kf))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),i})();function Se(s,i){if(1&s&&(e.TgZ(0,"div",33)(1,"div",34)(2,"div",35),e._UZ(3,"app-full-name",36),e.qZA()()()),2&s){const n=e.oxw();e.xp6(3),e.hYB("fullName","",null==n.staff?null:n.staff.fullName," (",n.staff.username,")"),e.s9C("otherFieldName",null==n.staff?null:n.staff.email)}}function Ce(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}function Fe(s,i){if(1&s&&(e.TgZ(0,"ng-option",37),e._uU(1),e.qZA()),2&s){const n=i.$implicit;e.Q6J("value",n.dataValue),e.xp6(1),e.hij(" ",n.dataLabel," ")}}function Ue(s,i){1&s&&(e.TgZ(0,"span"),e._UZ(1,"app-required-field"),e.qZA())}const E=function(s){return{"is-invalid":s}};function we(s,i){if(1&s&&(e.TgZ(0,"li")(1,"div",38),e._UZ(2,"input",39),e.TgZ(3,"label",40),e._uU(4),e.qZA()()()),2&s){const n=i.$implicit,o=e.oxw();e.xp6(2),e.s9C("value",n.dataValue),e.Q6J("id",n.dataValue)("ngClass",e.VKq(5,E,((null==o.loginAccountForm.status?null:o.loginAccountForm.status.touched)||(null==o.loginAccountForm.status?null:o.loginAccountForm.status.dirty)||o.submitted)&&(null==o.loginAccountForm.status?null:o.loginAccountForm.status.errors))),e.xp6(1),e.s9C("for",n.dataValue),e.xp6(1),e.Oqu(n.dataLabel)}}function qe(s,i){1&s&&(e.TgZ(0,"div",41),e._UZ(1,"app-required-field"),e.qZA())}function ye(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"div",29)(1,"button",42),e.NdJ("click",function(){e.CHM(n);const t=e.oxw();return e.KtG(t.updateStaff())}),e._uU(2," Update "),e.qZA()()}if(2&s){const n=e.oxw();e.xp6(1),e.Q6J("title",n.loginAccountFormGroup.invalid?"There must be errors on the form":"")}}function Me(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"div",29)(1,"button",42),e.NdJ("click",function(){e.CHM(n);const t=e.oxw();return e.KtG(t.saveStaff())}),e._uU(2," Create "),e.qZA()()}if(2&s){const n=e.oxw();e.xp6(1),e.Q6J("title",n.loginAccountFormGroup.invalid?"There must be errors on the form":"")}}function Re(s,i){1&s&&(e.TgZ(0,"div",43),e._uU(1," Hello\n"),e.qZA())}const Ie=function(s){return{"is-valid":s}};let Je=(()=>{var s;class i{constructor(o,t,r,u){this.title=o,this.loginAccountBsModalRef=t,this.fb=r,this.logger=u,this.currentStep=1,this.submitted=!1,this.router=(0,e.f3M)(B.F0),this.settingsService=(0,e.f3M)(L.g),this.userAccountService=(0,e.f3M)(M.N),this.accountService=(0,e.f3M)(v.e),this.alertService=(0,e.f3M)(Z.c),this.utilsService=(0,e.f3M)(R.F),this.staffService=(0,e.f3M)(Q),this.accountService.currentUser.subscribe(N=>this.currentUser=N)}ngOnInit(){this.currentStep=1,this.createStaffForm(),this.isAddMode?(this.headerMsg="Login profile for "+this.staff.username,this.title.setTitle(this.headerMsg)):(this.headerMsg="Edit login profile for "+this.staff.username,this.title.setTitle(this.headerMsg),this.loginAccountFormGroup.patchValue(this.staff),this.loginAccountFormGroup.patchValue({password:this.utilsService.generatePassword(this.staff.username)})),this.loginAccountFormGroup.patchValue(this.staff),this.loginAccountFormGroup.patchValue({password:this.utilsService.generatePassword(this.staff.username)}),this.loginAccountBsModalRef.setClass("gray modal-sm modal-dialog-top"),this.listOfUserRoles=this.settingsService.getUserRoles(),this.listOfStatus=this.settingsService.getStatus()}createStaffForm(){this.loginAccountFormGroup=this.fb.group({password:["",{updateOn:"blur",validators:[a.kI.required]}],userRole:["",[a.kI.required]],status:["",[a.kI.required]],recordId:[""]})}get loginAccountForm(){return this.loginAccountFormGroup.controls}generatePassword(){this.loginAccountFormGroup.patchValue({password:this.utilsService.generatePassword(this.staff.username)})}saveStaff(){if(this.submitted=!0,this.loginAccountFormGroup.invalid)return;let o=this.staff.fullName;_().fire({title:"Confirmation",text:`Do you want to create account for  ${o}?`,icon:"question",position:"top",showCancelButton:!0,confirmButtonText:"Yes, create",cancelButtonText:"No, cancel"}).then(t=>{if(t.value){if(this.alertService.clear(),this.loginAccountFormGroup.invalid)return;this.staffService.createLoginAccount(this.currentUser,this.loginAccountFormGroup.value).subscribe({next:r=>{"000"===r.headerResponse.responseCode?(this.alertService.showSuccessMsg(`${o} created successfully`),this.loginAccountBsModalRef.hide(),this.accountService.reloadCurrentRoute(),this.loginAccountFormGroup.reset(),this.submitted=!1,this.logAction(`created login account for  ${o}`,f.h.USER_ACCOUNT)):this.alertService.showErrorMsg(r.headerResponse.responseMessage)},error:r=>{this.alertService.showInfoMsg(r.message)}})}else _()})}updateStaff(){if(this.submitted=!0,this.loginAccountFormGroup.invalid)return;let o=this.staff.fullName;_().fire({position:"top",title:"Confirmation",text:`Do you want to update ${o}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, update"}).then(t=>{t.value?this.userAccountService.updateStaff(this.currentUser,this.loginAccountFormGroup.value).subscribe({next:r=>{this.logger.info("updateStaff response:"+JSON.stringify(r)),"000"===r.headerResponse.responseCode?(this.alertService.showSuccessMsg(`${o} updated successfully`),this.loginAccountBsModalRef.hide(),this.logAction(`Updated ${o}`,f.h.USER_ACCOUNT),this.accountService.reloadCurrentRoute()):this.alertService.showErrorMsg(r.headerResponse.responseMessage)},error:r=>{this.alertService.showInfoMsg(r.message)}}):_()})}logAction(o,t){var r=this;return(0,h.Z)(function*(){yield r.accountService.logUserAudit(o,t)})()}}return(s=i).\u0275fac=function(o){return new(o||s)(e.Y36(x.Dx),e.Y36(p.UZ),e.Y36(a.qu),e.Y36(c.Kf))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],standalone:!0,features:[e.jDz],decls:45,vars:29,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["novalidate","",3,"formGroup"],["class","gallery-body card-inner align-center justify-between flex-wrap g-2",4,"ngIf"],[1,"row","gy-4","m-t-10"],[1,"col-12"],[1,"form-control-wrap"],[3,"labelForName","labelName"],[1,"input-group","has-validation"],["type","text","formControlName","password","id","password","autocomplete","off",1,"form-control",3,"ngClass"],[1,"input-group-append"],[3,"message"],["tooltip","Generate new password",1,"btn","btn-outline-light",3,"delay","click"],[1,"icon","ni","ni-repeat"],[1,"invalid-feedback"],[4,"ngIf"],[1,"col-sm-12"],[1,"form-group"],["id","userRole","formControlName","userRole",3,"clearable","ngClass"],["value","","selected","",1,"fs-6"],[3,"value",4,"ngFor","ngForOf"],[1,"form-check-label",3,"labelForName","labelName"],[1,"custom-control-group"],[4,"ngFor","ngForOf"],["class","text-danger mt-1",4,"ngIf"],[1,"row","gx-3","justify-content-end","mt-5"],[1,"col-auto"],["type","button","title","",1,"btn","btn-outline-lighter",3,"click"],["class","col-auto",4,"ngIf"],["class","modal-footer",4,"ngIf"],[1,"gallery-body","card-inner","align-center","justify-between","flex-wrap","g-2"],[1,"user-card"],[1,"user-info"],[3,"fullName","otherFieldName"],[3,"value"],[1,"custom-control","custom-radio","custom-control-pro","no-control"],["formControlName","status","name","status","type","radio",1,"custom-control-input","form-check-input",3,"id","value","ngClass"],[1,"custom-control-label","form-check-label",3,"for"],[1,"text-danger","mt-1"],[1,"btn","btn-primary",3,"title","click"],[1,"modal-footer"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"h6",1),e._uU(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return null==t.loginAccountBsModalRef?null:t.loginAccountBsModalRef.hide()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"form",5),e.YNc(8,Se,4,3,"div",6),e.TgZ(9,"div",7)(10,"div",8)(11,"div",9),e._UZ(12,"app-form-label",10),e.TgZ(13,"div",11),e._UZ(14,"input",12),e.TgZ(15,"div",13),e._UZ(16,"app-copy-button",14),e.TgZ(17,"button",15),e.NdJ("click",function(){return t.generatePassword()}),e._UZ(18,"em",16),e.qZA()(),e.TgZ(19,"span",17),e.YNc(20,Ce,2,0,"div",18),e.qZA()()()(),e.TgZ(21,"div",19)(22,"div",20),e._UZ(23,"app-form-label",10),e.TgZ(24,"div",9)(25,"ng-select",21)(26,"ng-option",22),e._uU(27,"Select One"),e.qZA(),e.YNc(28,Fe,2,2,"ng-option",23),e.qZA(),e.TgZ(29,"span",17),e.YNc(30,Ue,2,0,"span",18),e.qZA()()()(),e.TgZ(31,"div",19)(32,"div",20),e._UZ(33,"app-form-label",24),e.TgZ(34,"div",9)(35,"ul",25),e.YNc(36,we,5,7,"li",26),e.qZA(),e.YNc(37,qe,2,0,"div",27),e.qZA()()()(),e.TgZ(38,"div",28)(39,"div",29)(40,"button",30),e.NdJ("click",function(){return null==t.loginAccountBsModalRef?null:t.loginAccountBsModalRef.hide()}),e._uU(41," Close "),e.qZA()(),e.YNc(42,ye,3,1,"div",31),e.YNc(43,Me,3,1,"div",31),e.qZA()()(),e.YNc(44,Re,2,0,"div",32)),2&o&&(e.xp6(2),e.Oqu(t.headerMsg),e.xp6(5),e.Q6J("formGroup",t.loginAccountFormGroup),e.xp6(1),e.Q6J("ngIf",!1),e.xp6(4),e.Q6J("labelForName","username")("labelName","Temporary Password"),e.xp6(2),e.Q6J("ngClass",e.VKq(23,Ie,null==t.loginAccountForm.password?null:t.loginAccountForm.password.valid))("ngClass",e.VKq(25,E,((null==t.loginAccountForm.password?null:t.loginAccountForm.password.touched)||(null==t.loginAccountForm.password?null:t.loginAccountForm.password.dirty)||t.submitted)&&!(null!=t.loginAccountForm.password&&t.loginAccountForm.password.valid))),e.xp6(2),e.s9C("message",t.loginAccountForm.password.value),e.xp6(1),e.Q6J("delay",500),e.xp6(3),e.Q6J("ngIf",null==t.loginAccountForm.password||null==t.loginAccountForm.password.errors?null:t.loginAccountForm.password.errors.required),e.xp6(3),e.Q6J("labelForName","userRole")("labelName","User Role"),e.xp6(2),e.Q6J("clearable",!1)("ngClass",e.VKq(27,E,((null==t.loginAccountForm.userRole?null:t.loginAccountForm.userRole.touched)||(null==t.loginAccountForm.userRole?null:t.loginAccountForm.userRole.dirty)||t.submitted)&&(null==t.loginAccountForm.userRole?null:t.loginAccountForm.userRole.errors))),e.xp6(3),e.Q6J("ngForOf",t.listOfUserRoles),e.xp6(2),e.Q6J("ngIf",null==t.loginAccountForm.userRole||null==t.loginAccountForm.userRole.errors?null:t.loginAccountForm.userRole.errors.required),e.xp6(3),e.Q6J("labelForName","status")("labelName","Account Status"),e.xp6(3),e.Q6J("ngForOf",t.listOfStatus),e.xp6(1),e.Q6J("ngIf",t.submitted&&(null==t.loginAccountForm.status.errors?null:t.loginAccountForm.status.errors.required)),e.xp6(5),e.Q6J("ngIf",!t.isAddMode),e.xp6(1),e.Q6J("ngIf",t.isAddMode),e.xp6(1),e.Q6J("ngIf",!1))},dependencies:[d.ez,d.mk,d.sg,d.O5,a.UX,a._Y,a.Fj,a._,a.JJ,a.JL,a.sg,a.u,a.u5,G,P.h,D.M,g._8,F.A0,F.w9,F.jq,k.c,I.z8,I.i9],encapsulation:2}),i})();var Oe=l(4874);class V{}function Be(s,i){1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-required-field"),e.qZA())}const Le=function(s){return{"is-valid":s}},Pe=function(s){return{"is-invalid":s}};let De=(()=>{var s;class i{constructor(o,t,r,u){this.title=o,this.adminPasswordResetBsModalRef=t,this.fb=r,this.logger=u,this.submitted=!1,this.router=(0,e.f3M)(B.F0),this.settingsService=(0,e.f3M)(L.g),this.userAccountService=(0,e.f3M)(M.N),this.accountService=(0,e.f3M)(v.e),this.alertService=(0,e.f3M)(Z.c),this.utilsService=(0,e.f3M)(R.F),this.staffService=(0,e.f3M)(Q),this.accountService.currentUser.subscribe(N=>this.currentUser=N)}ngOnInit(){this.createStaffForm(),this.title.setTitle("Password reset"),this.passwordResetFormGroup.patchValue(this.staff),this.passwordResetFormGroup.patchValue({password:this.utilsService.generatePassword(this.staff.username)}),this.adminPasswordResetBsModalRef.setClass("gray modal-sm modal-dialog-top")}createStaffForm(){this.passwordResetFormGroup=this.fb.group({password:["",{updateOn:"blur",validators:[a.kI.required]}],recordId:[""]})}get passwordResetForm(){return this.passwordResetFormGroup.controls}generatePassword(){this.passwordResetFormGroup.patchValue({password:this.utilsService.generatePassword(this.staff.username)})}resetPassword(){let o=this.staff.fullName,t=new V;t.createdBy=this.staff.username,t.password=this.passwordResetForm.password.value,t.status="RESET",t.userRole=this.staff.userRole,t.recordId=this.staff.recordId,_().fire({position:"top",title:"Confirmation",text:`Do you want to reset password of ${o}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, reset"}).then(r=>{r.value?this.staffService.resetPassword(this.currentUser,t).subscribe({next:u=>{this.logger.info("reset password response:"+JSON.stringify(u)),"000"===u.headerResponse.responseCode?(this.alertService.showSuccessMsg(u.headerResponse.responseMessage),this.adminPasswordResetBsModalRef.hide(),this.logAction(`Reset password of ${o}`,f.h.USER_ACCOUNT),this.accountService.reloadCurrentRoute()):this.alertService.showErrorMsg(u.headerResponse.responseMessage)},error:u=>{this.alertService.showInfoMsg(u.message)}}):_()})}logAction(o,t){var r=this;return(0,h.Z)(function*(){yield r.accountService.logUserAudit(o,t)})()}}return(s=i).\u0275fac=function(o){return new(o||s)(e.Y36(x.Dx),e.Y36(p.UZ),e.Y36(a.qu),e.Y36(c.Kf))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],standalone:!0,features:[e.jDz],decls:31,vars:15,consts:[[1,"modal-header"],[1,"modal-title"],["type","button btn-xs","aria-label","Close",1,"close","btn-close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["novalidate","",3,"formGroup"],[1,"gallery-body","card-inner","align-center","justify-between","flex-wrap","g-2"],[1,"user-card"],[1,"user-info"],[3,"fullName","otherFieldName"],[1,"row","gy-4","m-t-10"],[1,"col-12"],[1,"form-control-wrap"],[3,"labelForName","labelName"],[1,"input-group","has-validation"],["type","text","formControlName","password","id","password","autocomplete","off",1,"form-control",3,"ngClass"],[1,"input-group-append"],[3,"message"],[1,"btn","btn-outline-light",3,"click"],[1,"icon","ni","ni-repeat"],[1,"invalid-feedback"],[4,"ngIf"],[1,"row","gx-3","justify-content-end","mt-5"],[1,"col-auto"],["type","button","title","",1,"btn","btn-outline-lighter",3,"click"],[1,"btn","btn-primary",3,"title","click"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"h6",1),e._uU(2,"Password reset"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return null==t.adminPasswordResetBsModalRef?null:t.adminPasswordResetBsModalRef.hide()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"form",5)(8,"div",6)(9,"div",7)(10,"div",8),e._UZ(11,"app-full-name",9),e.qZA()()(),e.TgZ(12,"div",10)(13,"div",11)(14,"div",12),e._UZ(15,"app-form-label",13),e.TgZ(16,"div",14),e._UZ(17,"input",15),e.TgZ(18,"div",16),e._UZ(19,"app-copy-button",17),e.TgZ(20,"button",18),e.NdJ("click",function(){return t.generatePassword()}),e._UZ(21,"em",19),e.qZA()(),e.TgZ(22,"span",20),e.YNc(23,Be,2,0,"div",21),e.qZA()()()()(),e.TgZ(24,"div",22)(25,"div",23)(26,"button",24),e.NdJ("click",function(){return null==t.adminPasswordResetBsModalRef?null:t.adminPasswordResetBsModalRef.hide()}),e._uU(27," Close "),e.qZA()(),e.TgZ(28,"div",23)(29,"button",25),e.NdJ("click",function(){return t.resetPassword()}),e._uU(30," Reset "),e.qZA()()()()()),2&o&&(e.xp6(7),e.Q6J("formGroup",t.passwordResetFormGroup),e.xp6(4),e.hYB("fullName","",null==t.staff?null:t.staff.fullName," (",t.staff.username,")"),e.s9C("otherFieldName",null==t.staff?null:t.staff.email),e.xp6(4),e.Q6J("labelForName","username")("labelName","Temporary Password"),e.xp6(2),e.Q6J("ngClass",e.VKq(11,Le,null==t.passwordResetForm.password?null:t.passwordResetForm.password.valid))("ngClass",e.VKq(13,Pe,((null==t.passwordResetForm.password?null:t.passwordResetForm.password.touched)||(null==t.passwordResetForm.password?null:t.passwordResetForm.password.dirty)||t.submitted)&&!(null!=t.passwordResetForm.password&&t.passwordResetForm.password.valid))),e.xp6(2),e.s9C("message",t.passwordResetForm.password.value),e.xp6(4),e.Q6J("ngIf",null==t.passwordResetForm.password||null==t.passwordResetForm.password.errors?null:t.passwordResetForm.password.errors.required),e.xp6(6),e.Q6J("title",t.passwordResetFormGroup.invalid?"There must be errors on the form":""))},dependencies:[d.ez,d.mk,d.O5,a.UX,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,a.u5,G,P.h,D.M,k.c],encapsulation:2}),i})(),xe=(()=>{var s;class i{transform(o){return"ACTIVE"===o||"Active"===o||"000"===o?"bg-success":"NEW"===o?"bg-primary":"RESET"===o||"Reset"===o?"bg-warning":"INACTIVE"===o||"inactive"===o||"000"!==o?"bg-danger":"bg-gray"}}return(s=i).\u0275fac=function(o){return new(o||s)},s.\u0275pipe=e.Yjl({name:"statusStyle",type:s,pure:!0,standalone:!0}),i})();var ke=l(9972);function Qe(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"div",29)(1,"div",6)(2,"label",7),e._uU(3),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"div",8)(6,"input",30),e.NdJ("ngModelChange",function(t){e.CHM(n);const r=e.oxw();return e.KtG(r.searchValue=t)}),e.qZA()()()()}if(2&s){const n=e.oxw();e.xp6(3),e.Oqu(n.searchValueLabel),e.xp6(3),e.MGl("placeholder","Enter ",n.searchPlaceholder,""),e.Q6J("ngModel",n.searchValue)}}function Ee(s,i){1&s&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"SN"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Full Name"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Username"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Department"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Region"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Gender"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Status"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Mobile No."),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Last Login Date"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Actions"),e.qZA()())}function Ye(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"a",41),e.NdJ("click",function(){e.CHM(n);const t=e.oxw().$implicit,r=e.oxw();return e.KtG(r.activateDeactivateAccount(t,!1))}),e._UZ(1,"em",50),e.TgZ(2,"span"),e._uU(3,"Deactivate account"),e.qZA()()}}function Ge(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"a",41),e.NdJ("click",function(){e.CHM(n);const t=e.oxw().$implicit,r=e.oxw();return e.KtG(r.activateDeactivateAccount(t,!0))}),e._UZ(1,"em",51),e.TgZ(2,"span"),e._uU(3,"Activate account"),e.qZA()()}}function Ve(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"app-full-name",31),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"app-full-name",32),e.ALo(7,"removeHyphen"),e.ALo(8,"titlecase"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"titlecase"),e.qZA(),e.TgZ(16,"td")(17,"span"),e.ALo(18,"statusStyle"),e._uU(19),e.ALo(20,"titlecase"),e.qZA()(),e.TgZ(21,"td"),e._uU(22),e.qZA(),e.TgZ(23,"td")(24,"div",33)(25,"small",34),e._uU(26),e.ALo(27,"date"),e.qZA(),e.TgZ(28,"small",35),e._uU(29),e.ALo(30,"timeAgo"),e.qZA()()(),e.TgZ(31,"td")(32,"div",36)(33,"a",37),e._UZ(34,"em",38),e.qZA(),e.TgZ(35,"div",39)(36,"ul",40)(37,"li")(38,"a",41),e.NdJ("click",function(){const r=e.CHM(n).$implicit,u=e.oxw();return e.KtG(u.addStaffModalComponent(r,!1))}),e._UZ(39,"em",42),e.TgZ(40,"span"),e._uU(41,"Edit staff"),e.qZA()()(),e.TgZ(42,"li")(43,"a",41),e.NdJ("click",function(){const r=e.CHM(n).$implicit,u=e.oxw();return e.KtG(u.viewStaffModalComponent(r))}),e._UZ(44,"em",43),e.TgZ(45,"span"),e._uU(46,"View profile"),e.qZA()()(),e.TgZ(47,"li")(48,"a",41),e.NdJ("click",function(){const r=e.CHM(n).$implicit,u=e.oxw();return e.KtG(u.loginAccountModalComponent(r,!0))}),e._UZ(49,"em",44),e.TgZ(50,"span"),e._uU(51,"Login account"),e.qZA()()(),e.TgZ(52,"li"),e.YNc(53,Ye,4,0,"a",45),e.YNc(54,Ge,4,0,"a",45),e.qZA(),e.TgZ(55,"li")(56,"a",41),e.NdJ("click",function(){const r=e.CHM(n).$implicit,u=e.oxw();return e.KtG(u.adminPasswordResetModalComponent(r))}),e._UZ(57,"em",46),e.TgZ(58,"span"),e._uU(59,"Reset Password"),e.qZA()()(),e._UZ(60,"li",47),e.TgZ(61,"li")(62,"a",48),e.NdJ("click",function(){const r=e.CHM(n).$implicit,u=e.oxw();return e.KtG(u.deleteStaff(r))}),e._UZ(63,"em",49),e.TgZ(64,"span"),e._uU(65,"Delete"),e.qZA()()()()()()()()}if(2&s){const n=i.$implicit,o=i.rowIndex;e.xp6(2),e.Oqu(o+1),e.xp6(2),e.s9C("fullName",null==n?null:n.fullName),e.s9C("otherFieldName",null==n?null:n.email),e.xp6(2),e.s9C("fullName",null==n?null:n.username),e.s9C("otherFieldName",e.lcZ(7,18,e.lcZ(8,20,null==n?null:n.userRole))),e.Q6J("showAvatar",!1),e.xp6(4),e.Oqu(null==n?null:n.departmentName),e.xp6(2),e.Oqu(null==n?null:n.regionName),e.xp6(2),e.Oqu(e.lcZ(15,22,null==n?null:n.gender)),e.xp6(3),e.Gre("badge badge-dim ",e.lcZ(18,24,null==n?null:n.status),""),e.xp6(2),e.hij(" ",e.lcZ(20,26,null==n?null:n.status)," "),e.xp6(3),e.Oqu(null==n?null:n.mobileNo),e.xp6(4),e.Oqu(e.xi3(27,28,n.lastLoginDate,"medium")),e.xp6(3),e.hij(" ",e.lcZ(30,31,n.lastLoginDate),""),e.xp6(24),e.Q6J("ngIf","ACTIVE"===n.status),e.xp6(1),e.Q6J("ngIf","INACTIVE"===n.status)}}const Ke=function(){return[5,10,25,50]};let $e=(()=>{var s;class i{constructor(o,t,r,u){this.addStaffBsModalRef=o,this.viewStaffBsModalRef=t,this.loginAccountBsModalRef=r,this.adminPasswordResetBsModalRef=u,this.viewStaffModalService=(0,e.f3M)(p.tT),this.addStaffModalService=(0,e.f3M)(p.tT),this.loginAccountModalService=(0,e.f3M)(p.tT),this.adminPasswordResetModalService=(0,e.f3M)(p.tT),this.userAccountService=(0,e.f3M)(M.N),this.accountService=(0,e.f3M)(v.e),this.alertService=(0,e.f3M)(Z.c),this.staffService=(0,e.f3M)(Q),this.utilService=(0,e.f3M)(R.F),this.logger=(0,e.f3M)(c.Kf),this.accountService.currentUser.subscribe(N=>this.currentUser=N)}ngOnInit(){this.searchBy="ALL",this.fetchStaffs()}ngOnDestroy(){this.addStaffModalService.hide(),this.viewStaffModalService.hide(),this.loginAccountModalService.hide(),_().close()}searchByListener(){return this.searchValue="","lastName"===this.searchBy?(this.searchValueLabel="Last Name",void(this.searchPlaceholder=" Enter last name")):"username"===this.searchBy?(this.searchValueLabel="Username",void(this.searchPlaceholder=" Enter username")):"mobileNo"===this.searchBy?(this.searchValueLabel="Mobile No",void(this.searchPlaceholder=" Enter mobile No")):"email"===this.searchBy?(this.searchValueLabel="Email Address",void(this.searchPlaceholder=" Enter email address")):void("ALL"===this.searchBy&&this.fetchStaffs())}fetchStaffs(){this.listOfUsers=[],this.userAccountService.searchStaffs(this.currentUser,this.searchBy,this.searchValue).subscribe({next:o=>{if(this.logger.info("searchStaffs response "+JSON.stringify(o)),"000"===o.headerResponse.responseCode)return o.staffs.length<=0?(this.alertService.showInfoMsgGeneral("No staffs found"),void this.logger.info("No staffs found")):void(this.listOfUsers=o.staffs);this.alertService.showErrorMsg(o.headerResponse.responseMessage)},error:o=>{this.logger.error(o),this.alertService.showInfoMsg(o)}})}activateDeactivateAccount(o,t){let r=o.fullName,u=new V,N="",y="";t?(u.status="ACTIVE",N=`Do you want to activate account of ${r}?`,y=`Activated account of ${r}`):(u.status="INACTIVE",N=`Do you want to deactivate account of ${r}?`,y=`Deactivated account of ${r}`),u.createdBy=o.username,u.password=this.utilService.generatePassword(o.username),u.userRole=o.userRole,u.recordId=o.recordId,_().fire({position:"top",title:"Confirmation",text:N,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Activate"}).then(J=>{J.value?this.staffService.resetPassword(this.currentUser,u).subscribe({next:w=>{this.logger.info("activate/deactivate account response:"+JSON.stringify(w)),"000"===w.headerResponse.responseCode?(this.alertService.showSuccessMsg(w.headerResponse.responseMessage),this.addStaffBsModalRef.hide(),this.logAction(y,f.h.USER_ACCOUNT),this.accountService.reloadCurrentRoute()):this.alertService.showErrorMsg(w.headerResponse.responseMessage)},error:w=>{this.alertService.showInfoMsg(w.message)}}):_()})}deleteStaff(o){let t=o.fullName;_().fire({position:"top",title:"Confirmation",text:`Do you want to delete ${t}?`,icon:"question",showCancelButton:!0,cancelButtonText:"No, cancel",confirmButtonText:"Yes, delete"}).then(r=>{r.value?this.userAccountService.deleteStaff(this.currentUser,o.recordId).subscribe({next:u=>{this.logger.info("deleteStaff response:"+JSON.stringify(u)),"000"===u.headerResponse.responseCode?(this.alertService.showSuccessMsg(`${t} deleted successfully`),this.addStaffBsModalRef.hide(),this.logAction(`Updated ${t}`,f.h.USER_ACCOUNT),this.accountService.reloadCurrentRoute()):this.alertService.showErrorMsg(u.headerResponse.responseMessage)},error:u=>{this.alertService.showInfoMsg(u.message)}}):_()})}addStaffModalComponent(o,t){const r={initialState:{isAddMode:t,staff:o}};this.addStaffModalService.config.ignoreBackdropClick=!0,this.addStaffModalService.config.animated=!0,this.addStaffBsModalRef=this.addStaffModalService.show(ve,r),this.addStaffBsModalRef.content.closeBtnName="Close"}viewStaffModalComponent(o){const t={initialState:{staff:o}};this.viewStaffModalService.config.ignoreBackdropClick=!0,this.viewStaffModalService.config.animated=!0,this.viewStaffBsModalRef=this.addStaffModalService.show(Ze,t),this.viewStaffBsModalRef.content.closeBtnName="Close"}loginAccountModalComponent(o,t){const r={initialState:{staff:o,isAddMode:t}};this.loginAccountModalService.config.ignoreBackdropClick=!0,this.loginAccountModalService.config.animated=!0,this.loginAccountBsModalRef=this.addStaffModalService.show(Je,r),this.loginAccountBsModalRef.content.closeBtnName="Close"}adminPasswordResetModalComponent(o){const t={initialState:{staff:o}};this.adminPasswordResetModalService.config.ignoreBackdropClick=!0,this.adminPasswordResetModalService.config.animated=!0,this.adminPasswordResetBsModalRef=this.addStaffModalService.show(De,t),this.adminPasswordResetBsModalRef.content.closeBtnName="Close"}logAction(o,t){var r=this;return(0,h.Z)(function*(){yield r.accountService.logUserAudit(o,t)})()}}return(s=i).\u0275fac=function(o){return new(o||s)(e.Y36(p.UZ),e.Y36(p.UZ),e.Y36(p.UZ),e.Y36(p.UZ))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],standalone:!0,features:[e.jDz],decls:45,vars:16,consts:[[3,"pageTitleName","description"],[1,"newItemName"],["aria-expanded","false",1,"btn","btn-primary",3,"click"],[1,"icon","ni","ni-plus"],[1,"row","gy-2","gx-3","mt-5","mb-4","align-items-center"],[1,"col-sm-2"],[1,"form-group"],["for","startDate",1,"form-label","pt-0"],[1,"form-control-wrap"],[1,"form-control-select"],["id","searchBy",1,"form-control",3,"ngModel","ngModelChange","change"],["value","ALL","selected","",1,"fs-6"],["value","lastName","selected","",1,"fs-6"],["value","username","selected","",1,"fs-6"],["value","mobileNo"],["value","email"],["class","col-sm-3",4,"ngIf"],[1,"col-auto"],["type","button","title","",1,"btn","btn-dim","btn-primary","mt-4",3,"click"],[1,"btn","mt-4","btn-outline-light",3,"click"],[1,"icon","ni","ni-download"],[1,"row","gy-2","gx-3","my-3"],[1,"form-icon","form-icon-right"],[1,"icon","ni","ni-search"],["type","text","id","default-04","placeholder","Quick search",1,"form-control",3,"ngModel","ngModelChange"],["responsiveLayout","scroll","sortMode","multiple","responsiveLayout","scroll","styleClass","p-datatable-sm p-datatable-striped","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","scrollDirection","both",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","resizableColumns","autoLayout"],["dt1",""],["pTemplate","header"],["pTemplate","body"],[1,"col-sm-3"],["id","searchBy",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[3,"fullName","otherFieldName"],[3,"showAvatar","fullName","otherFieldName"],[1,"fw-lighter"],[1,"d-block"],[1,"text-primary"],[1,"drodown"],["data-bs-toggle","dropdown","aria-expanded","false",1,"dropdown-toggle","btn","btn-icon","btn-light"],[1,"icon","ni","ni-more-h"],[1,"dropdown-menu","dropdown-menu-end"],[1,"link-list-opt","no-bdr"],[3,"click"],[1,"icon","ni","ni-edit"],[1,"icon","ni","ni-eye"],[1,"icon","ni","ni-user-add"],[3,"click",4,"ngIf"],[1,"icon","ni","ni-reload-alt"],[1,"divider"],[1,"text-danger",3,"click"],[1,"icon","ni","ni-trash"],[1,"icon","ni","ni-user-cross"],[1,"icon","ni","ni-user-check"]],template:function(o,t){1&o&&(e.TgZ(0,"app-add-item",0)(1,"span",1)(2,"a",2),e.NdJ("click",function(){return t.addStaffModalComponent(null,!0)}),e._UZ(3,"em",3),e.TgZ(4,"span"),e._uU(5,"Add user"),e.qZA()()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"label",7),e._uU(10,"Search Type"),e.qZA(),e._UZ(11,"br"),e.TgZ(12,"div",8)(13,"div",9)(14,"select",10),e.NdJ("ngModelChange",function(u){return t.searchBy=u})("change",function(){return t.searchByListener()}),e.TgZ(15,"option",11),e._uU(16,"All Staffs"),e.qZA(),e.TgZ(17,"option",12),e._uU(18,"Last Name"),e.qZA(),e.TgZ(19,"option",13),e._uU(20,"Username"),e.qZA(),e.TgZ(21,"option",14),e._uU(22,"Mobile Number"),e.qZA(),e.TgZ(23,"option",15),e._uU(24,"Email"),e.qZA()()()()()(),e.YNc(25,Qe,7,3,"div",16),e.TgZ(26,"div",17)(27,"button",18),e.NdJ("click",function(){return t.fetchStaffs()}),e._uU(28," Search "),e.qZA()(),e.TgZ(29,"div",17)(30,"a",19),e.NdJ("click",function(){return t.fetchStaffs()}),e._UZ(31,"em",20),e.TgZ(32,"span"),e._uU(33,"Export"),e.qZA()()()(),e.TgZ(34,"div",21)(35,"div",17)(36,"div",8)(37,"div",22),e._UZ(38,"em",23),e.qZA(),e.TgZ(39,"input",24),e.NdJ("ngModelChange",function(u){return t.searchedKeyword=u}),e.qZA()()()(),e.TgZ(40,"p-table",25,26),e.ALo(42,"filter"),e.YNc(43,Ee,21,0,"ng-template",27),e.YNc(44,Ve,66,33,"ng-template",28),e.qZA()),2&o&&(e.Q6J("pageTitleName","User Accounts")("description","List of users"),e.xp6(14),e.Q6J("ngModel",t.searchBy),e.xp6(11),e.Q6J("ngIf","ALL"!==t.searchBy),e.xp6(14),e.Q6J("ngModel",t.searchedKeyword),e.xp6(1),e.Q6J("value",e.xi3(42,12,t.listOfUsers,t.searchedKeyword))("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(15,Ke))("resizableColumns",!0)("autoLayout",!0))},dependencies:[d.ez,d.O5,d.rS,d.uU,a.u5,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.On,g._8,ke.jx,S.L,m.U$,m.iA,C.$,k.c,Y.e,Oe.i,xe],encapsulation:2}),i})()}}]);